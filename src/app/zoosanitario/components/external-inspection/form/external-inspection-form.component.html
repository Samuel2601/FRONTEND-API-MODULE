<p-dialog
    [(visible)]="visible"
    [header]="
        phase === 'recepcion' ? 'Inspección de Recepción' : 'Examen Ante Mortem'
    "
    [modal]="true"
    [style]="{ width: '90vw', maxWidth: '1200px' }"
    [styleClass]="'inspection-form-dialog'"
    (onHide)="closeDialog()"
>
    <form [formGroup]="inspectionForm" (ngSubmit)="onSubmit()">
        <div class="inspection-form-container">
            <!-- Contenido específico por fase -->
            <ng-container
                *ngIf="phase === 'recepcion'; else anteMortemTemplate"
            >
                <!-- Formulario de Recepción -->
                <p-panel header="Información General" styleClass="mb-3">
                    <div class="grid">
                        <div class="col-12 md:col-4">
                            <div class="field">
                                <label for="numero"
                                    >Número de Inspección *</label
                                >
                                <p class="form-control-static">
                                    {{ inspectionForm.get("numero")?.value }}
                                </p>
                            </div>
                        </div>

                        <div class="col-12 md:col-4">
                            <div class="field">
                                <label for="especie">Especie</label>
                                <p-dropdown
                                    appendTo="body"
                                    id="especie"
                                    formControlName="especie"
                                    [options]="speciesOptions"
                                    optionLabel="label"
                                    optionValue="value"
                                    [showClear]="true"
                                ></p-dropdown>
                            </div>
                        </div>

                        <div class="col-12 md:col-4">
                            <div class="field">
                                <label for="sexo">Sexo</label>
                                <p-selectButton
                                    appendTo="body"
                                    id="sexo"
                                    formControlName="sexo"
                                    [options]="sexOptions"
                                ></p-selectButton>
                            </div>
                        </div>

                        <div class="col-12 md:col-3">
                            <div class="field">
                                <label for="edad">Edad (meses)</label>
                                <p-inputNumber
                                    id="edad"
                                    formControlName="edad"
                                    mode="decimal"
                                    [min]="0"
                                    [max]="30"
                                    [class]="{
                                        'ng-invalid ng-touched':
                                            inspectionForm.get('edad')
                                                ?.invalid &&
                                            inspectionForm.get('edad')?.touched
                                    }"
                                ></p-inputNumber>
                                <small
                                    *ngIf="
                                        inspectionForm.get('edad')?.invalid &&
                                        inspectionForm.get('edad')?.touched
                                    "
                                    class="p-error"
                                >
                                    Edad debe estar entre 0 y 30 meses
                                </small>
                            </div>
                        </div>

                        <div class="col-12 md:col-3">
                            <div class="field">
                                <label for="peso">Peso (kg)</label>
                                <p-inputNumber
                                    id="peso"
                                    formControlName="peso"
                                    mode="decimal"
                                    [min]="0"
                                    [max]="2000"
                                    suffix=" kg"
                                    [class]="{
                                        'ng-invalid ng-touched':
                                            inspectionForm.get('peso')
                                                ?.invalid &&
                                            inspectionForm.get('peso')?.touched
                                    }"
                                ></p-inputNumber>
                                <small
                                    *ngIf="
                                        inspectionForm.get('peso')?.invalid &&
                                        inspectionForm.get('peso')?.touched
                                    "
                                    class="p-error"
                                >
                                    Peso debe estar entre 0 y 2000 kg
                                </small>
                            </div>
                        </div>

                        <div class="col-12 md:col-3">
                            <div class="field temp-indicator">
                                <label for="temperatura"
                                    >Temperatura (°C)</label
                                >
                                <p-inputNumber
                                    id="temperatura"
                                    formControlName="temperatura"
                                    mode="decimal"
                                    [min]="35"
                                    [max]="65"
                                    suffix=" °C"
                                    [class]="{
                                        'ng-invalid ng-touched':
                                            inspectionForm.get('temperatura')
                                                ?.invalid &&
                                            inspectionForm.get('temperatura')
                                                ?.touched
                                    }"
                                ></p-inputNumber>
                                <small
                                    *ngIf="
                                        inspectionForm.get('temperatura')?.value
                                    "
                                    [class]="
                                        getTempIndicatorClass(
                                            inspectionForm.get('temperatura')
                                                ?.value
                                        )
                                    "
                                >
                                    {{
                                        getTempIndicatorText(
                                            inspectionForm.get("temperatura")
                                                ?.value
                                        )
                                    }}
                                </small>
                                <small
                                    *ngIf="
                                        inspectionForm.get('temperatura')
                                            ?.invalid &&
                                        inspectionForm.get('temperatura')
                                            ?.touched
                                    "
                                    class="p-error"
                                >
                                    Temperatura debe estar entre 35°C y 65°C
                                </small>
                            </div>
                        </div>

                        <div class="col-12 md:col-3">
                            <div class="field hr-indicator">
                                <label for="frecuenciaCardiaca"
                                    >Frecuencia Cardíaca (lpm)</label
                                >
                                <p-inputNumber
                                    id="frecuenciaCardiaca"
                                    formControlName="frecuenciaCardiaca"
                                    mode="decimal"
                                    [min]="30"
                                    [max]="200"
                                    suffix=" lpm"
                                    [class]="{
                                        'ng-invalid ng-touched':
                                            inspectionForm.get(
                                                'frecuenciaCardiaca'
                                            )?.invalid &&
                                            inspectionForm.get(
                                                'frecuenciaCardiaca'
                                            )?.touched
                                    }"
                                ></p-inputNumber>
                                <small
                                    *ngIf="
                                        inspectionForm.get('frecuenciaCardiaca')
                                            ?.value
                                    "
                                    [class]="
                                        getHeartRateIndicatorClass(
                                            inspectionForm.get(
                                                'frecuenciaCardiaca'
                                            )?.value
                                        )
                                    "
                                >
                                    {{
                                        getHeartRateIndicatorText(
                                            inspectionForm.get(
                                                "frecuenciaCardiaca"
                                            )?.value
                                        )
                                    }}
                                </small>
                                <small
                                    *ngIf="
                                        inspectionForm.get('frecuenciaCardiaca')
                                            ?.invalid &&
                                        inspectionForm.get('frecuenciaCardiaca')
                                            ?.touched
                                    "
                                    class="p-error"
                                >
                                    Frecuencia debe estar entre 30 y 200 lpm
                                </small>
                            </div>
                        </div>

                        <div class="col-12 md:col-3">
                            <div class="field rr-indicator">
                                <label for="frecuenciaRespiratoria"
                                    >Frecuencia Respiratoria (rpm)</label
                                >
                                <p-inputNumber
                                    id="frecuenciaRespiratoria"
                                    formControlName="frecuenciaRespiratoria"
                                    mode="decimal"
                                    [min]="5"
                                    [max]="80"
                                    suffix=" rpm"
                                    [class]="{
                                        'ng-invalid ng-touched':
                                            inspectionForm.get(
                                                'frecuenciaRespiratoria'
                                            )?.invalid &&
                                            inspectionForm.get(
                                                'frecuenciaRespiratoria'
                                            )?.touched
                                    }"
                                ></p-inputNumber>
                                <small
                                    *ngIf="
                                        inspectionForm.get(
                                            'frecuenciaRespiratoria'
                                        )?.value
                                    "
                                    [class]="
                                        getRespRateIndicatorClass(
                                            inspectionForm.get(
                                                'frecuenciaRespiratoria'
                                            )?.value
                                        )
                                    "
                                >
                                    {{
                                        getRespRateIndicatorText(
                                            inspectionForm.get(
                                                "frecuenciaRespiratoria"
                                            )?.value
                                        )
                                    }}
                                </small>
                                <small
                                    *ngIf="
                                        inspectionForm.get(
                                            'frecuenciaRespiratoria'
                                        )?.invalid &&
                                        inspectionForm.get(
                                            'frecuenciaRespiratoria'
                                        )?.touched
                                    "
                                    class="p-error"
                                >
                                    Frecuencia debe estar entre 5 y 80 rpm
                                </small>
                            </div>
                        </div>

                        <div class="col-12 md:col-3">
                            <div class="field">
                                <label for="horaChequeo">Hora de Chequeo</label>
                                <p-calendar
                                    id="horaChequeo"
                                    formControlName="horaChequeo"
                                    [timeOnly]="true"
                                    hourFormat="24"
                                ></p-calendar>
                            </div>
                        </div>

                        <div class="col-12">
                            <div class="field">
                                <label for="estadoGeneral"
                                    >Estado General</label
                                >
                                <textarea
                                    id="estadoGeneral"
                                    formControlName="estadoGeneral"
                                    rows="3"
                                    [maxlength]="500"
                                    pInputTextarea
                                ></textarea>
                                <small class="text-color-secondary"
                                    >{{
                                        inspectionForm.get("estadoGeneral")
                                            ?.value?.length || 0
                                    }}/500</small
                                >
                            </div>
                        </div>

                        <div class="col-12">
                            <div class="field">
                                <label for="lesionesVisibles"
                                    >Lesiones Visibles</label
                                >
                                <textarea
                                    id="lesionesVisibles"
                                    formControlName="lesionesVisibles"
                                    rows="3"
                                    [maxlength]="500"
                                    pInputTextarea
                                ></textarea>
                                <small class="text-color-secondary"
                                    >{{
                                        inspectionForm.get("lesionesVisibles")
                                            ?.value?.length || 0
                                    }}/500</small
                                >
                            </div>
                        </div>
                    </div>
                </p-panel>

                <p-panel
                    header="Características"
                    styleClass="mb-3"
                    formGroupName="caracteristicas"
                >
                    <div class="grid">
                        <div class="col-12 md:col-4">
                            <div class="field">
                                <label for="tamano">Tamaño</label>
                                <p-selectButton
                                    appendTo="body"
                                    id="tamano"
                                    formControlName="tamano"
                                    optionLabel="label"
                                    optionValue="value"
                                    [options]="[
                                        { label: 'Grande', value: 'Grande' },
                                        { label: 'Mediano', value: 'Mediano' },
                                        { label: 'Pequeño', value: 'Pequeño' }
                                    ]"
                                >
                                </p-selectButton>
                            </div>
                        </div>

                        <div class="col-12 md:col-4">
                            <div class="field">
                                <label for="parasitos"
                                    >Presencia de Parásitos</label
                                >
                                <p-dropdown
                                    appendTo="body"
                                    id="parasitos"
                                    formControlName="parasitos"
                                    [options]="[
                                        { label: 'Sí', value: true },
                                        { label: 'No', value: false }
                                    ]"
                                    [showClear]="true"
                                ></p-dropdown>
                            </div>
                        </div>

                        <div class="col-12 md:col-4">
                            <div class="field">
                                <label for="movilidad">Movilidad</label>
                                <p-selectButton
                                    appendTo="body"
                                    id="movilidad"
                                    formControlName="movilidad"
                                    [options]="[
                                        { label: 'Solo', value: 'Solo' },
                                        {
                                            label: 'Con Ayuda',
                                            value: 'Con Ayuda'
                                        }
                                    ]"
                                >
                                </p-selectButton>
                            </div>
                        </div>
                    </div>
                </p-panel>
            </ng-container>

            <ng-template #anteMortemTemplate>
                <!-- Formulario Ante Mortem -->
                <p-panel header="Examen Ante Mortem" styleClass="mb-3">
                    <div class="grid">
                        <div class="col-12 md:col-3">
                            <div class="field temp-indicator">
                                <label for="temperatura"
                                    >Temperatura (°C)</label
                                >
                                <p-inputNumber
                                    id="temperatura"
                                    formControlName="temperatura"
                                    mode="decimal"
                                    [min]="35"
                                    [max]="45"
                                    suffix=" °C"
                                    [class]="{
                                        'ng-invalid ng-touched':
                                            inspectionForm.get('temperatura')
                                                ?.invalid &&
                                            inspectionForm.get('temperatura')
                                                ?.touched
                                    }"
                                ></p-inputNumber>
                                <small
                                    *ngIf="
                                        inspectionForm.get('temperatura')?.value
                                    "
                                    [class]="
                                        getTempIndicatorClass(
                                            inspectionForm.get('temperatura')
                                                ?.value
                                        )
                                    "
                                >
                                    {{
                                        getTempIndicatorText(
                                            inspectionForm.get("temperatura")
                                                ?.value
                                        )
                                    }}
                                </small>
                                <small
                                    *ngIf="
                                        inspectionForm.get('temperatura')
                                            ?.invalid &&
                                        inspectionForm.get('temperatura')
                                            ?.touched
                                    "
                                    class="p-error"
                                >
                                    Temperatura debe estar entre 35°C y 45°C
                                </small>
                            </div>
                        </div>

                        <div class="col-12 md:col-3">
                            <div class="field hr-indicator">
                                <label for="frecuenciaCardiaca"
                                    >Frecuencia Cardíaca (lpm)</label
                                >
                                <p-inputNumber
                                    id="frecuenciaCardiaca"
                                    formControlName="frecuenciaCardiaca"
                                    mode="decimal"
                                    [min]="30"
                                    [max]="200"
                                    suffix=" lpm"
                                    [class]="{
                                        'ng-invalid ng-touched':
                                            inspectionForm.get(
                                                'frecuenciaCardiaca'
                                            )?.invalid &&
                                            inspectionForm.get(
                                                'frecuenciaCardiaca'
                                            )?.touched
                                    }"
                                ></p-inputNumber>
                                <small
                                    *ngIf="
                                        inspectionForm.get('frecuenciaCardiaca')
                                            ?.value
                                    "
                                    [class]="
                                        getHeartRateIndicatorClass(
                                            inspectionForm.get(
                                                'frecuenciaCardiaca'
                                            )?.value
                                        )
                                    "
                                >
                                    {{
                                        getHeartRateIndicatorText(
                                            inspectionForm.get(
                                                "frecuenciaCardiaca"
                                            )?.value
                                        )
                                    }}
                                </small>
                                <small
                                    *ngIf="
                                        inspectionForm.get('frecuenciaCardiaca')
                                            ?.invalid &&
                                        inspectionForm.get('frecuenciaCardiaca')
                                            ?.touched
                                    "
                                    class="p-error"
                                >
                                    Frecuencia debe estar entre 30 y 200 lpm
                                </small>
                            </div>
                        </div>

                        <div class="col-12 md:col-3">
                            <div class="field rr-indicator">
                                <label for="frecuenciaRespiratoria"
                                    >Frecuencia Respiratoria (rpm)</label
                                >
                                <p-inputNumber
                                    id="frecuenciaRespiratoria"
                                    formControlName="frecuenciaRespiratoria"
                                    mode="decimal"
                                    [min]="5"
                                    [max]="80"
                                    suffix=" rpm"
                                    [class]="{
                                        'ng-invalid ng-touched':
                                            inspectionForm.get(
                                                'frecuenciaRespiratoria'
                                            )?.invalid &&
                                            inspectionForm.get(
                                                'frecuenciaRespiratoria'
                                            )?.touched
                                    }"
                                ></p-inputNumber>
                                <small
                                    *ngIf="
                                        inspectionForm.get(
                                            'frecuenciaRespiratoria'
                                        )?.value
                                    "
                                    [class]="
                                        getRespRateIndicatorClass(
                                            inspectionForm.get(
                                                'frecuenciaRespiratoria'
                                            )?.value
                                        )
                                    "
                                >
                                    {{
                                        getRespRateIndicatorText(
                                            inspectionForm.get(
                                                "frecuenciaRespiratoria"
                                            )?.value
                                        )
                                    }}
                                </small>
                                <small
                                    *ngIf="
                                        inspectionForm.get(
                                            'frecuenciaRespiratoria'
                                        )?.invalid &&
                                        inspectionForm.get(
                                            'frecuenciaRespiratoria'
                                        )?.touched
                                    "
                                    class="p-error"
                                >
                                    Frecuencia debe estar entre 5 y 80 rpm
                                </small>
                            </div>
                        </div>

                        <div class="col-12 md:col-3">
                            <div class="field">
                                <label for="horaChequeo">Hora de Chequeo</label>
                                <p-calendar
                                    id="horaChequeo"
                                    formControlName="horaChequeo"
                                    [timeOnly]="true"
                                    hourFormat="24"
                                ></p-calendar>
                            </div>
                        </div>

                        <div class="col-12 md:col-6">
                            <div class="field">
                                <label>Estado General Óptimo</label>
                                <p-dropdown
                                    formControlName="estadoGeneralOptimo"
                                    [options]="[
                                        { label: 'Sí', value: true },
                                        { label: 'No', value: false }
                                    ]"
                                    [showClear]="true"
                                ></p-dropdown>
                            </div>
                        </div>

                        <div class="col-12 md:col-6">
                            <div class="field">
                                <label>Comportamiento Normal</label>
                                <p-dropdown
                                    formControlName="comportamientoNormal"
                                    [options]="[
                                        { label: 'Sí', value: true },
                                        { label: 'No', value: false }
                                    ]"
                                    [showClear]="true"
                                ></p-dropdown>
                            </div>
                        </div>

                        <div class="col-12 md:col-6">
                            <div class="field">
                                <label>Lesiones Visibles</label>
                                <p-dropdown
                                    formControlName="lesiones"
                                    [options]="[
                                        { label: 'Sí', value: true },
                                        { label: 'No', value: false }
                                    ]"
                                    [showClear]="true"
                                ></p-dropdown>
                            </div>
                        </div>

                        <div class="col-12 md:col-6">
                            <div class="field">
                                <label>Presencia de Parásitos</label>
                                <p-dropdown
                                    formControlName="parasitos"
                                    [options]="[
                                        { label: 'Sí', value: true },
                                        { label: 'No', value: false }
                                    ]"
                                    [showClear]="true"
                                ></p-dropdown>
                            </div>
                        </div>

                        <div class="col-12">
                            <p-panel header="Secreciones">
                                <div class="grid">
                                    <div class="col-12 md:col-6">
                                        <div class="field">
                                            <label>Oculares</label>
                                            <p-dropdown
                                                formControlName="secreciones.ocular"
                                                [options]="[
                                                    {
                                                        label: 'Sí',
                                                        value: true
                                                    },
                                                    {
                                                        label: 'No',
                                                        value: false
                                                    }
                                                ]"
                                                [showClear]="true"
                                            ></p-dropdown>
                                        </div>
                                    </div>
                                    <div class="col-12 md:col-6">
                                        <div class="field">
                                            <label>Nasales</label>
                                            <p-dropdown
                                                formControlName="secreciones.nasal"
                                                [options]="[
                                                    {
                                                        label: 'Sí',
                                                        value: true
                                                    },
                                                    {
                                                        label: 'No',
                                                        value: false
                                                    }
                                                ]"
                                                [showClear]="true"
                                            ></p-dropdown>
                                        </div>
                                    </div>
                                </div>
                            </p-panel>
                        </div>

                        <div class="col-12">
                            <p-panel header="Signos Clínicos">
                                <div class="grid">
                                    <div class="col-12 md:col-6 lg:col-3">
                                        <div class="field">
                                            <label>Nerviosos</label>
                                            <p-dropdown
                                                formControlName="signos.nervioso"
                                                [options]="[
                                                    {
                                                        label: 'Sí',
                                                        value: true
                                                    },
                                                    {
                                                        label: 'No',
                                                        value: false
                                                    }
                                                ]"
                                                [showClear]="true"
                                            ></p-dropdown>
                                        </div>
                                    </div>
                                    <div class="col-12 md:col-6 lg:col-3">
                                        <div class="field">
                                            <label>Respiratorios</label>
                                            <p-dropdown
                                                formControlName="signos.respiratorio"
                                                [options]="[
                                                    {
                                                        label: 'Sí',
                                                        value: true
                                                    },
                                                    {
                                                        label: 'No',
                                                        value: false
                                                    }
                                                ]"
                                                [showClear]="true"
                                            ></p-dropdown>
                                        </div>
                                    </div>
                                    <div class="col-12 md:col-6 lg:col-3">
                                        <div class="field">
                                            <label>Digestivos</label>
                                            <p-dropdown
                                                formControlName="signos.digestivo"
                                                [options]="[
                                                    {
                                                        label: 'Sí',
                                                        value: true
                                                    },
                                                    {
                                                        label: 'No',
                                                        value: false
                                                    }
                                                ]"
                                                [showClear]="true"
                                            ></p-dropdown>
                                        </div>
                                    </div>
                                    <div class="col-12 md:col-6 lg:col-3">
                                        <div class="field">
                                            <label>Vesiculares</label>
                                            <p-dropdown
                                                formControlName="signos.vesicular"
                                                [options]="[
                                                    {
                                                        label: 'Sí',
                                                        value: true
                                                    },
                                                    {
                                                        label: 'No',
                                                        value: false
                                                    }
                                                ]"
                                                [showClear]="true"
                                            ></p-dropdown>
                                        </div>
                                    </div>
                                </div>
                            </p-panel>
                        </div>

                        <div class="col-12">
                            <p-panel header="Características del Animal">
                                <div class="grid">
                                    <div class="col-12 md:col-6">
                                        <div class="field">
                                            <label>Color</label>
                                            <input
                                                pInputText
                                                formControlName="caracteristicasAnimal.color"
                                            />
                                        </div>
                                    </div>
                                    <div class="col-12 md:col-6">
                                        <div class="field">
                                            <label>Tamaño de Cacho</label>
                                            <input
                                                pInputText
                                                formControlName="caracteristicasAnimal.tamanoCacho"
                                            />
                                        </div>
                                    </div>
                                </div>
                            </p-panel>
                        </div>
                    </div>
                </p-panel>
            </ng-template>

            <!-- Panel común para fotos -->
            <p-panel header="Fotos" styleClass="mb-3">
                <div class="photos-section">
                    <div class="upload-section mb-4">
                        <p-fileUpload
                            mode="basic"
                            name="photos"
                            url="/api/upload"
                            accept="image/*"
                            chooseLabel="Subir Fotos"
                            multiple
                        ></p-fileUpload>
                        <div class="upload-info">
                            <small
                                >Puedes subir múltiples fotos (máx. 5MB cada
                                una)</small
                            >
                        </div>
                    </div>

                    <div class="grid">
                        <!-- Existing photos placeholder -->
                        <div class="col-12 md:col-6">
                            <div class="existing-photos">
                                <h6>Fotos Existentes</h6>
                                <div class="grid">
                                    <div
                                        class="col-12 sm:col-6 lg:col-4"
                                        *ngFor="let photo of []"
                                    >
                                        <div class="photo-card existing">
                                            <img
                                                [src]="photo.url"
                                                class="photo-thumbnail"
                                                alt="Foto de inspección"
                                            />
                                            <div class="photo-actions">
                                                <p-button
                                                    icon="pi pi-eye"
                                                    data-pc-severity="info"
                                                ></p-button>
                                                <p-button
                                                    icon="pi pi-trash"
                                                    data-pc-severity="danger"
                                                ></p-button>
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="col-12"
                                        *ngIf="[]?.length === 0"
                                    >
                                        <div
                                            class="empty-photos p-4 flex flex-column align-items-center justify-content-center gap-2"
                                        >
                                            <i
                                                class="pi pi-camera text-4xl"
                                            ></i>
                                            <small
                                                >No hay fotos existentes</small
                                            >
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- New photos placeholder -->
                        <div class="col-12 md:col-6">
                            <div class="new-photos">
                                <h6>Fotos Nuevas</h6>
                                <div class="grid">
                                    <div
                                        class="col-12 sm:col-6 lg:col-4"
                                        *ngFor="let photo of []"
                                    >
                                        <div class="photo-card new">
                                            <div class="photo-preview">
                                                <i
                                                    class="pi pi-image text-4xl"
                                                ></i>
                                                <div class="photo-name">
                                                    {{ photo.name }}
                                                </div>
                                                <div class="photo-size">
                                                    {{ photo.size | fileSize }}
                                                </div>
                                            </div>
                                            <div class="photo-actions">
                                                <p-button
                                                    icon="pi pi-trash"
                                                    data-pc-severity="danger"
                                                ></p-button>
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="col-12"
                                        *ngIf="[]?.length === 0"
                                    >
                                        <div
                                            class="empty-photos p-4 flex flex-column align-items-center justify-content-center gap-2"
                                        >
                                            <i
                                                class="pi pi-camera text-4xl"
                                            ></i>
                                            <small>No hay fotos nuevas</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </p-panel>

            <!-- Panel común para resultado -->
            <p-panel header="Resultado" styleClass="mb-3">
                <div class="grid">
                    <div class="col-12 md:col-6">
                        <div class="field">
                            <label for="resultado">Resultado *</label>
                            <p-dropdown
                                id="resultado"
                                formControlName="resultado"
                                [options]="resultOptions"
                                optionLabel="label"
                                optionValue="value"
                                [class]="{
                                    'ng-invalid ng-touched':
                                        inspectionForm.get('resultado')
                                            ?.invalid &&
                                        inspectionForm.get('resultado')?.touched
                                }"
                            ></p-dropdown>
                            <small
                                *ngIf="
                                    inspectionForm.get('resultado')?.invalid &&
                                    inspectionForm.get('resultado')?.touched
                                "
                                class="p-error"
                            >
                                Resultado es requerido
                            </small>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="field">
                            <label for="veterinarioResponsable"
                                >Veterinario Responsable</label
                            >
                            <input
                                pInputText
                                id="veterinarioResponsable"
                                formControlName="veterinarioResponsable"
                            />
                        </div>
                    </div>

                    <div
                        class="col-12"
                        *ngIf="
                            inspectionForm.get('resultado')?.value !== 'Apto' &&
                            inspectionForm.get('resultado')?.value !==
                                'Pendiente'
                        "
                    >
                        <div class="field">
                            <label for="motivoDictamen"
                                >Motivo del Dictamen *</label
                            >
                            <textarea
                                id="motivoDictamen"
                                formControlName="motivoDictamen"
                                rows="4"
                                [maxlength]="1000"
                                pInputTextarea
                                [class]="{
                                    'ng-invalid ng-touched':
                                        inspectionForm.get('motivoDictamen')
                                            ?.invalid &&
                                        inspectionForm.get('motivoDictamen')
                                            ?.touched
                                }"
                            ></textarea>
                            <small class="text-color-secondary"
                                >{{
                                    inspectionForm.get("motivoDictamen")?.value
                                        ?.length || 0
                                }}/1000</small
                            >
                            <small
                                *ngIf="
                                    inspectionForm.get('motivoDictamen')
                                        ?.invalid &&
                                    inspectionForm.get('motivoDictamen')
                                        ?.touched
                                "
                                class="p-error"
                            >
                                Motivo del dictamen es requerido para este
                                resultado
                            </small>
                        </div>
                    </div>
                </div>
            </p-panel>
        </div>
    </form>

    <ng-template pTemplate="footer">
        <div class="flex justify-content-between">
            <div>
                <small class="text-color-secondary"
                    >* Campos obligatorios</small
                >
            </div>
            <div class="flex gap-2">
                <p-button
                    label="Cancelar"
                    icon="pi pi-times"
                    (onClick)="onCancel()"
                    styleClass="p-button-outlined"
                ></p-button>
                <p-button
                    [label]="inspectionId ? 'Actualizar' : 'Guardar'"
                    icon="pi pi-check"
                    (onClick)="onSubmit()"
                    [loading]="submitting"
                ></p-button>
            </div>
        </div>
    </ng-template>
</p-dialog>
