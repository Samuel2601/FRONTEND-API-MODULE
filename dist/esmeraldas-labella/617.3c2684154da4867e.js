"use strict";(self.webpackChunkesmeraldas_labella=self.webpackChunkesmeraldas_labella||[]).push([[617],{5617:(fd,Ce,d)=>{d.r(Ce),d.d(Ce,{MapsModule:()=>hd});var b=d(6708),x=d(1761),g=d(4516),Ke=d(1927),Ie=d(9789),Qe=d(8204),V=d(7156),et=d(5059),B=d(6813),ye=d(6509),T=d(2648),u=d(2353),c=d(7076),pe=d(8354),tt=d(7495),z=d(4178),e=d(9573),L=d(2863),f=d(8378),U=d(7810),S=d(3290),Y=d(7085),k=d(9033),F=d(4951),v=d(7403),E=d(7356),ee=d(2908),te=d(4503),me=d(2226),X=d(3943),H=d(5927);const it=()=>({"max-width":"850px"});function nt(n,r){if(1&n&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.R7$(),e.Lme(" ",t.name," - ",t.size," bytes ")}}function ot(n,r){if(1&n&&(e.j41(0,"ul"),e.DNE(1,nt,2,2,"li",22),e.k0s()),2&n){const t=e.XpG(5);e.R7$(),e.Y8G("ngForOf",t.selectedFiles)}}function at(n,r){if(1&n&&e.DNE(0,ot,2,1,"ul",0),2&n){const t=e.XpG(4);e.Y8G("ngIf",t.selectedFiles.length)}}function rt(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",7)(1,"p-fileUpload",20),e.bIt("onUpload",function(o){e.eBV(t);const a=e.XpG(3);return e.Njj(a.onFilesSelected(o))}),e.DNE(2,at,1,1,"ng-template",21),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(),e.Y8G("multiple",!0)("maxFileSize",5e6)("fileLimit",5-t.selectedFiles.length)}}function st(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",7)(1,"h4",23),e.EFF(2," A\xf1ade fotos: "),e.j41(3,"p-button",24),e.bIt("click",function(o){e.eBV(t);const a=e.XpG(3);return e.Njj(a.tomarFotoYEnviar(o))}),e.k0s()()()}2&n&&(e.R7$(3),e.Y8G("raised",!0)("outlined",!0))}function lt(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",29),e.bIt("click",function(){e.eBV(t);const o=e.XpG(4);return e.Njj(o.imageClick(0))}),e.k0s()}2&n&&e.Y8G("raised",!0)("outlined",!0)}function ct(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",30),e.bIt("onClick",function(){e.eBV(t);const o=e.XpG(4);return o.upload=!0,o.imagenesSeleccionadas=[],e.Njj(o.selectedFiles=[])}),e.k0s()}}function dt(n,r){1&n&&e.nrm(0,"img",31),2&n&&e.Y8G("src",r.$implicit.itemImageSrc,e.B4B)}function pt(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",7),e.DNE(1,lt,1,2,"p-button",25)(2,ct,1,0,"p-button",26),e.j41(3,"p-galleria",27),e.mxI("visibleChange",function(o){e.eBV(t);const a=e.XpG(3);return e.DH7(a.displayCustom,o)||(a.displayCustom=o),e.Njj(o)})("activeIndexChange",function(o){e.eBV(t);const a=e.XpG(3);return e.DH7(a.activeIndex,o)||(a.activeIndex=o),e.Njj(o)}),e.DNE(4,dt,1,1,"ng-template",28),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(),e.Y8G("ngIf",t.imagenesSeleccionadas.length>0),e.R7$(),e.Y8G("ngIf",t.imagenesSeleccionadas.length>0),e.R7$(),e.Y8G("value",t.imagenesSeleccionadas),e.R50("visible",t.displayCustom)("activeIndex",t.activeIndex),e.Y8G("responsiveOptions",t.responsiveOptions)("containerStyle",e.lJ4(12,it))("numVisible",7)("circular",!0)("fullScreen",!0)("showItemNavigators",!0)("showThumbnails",!1)}}function mt(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"form",5),e.bIt("ngSubmit",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.registrarFichaSectorial())}),e.j41(2,"div",6)(3,"div",7)(4,"h4",8),e.EFF(5),e.k0s()()(),e.j41(6,"div",6)(7,"div",9)(8,"div",7)(9,"h4",10),e.EFF(10," Actividad de Proyecto "),e.k0s(),e.nrm(11,"p-dropdown",11),e.k0s()(),e.j41(12,"div",9)(13,"div",7)(14,"h4",12),e.EFF(15," Fecha del Evento: "),e.k0s(),e.nrm(16,"p-calendar",13),e.k0s()()(),e.j41(17,"div",6)(18,"div",9)(19,"div",7)(20,"h4",14),e.EFF(21," Estado de Actividad de Proyecto "),e.k0s(),e.nrm(22,"p-dropdown",15),e.k0s()()(),e.j41(23,"div",6)(24,"div",9)(25,"div",7)(26,"h4",16),e.EFF(27," Descripci\xf3n "),e.k0s(),e.nrm(28,"textarea",17),e.k0s()()(),e.DNE(29,rt,3,3,"div",18)(30,st,4,2,"div",18)(31,pt,5,13,"div",18),e.j41(32,"p-button",19),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.registrarFichaSectorial())}),e.k0s()(),e.bVm()}if(2&n){const t=e.XpG(2);e.R7$(),e.Y8G("formGroup",t.fichaSectorialForm),e.R7$(4),e.SpI(" Direcci\xf3n Geogr\xe1fica: ",t.fichaSectorialForm.get("direccion_geo").value," "),e.R7$(6),e.Y8G("options",t.actividadesProyecto),e.R7$(5),e.Y8G("touchUI",t.isMobil())("readonlyInput",t.isMobil())("showTime",!0)("showIcon",!0),e.R7$(6),e.Y8G("options",t.estadosActividadProyecto),e.R7$(7),e.Y8G("ngIf",!t.isMobil()&&t.upload),e.R7$(),e.Y8G("ngIf",t.isMobil()&&t.upload),e.R7$(),e.Y8G("ngIf",t.load_carrusel)}}function ut(n,r){1&n&&(e.qex(0),e.j41(1,"div",32)(2,"div",33)(3,"span",34),e.EFF(4,"Cargando..."),e.k0s()()(),e.bVm())}function _t(n,r){if(1&n&&(e.qex(0),e.nrm(1,"p-toast"),e.j41(2,"div",1)(3,"div",2)(4,"h2",3),e.EFF(5,"Nueva Ficha Sectorial"),e.k0s()()(),e.j41(6,"div",4),e.DNE(7,mt,33,11,"ng-container",0)(8,ut,5,0,"ng-container",0),e.k0s(),e.bVm()),2&n){const t=e.XpG();e.R7$(7),e.Y8G("ngIf",t.load_form),e.R7$(),e.Y8G("ngIf",!t.load_form)}}let gt=(()=>{class n{constructor(t,i,o,a,s,l,p,m,_,h,y){this.modalService=t,this.config=i,this.fb=o,this.createService=a,this.router=s,this.listarService=l,this.adminservice=p,this.helper=m,this.messageService=_,this.ref=h,this.auth=y,this.estadosActividadProyecto=[],this.actividadesProyecto=[],this.model=!0,this.token=this.auth.token(),this.mostrar=!1,this.hover=!1,this.imagenesSeleccionadas=[],this.load_carrusel=!1,this.file=[],this.selectedFiles=[],this.upload=!0,this.responsiveOptions=[{breakpoint:"1024px",numVisible:5},{breakpoint:"768px",numVisible:3},{breakpoint:"560px",numVisible:1}],this.load_form=!0,this.activeIndex=0,this.fichaSectorialForm=this.fb.group({descripcion:["",c.k0.required],encargado:["",c.k0.required],direccion_geo:["",c.k0.required],estado:[void 0,c.k0.required],actividad:[void 0,c.k0.required],fecha_evento:[""],observacion:[""]})}ngOnInit(){if(this.config&&this.config.data&&this.config.data.data&&(this.data=this.config.data.data),this.data){const i=this.fichaSectorialForm.get("direccion_geo");i&&i.setValue(this.data.properties.nombre)}else this.router.navigate(["/home"]);const t=this.auth.idUserToken(this.token);if(t){const i=this.fichaSectorialForm.get("encargado");i&&i.setValue(t)}else this.router.navigate(["/auth/login"]);this.router.events.subscribe(i=>{this.model="/create-ficha-sectorial"!==this.router.url}),this.listartEstados(),this.listarActividadProyecto()}listartEstados(){this.listarService.listarEstadosActividadesProyecto(this.token).subscribe(t=>{t.data.length>0&&(this.estadosActividadProyecto=t.data)},t=>{"InvalidToken"==t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})}listarActividadProyecto(){this.listarService.listarTiposActividadesProyecto(this.token).subscribe(t=>{t.data.length>0&&(this.actividadesProyecto=t.data,this.mostrar=!0)},t=>{"InvalidToken"==t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})}DimissModal(){this.modalService.dismissAll()}abrirModal(){this.model=!0}cerrarModal(){this.model=!1}activarHover(){this.hover=!0}desactivarHover(){this.hover=!1}isMobil(){return this.helper.isMobil()}onFilesSelected(t){this.upload=!0;for(let o of t.files){this.selectedFiles.push(o);const a=URL.createObjectURL(o);this.imagenesSeleccionadas.push({itemImageSrc:a}),5==this.selectedFiles.length&&(this.upload=!1)}this.messageService.add({severity:"info",summary:"Excelente",detail:this.selectedFiles.length+"Imagenes subidas"}),setTimeout(()=>{this.load_carrusel=!0},1e3)}eliminarImagen(t){this.upload=!0,this.imagenesSeleccionadas.splice(t,1),this.selectedFiles.splice(t,1),setTimeout(()=>{this.load_carrusel=!0},500)}registrarFichaSectorial(){this.load_form=!1,this.fichaSectorialForm?.valid&&this.fichaSectorialForm.value&&this.createService.registrarActividadProyecto(this.token,this.fichaSectorialForm.value,this.selectedFiles).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Listo",detail:"Ingresado correctamente"}),this.ref.close())},t=>{"InvalidToken"==t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})}responsiveimage(){return(window.innerWidth-50).toString()}tomarFotoYEnviar(t){var i=this;return(0,g.A)(function*(){i.upload=!0;const o=yield z.i7.getPhoto({quality:90,allowEditing:!1,resultType:z.LK.Base64,source:z.ru.Prompt,promptLabelPhoto:"Seleccionar de la galer\xeda",promptLabelPicture:"Tomar foto"});if(o&&o.base64String&&i.selectedFiles.length<=5){const a=atob(o.base64String),s=new Array(a.length);for(let h=0;h<a.length;h++)s[h]=a.charCodeAt(h);const l=new Uint8Array(s),p=new Blob([l],{type:"image/jpeg"});let m=new File([p],"prueba",{type:"image/jpeg"});i.selectedFiles.push(m);const _=new FileReader;_.onload=h=>{i.imagenesSeleccionadas.push({itemImageSrc:h.target.result})},_.readAsDataURL(m),setTimeout(()=>{i.load_carrusel=!0},1e3),5==i.selectedFiles.length&&(i.upload=!1)}else i.messageService.add({severity:"warning",summary:"MAX img",detail:"Solo puede enviar 5 imangenes"})})()}imageClick(t){this.activeIndex=t,this.displayCustom=!0}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(L.Bq),e.rXU(f.sb),e.rXU(c.ok),e.rXU(U.m),e.rXU(x.Ix),e.rXU(S.a),e.rXU(Y.z),e.rXU(k.w),e.rXU(u.bg),e.rXU(f.Pw),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-ficha-sectorial"]],features:[e.Jv_([u.bg])],decls:1,vars:1,consts:[[4,"ngIf"],[1,"modal-header"],[1,"inline-flex","align-items-center","justify-content-center","gap-2"],[1,"modal-title"],[1,"card"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"mb-3"],["for","direccion_geo",1,"form-label"],[1,"p-col-12","p-md-6"],["for","actividad",1,"form-label"],["placeholder","Selecciona una Actividad","id","actividad","name","actividad","formControlName","actividad","optionLabel","nombre",3,"options"],["for","fecha_evento",1,"form-label"],["id","fecha_evento","name","fecha_evento","formControlName","fecha_evento","appendTo","body","inputId","buttondisplay",3,"touchUI","readonlyInput","showTime","showIcon"],["for","estado",1,"form-label"],["placeholder","Selecciona un estado","id","estado","name","estado","formControlName","estado","optionLabel","nombre",3,"options"],["for","descripcion",1,"form-label"],["rows","5","cols","25","pInputTextarea","","id","descripcion","name","descripcion","formControlName","descripcion","required",""],["class","mb-3",4,"ngIf"],["label","Crear Ficha","icon","bi bi-save",3,"click"],["chooseLabel","Seleccionar","uploadLabel","Cargar","cancelLabel","Cancelar","name","demo[]","url","https://www.primefaces.org/cdn/api/upload.php","accept","image/*","invalidFileLimitMessageSummary","Se super\xf3 el n\xfamero m\xe1ximo de archivos",3,"onUpload","multiple","maxFileSize","fileLimit"],["pTemplate","content"],[4,"ngFor","ngForOf"],["for","formFileMultiple",1,"form-label"],["id","fotoButton","icon","pi bi-camera2-custom","label","A\xf1adir nueva Foto",3,"click","raised","outlined"],["class","m-3","icon","pi bi-box-arrow-up-right","label","Ver Fotos",3,"raised","outlined","click",4,"ngIf"],["class","m-3","label","Borrar Fotos","severity","warning","icon","pi pi-trash",3,"onClick",4,"ngIf"],[3,"visibleChange","activeIndexChange","value","visible","activeIndex","responsiveOptions","containerStyle","numVisible","circular","fullScreen","showItemNavigators","showThumbnails"],["pTemplate","item"],["icon","pi bi-box-arrow-up-right","label","Ver Fotos",1,"m-3",3,"click","raised","outlined"],["label","Borrar Fotos","severity","warning","icon","pi pi-trash",1,"m-3",3,"onClick"],[2,"width","60%","display","block",3,"src"],[1,"text-center"],["role","status",1,"spinner-border","text-success"],[1,"visually-hidden"]],template:function(i,o){1&i&&e.DNE(0,_t,9,2,"ng-container",0),2&i&&e.Y8G("ngIf",o.model)},dependencies:[b.Sq,b.bT,u.Ei,v.$n,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,ee.aQ,te.N,me.Vv,X.ms,H.Z],styles:[".p-col-12[_ngcontent-%COMP%]{padding:1rem}"]})}return n})();const ht=()=>({"max-width":"850px"});function ft(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.SpI("/",t.geolocation.address.road,"")}}function bt(n,r){if(1&n&&(e.j41(0,"div",16)(1,"div"),e.EFF(2),e.k0s()()),2&n){let t;const i=e.XpG(3);e.R7$(2),e.SpI(" ",null==(t=i.nuevoIncidenteDenuncia.get("categoria"))||null==t.value?null:t.value.nombre," ")}}function vt(n,r){if(1&n&&(e.j41(0,"div",16)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.nombre)}}function Ct(n,r){if(1&n&&(e.j41(0,"div",7)(1,"h4",17),e.EFF(2,"Subcategor\xeda"),e.k0s(),e.nrm(3,"p-dropdown",18),e.k0s()),2&n){const t=e.XpG(3);e.R7$(3),e.Y8G("options",t.subcategorias)("required",!0)}}function It(n,r){if(1&n&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.R7$(),e.Lme(" ",t.name," - ",t.size," bytes ")}}function yt(n,r){if(1&n&&(e.j41(0,"ul"),e.DNE(1,It,2,2,"li",21),e.k0s()),2&n){const t=e.XpG(5);e.R7$(),e.Y8G("ngForOf",t.selectedFiles)}}function xt(n,r){if(1&n&&e.DNE(0,yt,2,1,"ul",0),2&n){const t=e.XpG(4);e.Y8G("ngIf",t.selectedFiles.length)}}function kt(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",7)(1,"p-fileUpload",19),e.bIt("onUpload",function(o){e.eBV(t);const a=e.XpG(3);return e.Njj(a.onFilesSelected(o))}),e.DNE(2,xt,1,1,"ng-template",20),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(),e.Y8G("multiple",!0)("maxFileSize",5e6)("fileLimit",5-t.selectedFiles.length)}}function Ft(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",7)(1,"h4",22),e.EFF(2," A\xf1ade fotos: "),e.j41(3,"p-button",23),e.bIt("click",function(o){e.eBV(t);const a=e.XpG(3);return e.Njj(a.tomarFotoYEnviar(o))}),e.k0s()()()}2&n&&(e.R7$(3),e.Y8G("raised",!0)("outlined",!0))}function Et(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",27),e.bIt("click",function(){e.eBV(t);const o=e.XpG(4);return e.Njj(o.imageClick(0))}),e.k0s()}2&n&&e.Y8G("raised",!0)("outlined",!0)}function St(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",28),e.bIt("onClick",function(){e.eBV(t);const o=e.XpG(4);return o.upload=!0,o.imagenesSeleccionadas=[],e.Njj(o.selectedFiles=[])}),e.k0s()}}function Mt(n,r){1&n&&e.nrm(0,"img",29),2&n&&e.Y8G("src",r.$implicit.itemImageSrc,e.B4B)}function jt(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",7),e.DNE(1,Et,1,2,"p-button",24)(2,St,1,0,"p-button",25),e.j41(3,"p-galleria",26),e.mxI("visibleChange",function(o){e.eBV(t);const a=e.XpG(3);return e.DH7(a.displayCustom,o)||(a.displayCustom=o),e.Njj(o)})("activeIndexChange",function(o){e.eBV(t);const a=e.XpG(3);return e.DH7(a.activeIndex,o)||(a.activeIndex=o),e.Njj(o)}),e.DNE(4,Mt,1,1,"ng-template",11),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(),e.Y8G("ngIf",t.imagenesSeleccionadas.length>0),e.R7$(),e.Y8G("ngIf",t.imagenesSeleccionadas.length>0),e.R7$(),e.Y8G("value",t.imagenesSeleccionadas),e.R50("visible",t.displayCustom)("activeIndex",t.activeIndex),e.Y8G("responsiveOptions",t.responsiveOptions)("containerStyle",e.lJ4(12,ht))("numVisible",7)("circular",!0)("fullScreen",!0)("showItemNavigators",!0)("showThumbnails",!1)}}function Tt(n,r){if(1&n){const t=e.RV6();e.j41(0,"form",6),e.bIt("ngSubmit",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.crearIncidenteDenuncia())}),e.j41(1,"div",7)(2,"h4",8),e.EFF(3,"Categor\xeda"),e.k0s(),e.j41(4,"p-dropdown",9),e.bIt("onChange",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.selectcategoria())}),e.DNE(5,bt,3,1,"ng-template",10)(6,vt,3,1,"ng-template",11),e.k0s()(),e.DNE(7,Ct,4,2,"div",12),e.j41(8,"div",7)(9,"h4",13),e.EFF(10,"Descripci\xf3n"),e.k0s(),e.nrm(11,"textarea",14),e.k0s(),e.DNE(12,kt,3,3,"div",12)(13,Ft,4,2,"div",12)(14,jt,5,13,"div",12),e.j41(15,"div",7)(16,"p-button",15),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.crearIncidenteDenuncia())}),e.k0s()()()}if(2&n){const t=e.XpG(2);e.Y8G("formGroup",t.nuevoIncidenteDenuncia),e.R7$(4),e.Y8G("options",t.categorias)("required",!0),e.R7$(3),e.Y8G("ngIf",t.subcategorias.length>0),e.R7$(5),e.Y8G("ngIf",!t.isMobil()&&t.upload),e.R7$(),e.Y8G("ngIf",t.isMobil()&&t.upload),e.R7$(),e.Y8G("ngIf",t.mostrargale)}}function wt(n,r){1&n&&(e.qex(0),e.j41(1,"div",30)(2,"div",31)(3,"span",32),e.EFF(4,"Cargando..."),e.k0s()()(),e.bVm())}function Rt(n,r){if(1&n&&(e.qex(0),e.nrm(1,"p-toast"),e.j41(2,"div",1)(3,"div",2)(4,"h2",3),e.EFF(5," Nuevo Incidente o Denuncia : "),e.j41(6,"span"),e.EFF(7),e.k0s(),e.DNE(8,ft,2,1,"span",0),e.k0s()()(),e.j41(9,"div",4),e.DNE(10,Tt,17,7,"form",5)(11,wt,5,0,"ng-container",0),e.k0s(),e.bVm()),2&n){let t;const i=e.XpG();e.R7$(7),e.JRh(null==(t=i.nuevoIncidenteDenuncia.get("direccion_geo"))?null:t.value.nombre),e.R7$(),e.Y8G("ngIf",i.geolocation&&i.geolocation.address&&i.geolocation.address.road),e.R7$(2),e.Y8G("ngIf",i.load_form),e.R7$(),e.Y8G("ngIf",!i.load_form)}}let Dt=(()=>{class n{constructor(t,i,o,a,s,l,p,m,_,h){this.fb=t,this.createService=i,this.router=o,this.listService=a,this.adminservice=s,this.helper=l,this.messageService=p,this.config=m,this.ref=_,this.auth=h,this.categorias=[],this.subcategorias=[],this.model=!0,this.mostrar=!1,this.token=this.auth.token(),this.imagenesSeleccionadas=[],this.load_carrusel=!1,this.upload=!0,this.file=[],this.responsiveOptions=[{breakpoint:"1024px",numVisible:5},{breakpoint:"768px",numVisible:3},{breakpoint:"560px",numVisible:1}],this.mostrargale=!1,this.selectedFiles=[],this.load_form=!1,this.hover=!1,this.activeIndex=0,this.nuevoIncidenteDenuncia=this.fb.group({categoria:["",c.k0.required],subcategoria:["",c.k0.required],descripcion:["",c.k0.required],direccion_geo:[{},c.k0.required],ciudadano:["",c.k0.required],estado:["",c.k0.required]})}tomarFoto(){var t=this;return(0,g.A)(function*(){const i=yield z.i7.getPhoto({quality:100,allowEditing:!1,resultType:z.LK.Base64,source:z.ru.Prompt,promptLabelPhoto:"Tomar foto",promptLabelPicture:"Seleccionar de la galer\xeda"});t.imagenesSeleccionadas.push({itemImageSrc:`data:image/jpeg;base64,${i.base64String}`}),t.file.push(t.base64ToFile(i.base64String,"imagen.jpg"))})()}base64ToFile(t,i){const o=atob(t.split(",")[1]),a=new ArrayBuffer(o.length),s=new Uint8Array(a);for(let p=0;p<o.length;p++)s[p]=o.charCodeAt(p);const l=new Blob([a],{type:"image/jpeg"});return new File([l],i,{type:"image/jpeg"})}obtenerDireccion(t,i){var o=this;return(0,g.A)(function*(){fetch(`https://nominatim.openstreetmap.org/reverse?lat=${t}&lon=${i}&format=json`).then(s=>s.json()).then(s=>(o.geolocation=s,s)).catch(s=>{console.error("Error al realizar la solicitud:",s)})})()}listartEstados(){this.listService.listarEstadosIncidentes(this.token).subscribe(t=>{if(t.data&&t.data.length>0){const i=t.data.find(o=>1==o.orden);this.nuevoIncidenteDenuncia.get("estado").setValue(i._id)}},t=>{console.error(t),"InvalidToken"==t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})}ngOnInit(){var t=this;return(0,g.A)(function*(){t.config&&t.config.data&&t.config.data.data&&(t.data=t.config.data.data),t.config&&t.config.data&&t.config.data.direccion&&(t.direccion=t.config.data.direccion),t.config&&t.config.data&&t.config.data.tipo&&(t.tipocat=t.config.data.tipo),t.config&&t.config.data&&t.config.data.subtipo&&(t.tiposucat=t.config.data.subtipo),t.load_form=!1,t.data?t.nuevoIncidenteDenuncia.get("direccion_geo").setValue({nombre:t.data?.properties?.nombre?t.data.properties.nombre:"Barrio sin nombre",latitud:t.direccion.latitud,longitud:t.direccion.longitud}):t.router.navigate(["/maps"]),t.router.events.subscribe(i=>{t.model="/create-incidentes-denuncia"!==t.router.url});try{yield Promise.all([yield t.obtenerDireccion(t.direccion.latitud,t.direccion.longitud),t.listarCategorias(),t.listartEstados()])}finally{setTimeout(()=>{t.load_form=!0},1500)}})()}getLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(t=>{alert("Latitude: "+t.coords.latitude+", Longitude: "+t.coords.longitude)},t=>{})}selectcategoria(){if(this.nuevoIncidenteDenuncia.get("categoria")){const t=this.nuevoIncidenteDenuncia.get("categoria")?.value._id;this.listService.listarSubcategorias(this.token,{categoria:t},!1).subscribe(i=>{if(this.subcategorias=i.data,this.tiposucat){const o=this.subcategorias.find(a=>a.nombre==this.tiposucat);o&&(this.nuevoIncidenteDenuncia.get("subcategoria")?.setValue(o),this.nuevoIncidenteDenuncia.get("subcategoria")?.disable())}},i=>{"InvalidToken"==i.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+i.status+")").toString(),detail:i.error.message||"Sin conexi\xf3n"})})}}listarCategorias(){var t=this;return(0,g.A)(function*(){t.listService.listarCategorias(t.token).subscribe(i=>{if(t.categorias=i.data,t.tipocat){const o=t.categorias.find(a=>a.nombre===t.tipocat);o&&(t.nuevoIncidenteDenuncia.get("categoria")?.setValue(o),t.nuevoIncidenteDenuncia.get("categoria")?.disable(),t.selectcategoria())}t.mostrar=!0},i=>{"InvalidToken"==i.error.message?t.router.navigate(["/auth/login"]):t.messageService.add({severity:"error",summary:("("+i.status+")").toString(),detail:i.error.message||"Sin conexi\xf3n"})})})()}isMobil(){return this.helper.isMobil()}onFileSelected(t){this.upload=!0;const i=t.target.files[0];if(i){if(!i.type.startsWith("image/"))return void alert("Por favor, seleccione un archivo de imagen.");if(i.size>4194304)return void alert("Por favor, seleccione un archivo de imagen que sea menor a 4MB.");const o=new FileReader;o.onload=()=>{this.imagenesSeleccionadas.push(o.result)},setTimeout(()=>{this.upload=!1,this.mostrargale=!0},1e3),o.readAsDataURL(i),this.file.push(i)}}responsiveimage(){return(window.innerWidth-70).toString()}onFilesSelected(t){this.load_carrusel=!1;for(let o of t.files){this.selectedFiles.push(o);const a=URL.createObjectURL(o);this.imagenesSeleccionadas.push({itemImageSrc:a}),5==this.selectedFiles.length&&(this.upload=!1)}this.messageService.add({severity:"info",summary:"Excelente",detail:this.selectedFiles.length+"Imagenes subidas"}),this.mostrargale=!0}tomarFotoYEnviar(t){var i=this;return(0,g.A)(function*(){i.load_carrusel=!1,i.upload=!0;const o=yield z.i7.getPhoto({quality:90,allowEditing:!1,resultType:z.LK.Base64,source:z.ru.Prompt,promptLabelPhoto:"Seleccionar de la galer\xeda",promptLabelPicture:"Tomar foto"});if(o&&o.base64String&&i.selectedFiles.length<=5){const a=atob(o.base64String),s=new Array(a.length);for(let h=0;h<a.length;h++)s[h]=a.charCodeAt(h);const l=new Uint8Array(s),p=new Blob([l],{type:"image/jpeg"});let m=new File([p],"prueba",{type:"image/jpeg"});i.selectedFiles.push(m);const _=new FileReader;_.onload=h=>{i.imagenesSeleccionadas.push({itemImageSrc:h.target.result})},setTimeout(()=>{i.mostrargale=!0},1e3),_.readAsDataURL(m),i.load_carrusel=!0,5==i.selectedFiles.length&&(i.upload=!1)}else i.messageService.add({severity:"warning",summary:"MAX img",detail:"Solo puede enviar 5 imangenes"}),i.load_carrusel=!0})()}eliminarImagen(t){this.load_carrusel=!1,this.imagenesSeleccionadas.splice(t,1),this.selectedFiles.splice(t,1),setTimeout(()=>{this.load_carrusel=!0},500)}crearIncidenteDenuncia(){this.nuevoIncidenteDenuncia.get("ciudadano")?.setValue(this.auth.idUserToken(this.token)),this.nuevoIncidenteDenuncia.valid?(this.nuevoIncidenteDenuncia.enable(),this.load_form=!1,this.createService.registrarIncidenteDenuncia(this.token,this.nuevoIncidenteDenuncia.value,this.selectedFiles).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Ingresado",detail:"Correctamente"}),this.ref.close())},t=>{"InvalidToken"==t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})):this.messageService.add({severity:"error",summary:"ERROR",detail:"Complete todo el formulario"})}activarHover(){this.hover=!0}desactivarHover(){this.hover=!1}getTextareaCols(){const t=document.getElementById("descripcion").clientWidth;return Math.floor(t/8)}imageClick(t){this.activeIndex=t,this.displayCustom=!0}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.ok),e.rXU(U.m),e.rXU(x.Ix),e.rXU(S.a),e.rXU(Y.z),e.rXU(k.w),e.rXU(u.bg),e.rXU(f.sb),e.rXU(f.Pw),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-incidentes-denuncia"]],features:[e.Jv_([u.bg])],decls:1,vars:1,consts:[[4,"ngIf"],[1,"modal-header"],[1,"inline-flex","align-items-center","justify-content-center","gap-2"],[1,"modal-title"],[1,"card"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","categoria",1,"form-label"],["placeholder","Selecciona una Categor\xeda","appendTo","body","id","categoria","formControlName","categoria","optionLabel","nombre",3,"onChange","options","required"],["pTemplate","selectedItem"],["pTemplate","item"],["class","mb-3",4,"ngIf"],["for","descripcion",1,"form-label"],["pInputTextarea","","id","descripcion","name","descripcion","cols","50","rows","10","formControlName","descripcion","required","",1,"form-control"],["label","Crear Incidente o Denuncia",3,"click"],[1,"flex","align-items-center","gap-2"],["for","subcategoria",1,"form-label"],["placeholder","Selecciona una SubCategor\xeda","appendTo","body","id","subcategoria","name","subcategoria","formControlName","subcategoria","optionLabel","nombre",3,"options","required"],["chooseLabel","Seleccionar","uploadLabel","Cargar","cancelLabel","Cancelar","name","demo[]","url","https://www.primefaces.org/cdn/api/upload.php","accept","image/*","invalidFileLimitMessageSummary","Se super\xf3 el n\xfamero m\xe1ximo de archivos",3,"onUpload","multiple","maxFileSize","fileLimit"],["pTemplate","content"],[4,"ngFor","ngForOf"],["for","formFileMultiple",1,"form-label"],["id","fotoButton","icon","pi bi-camera2-custom","label","A\xf1adir nueva Foto",3,"click","raised","outlined"],["class","m-3","icon","pi bi-box-arrow-up-right","label","Ver Fotos",3,"raised","outlined","click",4,"ngIf"],["class","m-3","label","Borrar Fotos","severity","warning","icon","pi pi-trash",3,"onClick",4,"ngIf"],[3,"visibleChange","activeIndexChange","value","visible","activeIndex","responsiveOptions","containerStyle","numVisible","circular","fullScreen","showItemNavigators","showThumbnails"],["icon","pi bi-box-arrow-up-right","label","Ver Fotos",1,"m-3",3,"click","raised","outlined"],["label","Borrar Fotos","severity","warning","icon","pi pi-trash",1,"m-3",3,"onClick"],[2,"width","60%","display","block",3,"src"],[1,"text-center"],["role","status",1,"spinner-border","text-success"],[1,"visually-hidden"]],template:function(i,o){1&i&&e.DNE(0,Rt,12,4,"ng-container",0),2&i&&e.Y8G("ngIf",o.model)},dependencies:[b.Sq,b.bT,u.Ei,v.$n,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,ee.aQ,te.N,X.ms,H.Z],styles:['img[_ngcontent-%COMP%]:hover:after{content:"Eliminar";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#000000b3;color:#fff;padding:5px 10px;border-radius:5px}']})}return n})();var M=d(7228);let Gt=(()=>{class n{constructor(t,i,o,a,s,l,p,m,_){this.modalService=t,this.fb=i,this.createService=o,this.router=a,this.listarService=s,this.adminservice=l,this.helper=p,this.auth=m,this.config=_,this.modal=!0,this.estadosActividadProyecto=[],this.actividadesProyecto=[],this.url=V.M.url,this.token=this.auth.token(),this.hover=!1,this.fichaSectorialForm=this.fb.group({direccion_geo:["",c.k0.required]})}ngAfterViewInit(){this.router.events.subscribe(t=>{this.modal="/create-direccion-geo"!==this.router.url})}ngOnInit(){if(this.config&&this.config.data&&this.config.data.feature&&(this.valor=this.config.data.feature),this.valor){const t=this.fichaSectorialForm.get("direccion_geo");t&&t.setValue(this.valor.properties.nombre)}}DimissModal(){this.modalService.dismissAll()}abrirModal(){this.modal=!0}cerrarModal(){this.modal=!1}activarHover(){this.hover=!0}desactivarHover(){this.hover=!1}onFilesSelected(t){const i=t.files;if(i&&i.length>0)for(let o=0;o<Math.min(i.length,3);o++){const a=i[o];if(!a.type.startsWith("image/"))return void alert("Por favor, seleccione archivos de imagen.");if(a.size>4194304)return void alert("Por favor, seleccione archivos de imagen que sean menores a 4MB.");const s=new FileReader;s.onload=l=>{this.nombreArchivo=l.target.result},s.readAsDataURL(a),this.archivoSeleccionado=a}}registrarFichaSectorial(){this.fichaSectorialForm?.valid&&this.fichaSectorialForm.value&&this.createService.registrarDireccionGeo(this.token,this.valor.id,this.archivoSeleccionado).subscribe(t=>{t.data&&setTimeout(()=>{location.reload()},1e3)},t=>{"InvalidToken"==t.error.message&&this.router.navigate(["/auth/login"])})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(L.Bq),e.rXU(c.ok),e.rXU(U.m),e.rXU(x.Ix),e.rXU(S.a),e.rXU(Y.z),e.rXU(k.w),e.rXU(F.u),e.rXU(f.sb))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-direccion-geo"]],decls:17,vars:4,consts:[[1,"card-body"],[1,"w-full","surface-card"],[3,"ngSubmit","formGroup"],[1,"flex","flex-column","gap-2","mx-auto",2,"min-height","16rem","max-width","20rem"],[1,"text-center","mt-3","mb-3","text-xl","font-semibold"],["for","direccion_geo",1,"form-label"],["type","text","id","direccion_geo","name","direccion_geo","formControlName","direccion_geo","required","","pInputText","","readonly","",1,"form-control"],[1,"d-flex","align-items-center"],[1,"h-50","overflow-hidden"],["width","250","height","250","alt","Your profile picture",1,"img-fluid",2,"aspect-ratio","48 / 48","object-fit","cover","border-radius","17% !important",3,"src"],[1,"ms-3"],["mode","basic","name","demo[]","url","https://www.primefaces.org/cdn/api/upload.php","accept","image/*","chooseLabel","Browse",3,"onUpload","maxFileSize","auto"],[1,"flex","pt-4","justify-content-end"],["label","Enviar","icon","pi pi-save","iconPos","right","type","submit"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.nrm(1,"p-toast"),e.j41(2,"div",1)(3,"form",2),e.bIt("ngSubmit",function(){return o.registrarFichaSectorial()}),e.j41(4,"div",3)(5,"div",4)(6,"label",5),e.EFF(7,"Direcci\xf3n Geogr\xe1fica"),e.k0s(),e.nrm(8,"input",6),e.k0s(),e.j41(9,"div",4)(10,"div",7)(11,"div",8),e.nrm(12,"img",9),e.k0s(),e.j41(13,"div",10)(14,"p-fileUpload",11),e.bIt("onUpload",function(s){return o.onFilesSelected(s)}),e.k0s()()()(),e.j41(15,"div",12),e.nrm(16,"p-button",13),e.k0s()()()()()),2&i&&(e.R7$(3),e.Y8G("formGroup",o.fichaSectorialForm),e.R7$(9),e.FS9("src",o.nombreArchivo?o.nombreArchivo:o.url+"obtener_imagen/direccion_geo/"+o.valor.id,e.B4B),e.R7$(2),e.Y8G("maxFileSize",1e6)("auto",!0))},dependencies:[v.$n,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,te.N,M.S]})}return n})();var Pt=d(107);const zt=["formulariomap"],Xt=["infoWindowTemplate"],Nt=()=>({"border-radius":"50%"}),At=()=>({width:"200px",margin:"10px"}),xe=n=>({width:n}),ke=()=>({"margin-top":"10px"});function Bt(n,r){1&n&&e.nrm(0,"app-list-incidentes")}function Ut(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",23)(1,"span",24)(2,"p-autoComplete",25),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.query,o)||(a.query=o),e.Njj(o)}),e.bIt("completeMethod",function(o){e.eBV(t);const a=e.XpG();return e.Njj(a.search(o))})("onSelect",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.imprimir(o.query))}),e.k0s(),e.j41(3,"label",26),e.EFF(4,"Ingresa una direcci\xf3n o referencia "),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(2),e.R50("ngModel",t.query),e.Y8G("suggestions",t.predictions)("forceSelection",!0)("inputStyle",e.eq3(4,xe,t.isMobil()?t.responsiveimage():"400px"))}}function Lt(n,r){if(1&n&&e.nrm(0,"app-index-ficha-sectorial",27),2&n){const t=e.XpG();e.Y8G("filtro","direccion_geo")("valor",t.opcionb.properties.nombre)("modal",!0)}}function Ot(n,r){if(1&n&&e.nrm(0,"app-index-incidentes-denuncia",28),2&n){const t=e.XpG();e.Y8G("categoria",t.categoria)("subcategoria",t.subcategoria)("modal",!0)}}function $t(n,r){if(1&n&&e.nrm(0,"img",32),2&n){const t=e.XpG(2);e.Y8G("src",t.url_imag,e.B4B)}}function Vt(n,r){if(1&n&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.R7$(),e.SpI(" Parroquia: ",t.features[t.id_feature].properties.parr," ")}}function Yt(n,r){if(1&n&&(e.qex(0),e.DNE(1,Vt,2,1,"div",3),e.bVm()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.features[t.id_feature].properties.parr)}}function Ht(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"p-button",33),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.fichaTecnica())}),e.k0s(),e.bVm()}2&n&&(e.R7$(),e.Aen(e.lJ4(2,ke)))}function Jt(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",35),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3);return e.Njj(o.modalcreatedireccion(o.features[o.id_feature]))}),e.k0s()}2&n&&e.Y8G("raised",!0)("outlined",!0)}function Wt(n,r){if(1&n&&e.DNE(0,Jt,1,2,"p-button",34),2&n){const t=e.XpG(2);e.Y8G("ngIf",t.check.CreateDireccionGeoComponent)}}function Zt(n,r){if(1&n&&(e.j41(0,"p-card",29),e.DNE(1,$t,1,1,"ng-template",30)(2,Yt,2,1,"ng-container",3)(3,Ht,2,3,"ng-container",3)(4,Wt,1,1,"ng-template",31),e.k0s()),2&n){const t=e.XpG();e.Y8G("header",t.features[t.id_feature].properties.nombre)("subheader",t.features[t.id_feature].properties.parr||t.features[t.id_feature].properties.obser||t.features[t.id_feature].properties.tipo?"Informaci\xf3n de barrio:":""),e.R7$(2),e.Y8G("ngIf",t.features[t.id_feature].properties),e.R7$(),e.Y8G("ngIf",t.check.IndexFichaSectorialComponent)}}function qt(n,r){if(1&n&&e.nrm(0,"img",32),2&n){const t=e.XpG(2);e.Y8G("src",t.url_imag,e.B4B)}}function Kt(n,r){if(1&n&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2).feature;e.R7$(),e.SpI(" Parroquia: ",t.properties.parr," ")}}function Qt(n,r){if(1&n&&(e.qex(0),e.DNE(1,Kt,2,1,"div",3),e.bVm()),2&n){const t=e.XpG().feature;e.R7$(),e.Y8G("ngIf",t.properties.parr)}}function ei(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"p-button",37),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.fichaTecnica())}),e.k0s(),e.bVm()}2&n&&(e.R7$(),e.Aen(e.lJ4(2,ke)))}function ti(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",39),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2).feature,a=e.XpG();return e.Njj(a.modalcreatedireccion(o))}),e.k0s()}2&n&&e.Y8G("raised",!0)("outlined",!0)}function ii(n,r){if(1&n&&e.DNE(0,ti,1,2,"p-button",38),2&n){const t=e.XpG(2);e.Y8G("ngIf",t.check.CreateDireccionGeoComponent)}}function ni(n,r){if(1&n&&(e.j41(0,"p-card",36),e.DNE(1,qt,1,1,"ng-template",30)(2,Qt,2,1,"ng-container",3)(3,ei,2,3,"ng-container",3)(4,ii,1,1,"ng-template",31),e.k0s()),2&n){const t=r.feature,i=e.XpG();e.Y8G("header",t.properties.nombre)("subheader",t.properties.parr||t.properties.obser||t.properties.tipo?"Informaci\xf3n de barrio:":""),e.R7$(2),e.Y8G("ngIf",t.properties),e.R7$(),e.Y8G("ngIf",i.check.IndexFichaSectorialComponent)}}function oi(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div")(2,"p-button",40),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.pathpush(o))}),e.nrm(3,"img",41),e.EFF(4),e.k0s()(),e.bVm()}if(2&n){const t=r.$implicit,i=e.XpG();e.R7$(2),e.Y8G("raised",!0)("text",!0),e.R7$(),e.Y8G("src",i.pathselect.includes(t)?"assets/icon/eye-slashOFF.svg":"assets/icon/eye-slash.svg",e.B4B),e.R7$(),e.SpI(" ",t.properties.nombre," ")}}const{Geolocation:Fe}=ye.ry;let Ee=(()=>{class n{constructor(t,i,o,a,s,l,p,m,_,h,y,G){var D=this;this.modalService=t,this.elementRef=i,this.helperService=o,this.router=a,this.layoutService=s,this.messageService=l,this.dialogService=p,this.ref=m,this.admin=_,this.list=h,this.appRef=y,this.auth=G,this.loader=new tt.aH({apiKey:"AIzaSyAnO4FEgIlMcRRB0NY5bn_h_EQzdyNUoPo",version:"weekly",libraries:["places"]}),this.mapOptions={center:{lat:0,lng:0},zoom:4},this.markers=[],this.showCrosshair=!1,this.url=V.M.url,this.myControl=new c.MJ,this.filter=[],this.showOptions=!1,this.capasInteractivas=[],this.editing=!1,this.lista_feature=[]=[],this.color="red",this.iconUrl=`data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" fill="${this.color}" width="14" height="14">\n  <path d="M0 0h24v24H0z" fill="none"/>\n  <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10m0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6"/>\n  </svg>`,this.redIcon=Ke.icon({iconUrl:this.iconUrl,shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),this.isLongPress=!1,this.mostrarCreateDireccion=!1,this.mostrarficha=!1,this.mostrarincidente=!1,this.capaActiva=!1,this.capaActivaWIFI=!0,this.urlgeoserwifi="https://geoapi.esmeraldas.gob.ec/geoserver/catastro/wms?service=WFS&version=1.1.0&request=GetFeature&srsname=EPSG%3A4326&typeName=catastro%3Apuntos-wifi&outputFormat=application%2Fjson",this.urlgeoserruta="https://geoapi.esmeraldas.gob.ec/geoserver/catastro/wms?service=WFS&version=1.1.0&request=GetFeature&srsname=EPSG%3A4326&typeName=catastro%3ARUTA2-CARRO2&outputFormat=application%2Fjson",this.urlgeoserruta2="https://geoapi.esmeraldas.gob.ec/geoserver/catastro/wms?service=WFS&version=1.1.0&request=GetFeature&srsname=EPSG%3A4326&typeName=catastro%3ACAPAS-RUTAS&outputFormat=application%2Fjson",this.urlgeoser="https://geoapi.esmeraldas.gob.ec/geoserver/catastro/wms?service=WFS&version=1.1.0&request=GetFeature&srsname=EPSG%3A4326&typeName=catastro%3Ageo_barrios&outputFormat=application%2Fjson",this.urlgeolocal="http://192.168.120.35/geoserver/catastro/wms?service=WFS&version=1.1.0&request=GetFeature&srsname=EPSG%3A4326&typeName=catastro%3Ageo_barrios&outputFormat=application%2Fjson",this.token=this.auth.token()||void 0,this.check={},this.sidebarVisible=!1,this.openInfoWindow=null,this.arr_polygon=[],this.canpopup=!1,this.load_fullscreen=!1,this.items=[],this.visible=!1,this.fillColor=getComputedStyle(document.documentElement).getPropertyValue("--primary-color"),this.strokeColor=getComputedStyle(document.documentElement).getPropertyValue("--gray-900"),this.fillColor2=getComputedStyle(document.documentElement).getPropertyValue("--blue-500"),this.strokeColor2=getComputedStyle(document.documentElement).getPropertyValue("--blue-900"),this.backgroundColor=getComputedStyle(document.documentElement).getPropertyValue("--surface-0"),this.categorias=[],this.mostrarfiltro=!0,this.load_truck=!0,this.pushmenu=!1,this.inforecolector=[],this.markersrecolectores=new Map,this.onClickHandlerMap=function(){var $=(0,g.A)(function*(A){D.mapCustom&&(D.opcionb=!1,D.latitud=A.latLng.lat(),D.longitud=A.latLng.lng(),D.myControl.setValue((D.latitud+";"+D.longitud).toString()),D.poligonoposition())});return function(A){return $.apply(this,arguments)}}(),this.popupStates=[],this.url_imag="",this.features={},this.arr_wifi=[],this.modaldireccion=!1,this.visiblepath=!1,this.rutas=[],this.pathselect=[],this.pathson=[],this.subscription=this.layoutService.configUpdate$.pipe((0,et.B)(25)).subscribe($=>{const A=getComputedStyle(document.documentElement);this.fillColor=A.getPropertyValue("--primary-color"),this.strokeColor=A.getPropertyValue("--gray-900"),this.backgroundColor=A.getPropertyValue("--surface-0"),this.actualizarpoligono()})}search(t){this.helperService.searchStreets(t.query).then(i=>{this.predictions=i}).catch(i=>{console.error("Error searching streets:",i),this.messageService.add({severity:"error",summary:"404",detail:"Sin conincidencias"})})}imprimir(t){this.helperService.getLatLngFromAddress(t.description).then(i=>{this.latitud=i.lat(),this.longitud=i.lng(),this.poligonoposition(!1)}).catch(i=>{console.error("Error getting location:",i)})}ngOnDestroy(){this.ref&&this.ref.close()}ngOnInit(){var t=this;return(0,g.A)(function*(){t.helperService.llamarspinner("init index layer");const i={IndexFichaSectorialComponent:yield t.auth.hasPermissionComponent("/ficha_sectorial","get"),IndexIncidentesDenunciaComponent:yield t.auth.hasPermissionComponent("/incidentes_denuncia","get"),CreateIncidentesDenunciaComponent:yield t.auth.hasPermissionComponent("/incidentes_denuncia","post"),CreateFichaSectorialComponent:yield t.auth.hasPermissionComponent("/ficha_sectorial","post"),CreateDireccionGeoComponent:yield t.auth.hasPermissionComponent("/direccion_geo","post"),DashboardComponent:yield t.auth.hasPermissionComponent("dashboard","get")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a;try{T.q.addListener("backButton",s=>{t.sidebarVisible&&(t.sidebarVisible=!1),t.mostrarficha&&(t.mostrarficha=!1),t.mostrarincidente&&(t.mostrarincidente=!1)}),t.updateItem(),t.helperService.setMapComponent(t),t.initmap(),yield t.getWFSgeojson(t.urlgeoser),t.getLocation()}catch(s){console.error("Error en ngOnInit:",s),t.router.navigate(["/notfound"])}finally{t.helperService.cerrarspinner("init index layer")}});return function(a){return o.apply(this,arguments)}}())})()}listCategoria(){this.list.listarCategorias(this.token).subscribe(t=>{t.data&&(this.categorias=t.data)})}Listitems(t,i,o,a){const s=this.items.findIndex(l=>l.label===t);-1!==s&&(this.items[s].icon=i?o:a)}updateItem(){var i,t=this;this.items=[{label:"Menu Principal",styleClass:"itemcustom",expanded:!0,items:[{icon:"pi bi-bankcustom",label:"Alcald\xeda Ciudadana",styleClass:"itemcustom",expanded:!0,items:[{icon:"pi bi-estadistica",label:"Estad\xedstica",styleClass:"itemcustom",visible:!1,command:()=>{this.check.DashboardComponent?(this.controlFullScreem(),this.sidebarVisible=!0):this.messageService.add({severity:"error",summary:"ERROR",detail:"No tienes permiso para esto"})}},{icon:"pi bi-ticcioce",label:"TIC-CIOCE",styleClass:"itemcustom",visible:!1,command:()=>{this.opcionb&&this.check.CreateIncidentesDenunciaComponent&&this.latitud&&this.longitud?this.nuevoIncidente("CIOCE"):this.opcionb&&this.check.IndexIncidentesDenunciaComponent&&this.check.DashboardComponent?(this.mostrarincidente=!1,setTimeout(()=>{this.mostrarfiltro=!1,this.categoria="CIOCE",this.subcategoria=void 0,this.incidente()},500)):this.messageService.add({severity:"error",summary:"ERROR",detail:"Primero selecciona un punto"})}},{icon:this.capaActiva?"pi bi-barrio-on-custom":"bi bi-barrio-off-custom",label:"Barrios",styleClass:"itemcustom",command:()=>{0==this.arr_polygon.length?this.reloadmap():this.mostrarpoligono()}},{icon:this.capaActivaWIFI?"bi bi-wifi-off":"bi bi-wifi-on",label:"Puntos Wifi",styleClass:"itemcustom",command:()=>{this.reloadWifi()}},{separator:!0},{icon:"pi bi-ficha_sectorial",label:"Fichas Sectorials",styleClass:"itemcustom",expanded:!0,items:[{icon:"pi bi-ver-ficha_sectorial",label:"Ver Fichas Sectoriales",styleClass:"itemcustom",command:()=>{this.opcionb&&this.check.IndexFichaSectorialComponent?this.fichaTecnica():this.messageService.add({severity:"error",summary:"ERROR",detail:"Primero selecciona un lugar"})}},{icon:"pi bi-new-ficha_sectorial",label:"Nueva Ficha Sectorial",styleClass:"itemcustom",visible:!1,command:()=>{this.opcionb&&this.check.CreateFichaSectorialComponent?this.nuevoFicha():this.messageService.add({severity:"error",summary:"ERROR",detail:"Primero selecciona un lugar"})}}]},{separator:!0},{icon:"pi bi-incidentes",label:"Incidentes",styleClass:"itemcustom",expanded:!0,visible:this.check.CreateIncidentesDenunciaComponent,items:[{icon:"pi bi-ver-incidentes",label:"Ver Incidentes",styleClass:"itemcustom",command:()=>{this.check.IndexIncidentesDenunciaComponent?(this.mostrarincidente=!1,setTimeout(()=>{this.mostrarfiltro=!0,this.categoria=void 0,this.subcategoria=void 0,this.incidente()},500)):this.messageService.add({severity:"error",summary:"ERROR",detail:"Primero selecciona un lugar"})}},{icon:"pi bi-new-incidentes",label:"Nuevo Incidente",styleClass:"itemcustom",command:()=>{this.opcionb&&this.check.CreateIncidentesDenunciaComponent&&this.latitud&&this.longitud?this.nuevoIncidente():this.messageService.add({severity:"error",summary:"ERROR",detail:"Primero selecciona un punto"})}}]}]},{icon:"pi bi-ticcioce",label:"TIC-CIOCE",styleClass:"itemcustom",visible:this.check.DashboardComponent,command:()=>{this.opcionb&&this.check.CreateIncidentesDenunciaComponent&&this.latitud&&this.longitud?this.nuevoIncidente("CIOCE"):this.opcionb&&this.check.IndexIncidentesDenunciaComponent&&this.check.DashboardComponent?(this.mostrarincidente=!1,setTimeout(()=>{this.mostrarfiltro=!1,this.categoria="CIOCE",this.subcategoria=void 0,this.incidente()},500)):this.messageService.add({severity:"error",summary:"ERROR",detail:"Primero selecciona un punto"})}},{icon:"pi pi-directionscustom",label:"ESVIAL",styleClass:"itemcustom",visible:!1,command:()=>{this.opcionb&&this.check.CreateIncidentesDenunciaComponent&&this.latitud&&this.longitud?this.nuevoIncidente("ESVIAL","Transporte terrestre y seguridad vial"):this.opcionb&&this.check.IndexIncidentesDenunciaComponent&&this.check.DashboardComponent?(this.mostrarincidente=!1,setTimeout(()=>{this.mostrarfiltro=!1,this.categoria="ESVIAL",this.subcategoria="Transporte terrestre y seguridad vial",this.incidente()},500)):this.messageService.add({severity:"error",summary:"ERROR",detail:"Primero selecciona un punto"})}},{icon:"pi bi-dropletcustom",label:"EPMAPSE",styleClass:"itemcustom",visible:!1,command:()=>{this.opcionb&&this.check.CreateIncidentesDenunciaComponent&&this.latitud&&this.longitud?this.nuevoIncidente("Agua Potable y Alcantarillado"):this.opcionb&&this.check.IndexIncidentesDenunciaComponent&&this.check.DashboardComponent?(this.mostrarincidente=!1,setTimeout(()=>{this.mostrarfiltro=!1,this.categoria="Agua Potable y Alcantarillado",this.subcategoria=void 0,this.incidente()},500)):this.messageService.add({severity:"error",summary:"ERROR",detail:"Primero selecciona un punto"})}},{icon:"pi bi-bomberos",label:"BOMBEROS",styleClass:"itemcustom",visible:!1,command:()=>{this.opcionb&&this.check.CreateIncidentesDenunciaComponent&&this.latitud&&this.longitud?this.nuevoIncidente("Cuerpo de Bomberos","Incendios / Desastres varios"):this.opcionb&&this.check.IndexIncidentesDenunciaComponent&&this.check.DashboardComponent?(this.mostrarincidente=!1,setTimeout(()=>{this.mostrarfiltro=!1,this.categoria="Cuerpo de Bomberos",this.subcategoria="Incendios / Desastres varios",this.incidente()},500)):this.messageService.add({severity:"error",summary:"ERROR",detail:"Primero selecciona un punto"})}},{icon:"pi bi-camionprimne",label:"Recolector",styleClass:"itemcustom",items:[{icon:this.load_truck?"pi bi-camionoff":"pi bi-camionon",label:"Ver Recolectores",styleClass:"itemcustom",command:()=>{this.load_truck?(this.load_truck=!1,this.cargarRecolectores(),this.intervalId=setInterval(()=>{this.cargarRecolectores()},1e3)):(clearInterval(this.intervalId),this.load_truck=!0,this.clearMarkers()),setTimeout(()=>{this.updateItem()},200)}},{icon:"pi bi-path",label:"Ver Rutas",styleClass:"itemcustom",command:(i=(0,g.A)(function*(){if(0==t.rutas.length){const o=yield t.getWFSgeojson(t.urlgeoserruta2);o&&o.features?(t.rutas=o.features,t.visiblepath=!0):t.messageService.add({severity:"error",summary:"Ocurrio Algo",detail:"Sin conexi\xf3n"})}else t.visiblepath=!0}),function(){return i.apply(this,arguments)})},{icon:"pi bi-trashcustom",label:"Denuncia/Incidente",styleClass:"itemcustom",visible:!1,command:()=>{this.opcionb&&this.check.CreateIncidentesDenunciaComponent&&this.latitud&&this.longitud?this.nuevoIncidente("Higiene"," Servicio de recolecci\xf3n de desechos"):this.opcionb&&this.check.IndexIncidentesDenunciaComponent&&this.check.DashboardComponent?(this.mostrarincidente=!1,setTimeout(()=>{this.mostrarfiltro=!1,this.categoria="Higiene",this.subcategoria=" Servicio de recolecci\xf3n de desechos",this.incidente()},500)):this.messageService.add({severity:"error",summary:"ERROR",detail:"Primero selecciona un punto"})}}]}]}],this.addtemplateMn(),this.addtemplateFR(),this.addtemplateBG()}addtemplateMn(){setTimeout(()=>{const t=document.getElementById("panelmenu");if(!this.pushmenu&&this.mapCustom.controls&&t){this.pushmenu=!0;const i=document.createElement("div");i.appendChild(t),this.mapCustom.controls[google.maps.ControlPosition.LEFT_TOP].push(i)}},200)}isMenuAdded(){const i=document.getElementById("speedDial").parentElement;return i&&"DIV"===i.tagName&&i.parentNode===this.mapCustom.getDiv()}addtemplateSP(){setTimeout(()=>{const t=document.getElementsByTagName("p-speedDial")[0];if(!this.isSpeedDialAdded()){const i=document.createElement("div");i.appendChild(t),this.mapCustom.controls[google.maps.ControlPosition.LEFT_TOP].push(i)}this.speedDials&&this.speedDials.forEach((i,o)=>{i.show()})},1e3)}isSpeedDialAdded(){const i=document.getElementsByTagName("p-speedDial")[0].parentElement;return i&&"DIV"===i.tagName&&i.parentNode===this.mapCustom.getDiv()}addtemplateBG(){setTimeout(()=>{const t=document.createElement("button");t.className="p-button p-button-icon-only",t.innerHTML='<span class="bi bi-crosshair" style="font-size: 24px;"></span>',t.title="Ubicaci\xf3n",t.style.position="absolute",t.style.bottom="10px",t.style.right="10px",t.style.width="3rem",t.style.height="3rem",t.style["border-radius"]="50%",t.style.color="#f90017",t.style.background="var(--surface-0)",t.addEventListener("click",()=>{this.getLocation()});const i=document.createElement("div");i.appendChild(t),this.isFormularioBG()||this.mapCustom.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(i)},1e3)}isFormularioBG(){const t=this.mapCustom.controls[google.maps.ControlPosition.RIGHT_BOTTOM].getArray();for(let i=0;i<t.length;i++)if(t[i].contains(this.formularioMapRef.nativeElement))return!0;return!1}addtemplateFR(){setTimeout(()=>{const t=this.formularioMapRef.nativeElement;if(this.load_fullscreen){if(!this.isFormularioMapAdded()){const i=document.createElement("div");i.appendChild(t),this.mapCustom.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(i)}}else this.isFormularioMapAdded()&&t.parentElement.removeChild(t)},1e3)}isFormularioMapAdded(){const t=this.mapCustom.controls[google.maps.ControlPosition.BOTTOM_CENTER].getArray();for(let i=0;i<t.length;i++)if(t[i].contains(this.formularioMapRef.nativeElement))return!0;return!1}getWFSgeojson(t){var i=this;return(0,g.A)(function*(){try{const a=yield(yield fetch(t)).json();return i.guardarfeature(a),a}catch(o){return console.error("error:",o),null}})()}guardarfeature(t){if(t.features){var i=[];i.push(t.features),this.lista_feature.push(...i[0]),this.filter=this.lista_feature}}initmap(){this.loader.load().then(()=>{this.helperService.autocompleteService=new google.maps.places.AutocompleteService,this.helperService.geocoderService=new google.maps.Geocoder,this.mapCustom=new google.maps.Map(document.getElementById("map"),{zoom:15,center:{lat:.977035,lng:-79.655415},mapTypeId:"terrain",fullscreenControl:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_BOTTOM}}),this.initFullscreenControl(),this.mapCustom.addListener("click",i=>{this.onClickHandlerMap(i)})})}cargarRecolectores(){var t=this;return(0,g.A)(function*(){try{const i=yield t.admin.obtenerGPS().toPromise();if(i){const o=i.map(function(){var a=(0,g.A)(function*(s){let l=t.inforecolector.find(m=>m.deviceId==s.deviceId);if(!l){const m=yield t.admin.obtenerNameGPS(s.deviceId).toPromise();l={deviceId:s.deviceId,...m[0]},t.inforecolector.push(l)}const p=new google.maps.LatLng(s.latitude,s.longitude);if(t.markersrecolectores.has(s.deviceId)){const m=t.markersrecolectores.get(s.deviceId);m.setPosition(p),m.setIcon({url:s.attributes.motion?"./assets/menu/camionON.png":"./assets/menu/camionOFF.png",scaledSize:new google.maps.Size(40,40),anchor:new google.maps.Point(13,41)})}else{const m=new google.maps.Marker({position:p,map:t.mapCustom,icon:{url:s.attributes.motion?"./assets/menu/camionON.png":"./assets/menu/camionOFF.png",scaledSize:new google.maps.Size(40,40),anchor:new google.maps.Point(13,41)}}),_=new google.maps.InfoWindow({content:`<div style="font-family: Arial, sans-serif; font-size: 14px; width:200px">\n                                        <b style="text-align: center">${l.name}</b>\n                                      </div>`});m.addListener("click",()=>{t.mapCustom.setCenter(p),_.open(t.mapCustom,m)}),t.markersrecolectores.set(s.deviceId,m)}});return function(s){return a.apply(this,arguments)}}());yield Promise.all(o)}}catch(i){console.error(i)}})()}clearMarkers(){this.markersrecolectores.forEach(t=>{t.setMap(null)})}initFullscreenControl(){const t=this.mapCustom.getDiv().firstChild,i=document.querySelector(".fullscreen-control");this.mapCustom.controls[google.maps.ControlPosition.RIGHT_TOP].push(i),i.onclick=()=>{this.isFullscreen(t)?(this.mapCustom.setOptions({mapTypeControl:!0}),this.load_fullscreen=!1,this.addtemplateMn(),this.addtemplateFR(),this.exitFullscreen()):(this.load_fullscreen=!0,this.mapCustom.setOptions({mapTypeControl:!1}),this.addtemplateMn(),this.addtemplateFR(),this.requestFullscreen(t))},document.onfullscreenchange=()=>{this.isFullscreen(t)?i.classList.add("is-fullscreen"):i.classList.remove("is-fullscreen")}}isFullscreen(t){return(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)==t}requestFullscreen(t){t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullScreen&&t.msRequestFullScreen()}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}addMarker(t,i,o,a){a&&(this.opcionb=a),this.updateItem(),this.deleteMarkers("");const l=new google.maps.Marker({position:t,map:this.mapCustom,title:i});this.openInfoWindow&&this.openInfoWindow.close();const p=new google.maps.InfoWindow({ariaLabel:i,content:o||"Marcador"});p.setPosition(t),p.open(this.mapCustom),this.openInfoWindow=p,this.markers.push(l),this.popupStates.push(!1),l.addListener("click",()=>{p.open(this.mapCustom,l)})}setMapOnAll(t){for(let i=0;i<this.markers.length;i++)this.markers[i].setMap(t)}hideMarkers(){this.setMapOnAll(null)}showMarkers(){this.setMapOnAll(this.mapCustom)}deleteMarkers(t){this.hideMarkers(),this.markers=this.markers.filter(i=>i.getTitle()!==t)}actualizarpoligono(){this.arr_polygon.forEach(t=>{t.setOptions({fillColor:this.fillColor,strokeColor:this.strokeColor}),t.setMap(null),t.setMap(this.mapCustom)})}mostrarpoligono(){this.capaActiva?(this.arr_polygon.forEach(t=>{t.setMap(null)}),this.capaActiva=!1):(this.arr_polygon.forEach(t=>{t.setMap(this.mapCustom)}),this.capaActiva=!0,this.centrarMap()),this.updateItem()}centrarMap(){if(this.mapCustom){const t=new google.maps.LatLngBounds;this.arr_polygon.forEach(a=>{a.getPath().getArray().forEach(s=>{t.extend(s)})}),this.mapCustom.fitBounds(t),t.getCenter();const o=this.calculateZoomLevel(t);this.mapCustom.setCenter({lat:.935233,lng:-79.681929}),this.mapCustom.setZoom(o)}}calculateZoomLevel(t){const o=t.toSpan().lng(),s=this.mapCustom.getDiv().offsetWidth;return Math.floor(Math.log(360*s/o/256)/Math.LN2)}borrarpoligonos(){this.arr_polygon.forEach(t=>{t.setMap(null)}),this.arr_polygon=[]}reloadmap(){this.capaActiva=!0,this.arr_polygon=[],this.lista_feature.forEach(t=>{this.poligonoview(!1,t)}),this.centrarMap(),this.updateItem()}poligonoview(t,i,o){if(o&&(this.latitud=void 0,this.longitud=void 0,this.deleteMarkers("")),"string"!=typeof i){const a=i;t&&(this.capaActiva&&(this.arr_polygon.forEach(p=>{p.setMap(null)}),this.capaActiva=!1),this.opcionb=a,this.updateItem());const s=a.geometry;if(s&&a.properties){const p=s.coordinates;if(p){let m=[];p.forEach(y=>{let G=[];y.forEach(D=>{D.forEach($=>{G.push(new google.maps.LatLng($[1],$[0]))})}),m.push(G)});const _=a.id,h=new google.maps.Polygon({paths:m,strokeColor:t?this.strokeColor2:this.strokeColor,strokeOpacity:.8,strokeWeight:2,fillColor:t?this.fillColor2:this.fillColor,fillOpacity:.35,map:this.mapCustom,id:_});if(t?(this.temp_poligon&&this.temp_poligon.setMap(null),this.temp_poligon=h,this.temp_poligon.setMap(this.mapCustom)):this.arr_polygon.some(y=>y.id==_)||this.arr_polygon.push(h),this.levantarpopup(h,a),t){const y=new google.maps.LatLngBounds;m.forEach(G=>{G.forEach(D=>{y.extend(D)})}),this.mapCustom.fitBounds(y)}}}}}poligonoposition(t){let i=!1;const o=Ie.zx([this.longitud,this.latitud]);for(const a of this.lista_feature)if(a.geometry&&a.geometry.coordinates&&a.geometry.coordinates[0]&&a.geometry.coordinates[0][0].length>4){const s=Ie.n1(a.geometry.coordinates[0]);if(Qe.yx(s,o)){this.opcionb=a,this.poligonoview(!0,a),i=!0,this.updateItem();break}}i||this.messageService.add({severity:"info",summary:"Info",detail:"Tu ubicaci\xf3n no se encuentra dentro de uno de los barrios"}),t||(!this.mostrarficha&&this.check.CreateIncidentesDenunciaComponent||!this.token)&&this.addMarker({lat:this.latitud,lng:this.longitud},i?"Poligono":"Ubicaci\xf3n",i?this.opcionb.properties.nombre:void 0)}levantarpopup(t,i){this.infoWindowActual&&!this.capaActiva&&(this.infoWindowActual.close(),this.infoWindowActual=null,this.url_imag=null),this.features[t.id]=null,t.addListener("click",o=>{if(this.features[t.id]!=i||this.capaActiva)if(this.openInfoWindow.open(null),this.infoWindowActual&&(this.infoWindowActual.close(),this.features[t.id]=null,this.infoWindowActual=null),this.infoWindowActual)this.infoWindowActual.setPosition(o.latLng),this.infoWindowActual.open(this.mapCustom);else{this.features[t.id]=i,this.id_feature=t.id,this.url_imag=`${this.url}obtener_imagen/direccion_geo/${this.features[this.id_feature].id}`;const a=this.createInfoWindowContent(i);this.infoWindowActual=new google.maps.InfoWindow({content:a,ariaLabel:"info"}),google.maps.event.addListener(this.infoWindowActual,"closeclick",()=>{this.infoWindowActual=null}),this.infoWindowActual.setPosition(o.latLng),this.infoWindowActual.open(this.mapCustom)}else this.latitud=o.latLng.lat(),this.longitud=o.latLng.lng(),this.addMarker({lat:this.latitud,lng:this.longitud},"Poligono",i.properties.nombre,i)})}createInfoWindowContent(t){const i=this.infoWindowTemplate.createEmbeddedView({feature:t}),o=document.createElement("div");return o.appendChild(i.rootNodes[0]),this.appRef.attachView(i),o}responsiveimage(){return(window.innerWidth-120+"px").toString()}isMobil(){return this.helperService.isMobil()}getLocation(){var t=this;return(0,g.A)(function*(){t.isMobil()?"granted"!==(yield Fe.requestPermissions())&&(yield Fe.getCurrentPosition()):t.messageService.add({severity:"info",summary:"Info",detail:"Tu ubicaci\xf3n puede ser no exacta"}),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(){var i=(0,g.A)(function*(o){t.latitud=o.coords.latitude,t.longitud=o.coords.longitude,t.addMarker({lat:t.latitud,lng:t.longitud},"Ubicaci\xf3n","Tu ubicaci\xf3n Actual"),t.updateItem(),t.poligonoposition()});return function(o){return i.apply(this,arguments)}}(),i=>{console.error("Error getting location: "+i.message),t.messageService.add({severity:"error",summary:"404",detail:i.message||"Sin conexi\xf3n"})}):(console.error("Geolocation is not supported by this browser."),t.messageService.add({severity:"error",summary:"ERROR",detail:"Geolocation is not supported by this browser."}))})()}filterOptions(t){this.filter=this.lista_feature.filter(i=>{if(i.properties.nombre&&i.properties.nombre.toLowerCase().includes(t.query.toLowerCase())||!this.capaActivaWIFI&&i.properties.punto&&i.properties.punto.toLowerCase().includes(t.query.toLowerCase()))return i}),this.showOptions=!0}hideOptions(){setTimeout(()=>{this.showOptions=!1},200)}reloadWifi(){var t=this;return(0,g.A)(function*(){t.capaActivaWIFI?(0!=t.arr_wifi.length||(t.arr_wifi=[],yield t.getWFSgeojson(t.urlgeoserwifi).then(i=>{i.features.forEach(a=>{const s=new google.maps.LatLng(a.geometry.coordinates[1],a.geometry.coordinates[0]),l=new google.maps.Marker({title:a.id,position:s,map:t.mapCustom,icon:{url:"./assets/icon/router-fill.svg",scaledSize:new google.maps.Size(25,41),anchor:new google.maps.Point(13,41)}}),p=new google.maps.InfoWindow({content:`\n                      <div style="font-family: Arial, sans-serif; font-size: 14px; width:200px">\n                          <b style="text-align: center">${a.properties.punto}</b>\n                      </div>`});l.addListener("click",()=>{t.mapCustom.setCenter(s),p.open(t.mapCustom,l)}),t.arr_wifi.push(l)})})),t.arr_wifi.forEach(i=>i.setMap(t.mapCustom)),t.capaActivaWIFI=!1):(t.arr_wifi.forEach(i=>i.setMap(null)),t.capaActivaWIFI=!0),t.updateItem()})()}fichaTecnica(){this.controlFullScreem(),this.mostrarficha=!1,this.mostrarincidente=!1,this.opcionb&&(this.mostrarficha=!0)}incidente(){this.controlFullScreem(),this.mostrarficha=!1,this.mostrarincidente=!1,this.mostrarincidente=!0}nuevoFicha(){this.controlFullScreem();const t=this.opcionb;this.modalService.dismissAll(),this.ref=this.dialogService.open(gt,{header:"",width:this.isMobil()?"100%":"50%",data:{data:t}}),T.q.addListener("backButton",i=>{this.ref.close()})}nuevoIncidente(t,i){this.controlFullScreem();const o=this.opcionb;this.ref=this.dialogService.open(Dt,{header:"",width:this.isMobil()?"100%":"50%",data:{data:o,direccion:{latitud:this.latitud,longitud:this.longitud},tipo:t,subtipo:i}}),T.q.addListener("backButton",a=>{this.ref.destroy()})}controlFullScreem(){const t=this.mapCustom.getDiv().firstChild;this.isFullscreen(t)&&(this.mapCustom.setOptions({mapTypeControl:!0}),this.load_fullscreen=!1,this.addtemplateMn(),this.addtemplateFR(),this.exitFullscreen())}modalcreatedireccion(t){this.sidebarVisible&&(this.sidebarVisible=!1),this.mostrarficha&&(this.mostrarficha=!1),this.mostrarincidente&&(this.mostrarincidente=!1),this.ref=this.dialogService.open(Gt,{header:"Nueva imagen Direcion",width:this.isMobil()?"100%":"50%",data:{feature:t},dismissableMask:!0}),T.q.addListener("backButton",i=>{this.ref.destroy()})}pathpush(t){if(t){if(this.pathselect.includes(t)){const i=this.pathselect.indexOf(t);-1!==i&&this.pathselect.splice(i,1)}else this.pathselect.push(t);this.rutasdialog()}}rutasdialog(){const t=["#2196f3","#f57c00","#3f51b5","#009688","#f57c00","#9c27b0","#ff4032","#4caf50"];this.pathson.length>0&&this.pathson.forEach(i=>{i.setMap(null)}),this.pathson=[],this.pathselect.forEach((i,o)=>{const a=[];i.geometry.coordinates&&i.geometry.coordinates.forEach(l=>{for(const p of l)a.push({lat:p[1],lng:p[0]})});const s=new google.maps.Polyline({path:a,geodesic:!0,strokeColor:t[o%t.length],strokeOpacity:1,strokeWeight:6});s.addListener("click",l=>{const p=new google.maps.InfoWindow({content:i.properties.nombre});p.setPosition(l.latLng),p.open(this.mapCustom)}),s.setMap(this.mapCustom),this.pathson.push(s)})}viewwifi(t){if("string"!=typeof t){const i=this.arr_wifi.find(o=>{if(o.title==t.id)return o});if(i){const o=new google.maps.LatLng(t.geometry.coordinates[1],t.geometry.coordinates[0]);this.latitud=t.geometry.coordinates[1],this.longitud=t.geometry.coordinates[0];const a=new google.maps.InfoWindow({content:`\n                <div style="font-family: Arial, sans-serif; font-size: 14px; width:200px">\n                    <b style="text-align: center">${t.properties.punto}</b>\n                </div>`});this.mapCustom.setCenter(o),a.open(this.mapCustom,i),this.poligonoposition()}}}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(L.Bq),e.rXU(e.aKT),e.rXU(k.w),e.rXU(x.Ix),e.rXU(Pt.Y),e.rXU(u.bg),e.rXU(f.o3),e.rXU(f.Pw),e.rXU(Y.z),e.rXU(S.a),e.rXU(e.o8S),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-layers"]],viewQuery:function(i,o){if(1&i&&(e.GBs(zt,7),e.GBs(Xt,7),e.GBs(pe.g,5)),2&i){let a;e.mGM(a=e.lsd())&&(o.formularioMapRef=a.first),e.mGM(a=e.lsd())&&(o.infoWindowTemplate=a.first),e.mGM(a=e.lsd())&&(o.speedDials=a)}},features:[e.Jv_([u.bg])],decls:28,vars:32,consts:[["formulariomap",""],["infoWindowTemplate",""],["id","sidebar",3,"visibleChange","onHide","visible","position","fullScreen"],[4,"ngIf"],[1,"grid","p-fluid"],[1,"col-12"],[1,"card","flex","justify-content-center"],["appendTo","body","field","description","placeholder","Ingresa una direcci\xf3n o referencia",3,"ngModelChange","completeMethod","onSelect","ngModel","suggestions","forceSelection"],["class","card flex",4,"ngIf"],["id","map",1,"card",2,"min-height","50rem"],[1,"controls","fullscreen-control"],["title","Toggle Fullscreen",1,"fullscreen-button"],["src","data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2018%2018%22%3E%3Cpath%20fill%3D%22%23666%22%20d%3D%22M0%200v6h2V2h4V0H0zm16%200h-4v2h4v4h2V0h-2zm0%2016h-4v2h6v-6h-2v4zM2%2012H0v6h6v-2H2v-4z%22/%3E%3C/svg%3E","alt","",1,"normal-image",2,"height","18px","width","18px"],["src","data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2018%2018%22%3E%3Cpath%20fill%3D%22%23111%22%20d%3D%22M0%200v6h2V2h4V0H0zm16%200h-4v2h4v4h2V0h-2zm0%2016h-4v2h6v-6h-2v4zM2%2012H0v6h6v-2H2v-4z%22/%3E%3C/svg%3E","alt","",1,"hover-image",2,"height","18px","width","18px"],["class","container","id","indexficha","style","z-index: inherit",3,"filtro","valor","modal",4,"ngIf"],["class","container","id","indexficha","style","z-index: inherit",3,"categoria","subcategoria","modal",4,"ngIf"],[2,"display","none"],["id","content",3,"header","subheader",4,"ngIf"],["direction","down","className","fullscreen-button",3,"model","buttonStyle"],["id","panelmenu",3,"model","multiple"],["header","Selecciona una ruta para mostrar",3,"visibleChange","visible","modal"],[1,"card","flex","flex-wrap","gap-3","justify-content-center"],[4,"ngFor","ngForOf"],[1,"card","flex"],[1,"p-float-label"],["appendTo","body","field","description","placeholder","",3,"ngModelChange","completeMethod","onSelect","ngModel","suggestions","forceSelection","inputStyle"],["for","float-label"],["id","indexficha",1,"container",2,"z-index","inherit",3,"filtro","valor","modal"],["id","indexficha",1,"container",2,"z-index","inherit",3,"categoria","subcategoria","modal"],["id","content",3,"header","subheader"],["pTemplate","header"],["pTemplate","footer"],["alt","Descripci\xf3n de la imagen",1,"imagen-popup",2,"width","100%","height","150px","object-fit","cover",3,"src"],["id","fichaButton","label","Actividades",3,"click"],["id","fotoButton","icon","pi bi-camera2-custom","label","A\xf1adir nueva Foto",3,"raised","outlined","click",4,"ngIf"],["id","fotoButton","icon","pi bi-camera2-custom","label","A\xf1adir nueva Foto",3,"click","raised","outlined"],[3,"header","subheader"],["label","Actividades",3,"click"],["icon","pi bi-camera2-custom","label","A\xf1adir nueva Foto",3,"raised","outlined","click",4,"ngIf"],["icon","pi bi-camera2-custom","label","A\xf1adir nueva Foto",3,"click","raised","outlined"],["severity","success",3,"click","raised","text"],[2,"width","18px",3,"src"]],template:function(i,o){if(1&i){const a=e.RV6();e.j41(0,"p-sidebar",2),e.mxI("visibleChange",function(l){return e.eBV(a),e.DH7(o.sidebarVisible,l)||(o.sidebarVisible=l),e.Njj(l)}),e.bIt("onHide",function(){return e.eBV(a),e.Njj(o.sidebarVisible=!1)}),e.DNE(1,Bt,1,0,"app-list-incidentes",3),e.k0s(),e.j41(2,"div",4)(3,"div",5),e.nrm(4,"p-toast"),e.j41(5,"div")(6,"div",6,0)(8,"p-autoComplete",7),e.mxI("ngModelChange",function(l){return e.eBV(a),e.DH7(o.query,l)||(o.query=l),e.Njj(l)}),e.bIt("completeMethod",function(l){return e.eBV(a),e.Njj(o.search(l))})("onSelect",function(){return e.eBV(a),e.Njj(o.imprimir(o.query))}),e.k0s()()(),e.DNE(9,Ut,5,6,"div",8),e.nrm(10,"div",9),e.j41(11,"div")(12,"div",10)(13,"button",11),e.nrm(14,"img",12)(15,"img",13),e.k0s()()()()(),e.DNE(16,Lt,1,3,"app-index-ficha-sectorial",14)(17,Ot,1,3,"app-index-incidentes-denuncia",15),e.j41(18,"div",16),e.DNE(19,Zt,5,4,"p-card",17),e.k0s(),e.DNE(20,ni,5,4,"ng-template",null,1,e.C5r),e.j41(22,"div"),e.nrm(23,"p-speedDial",18)(24,"p-panelMenu",19),e.k0s(),e.j41(25,"p-dialog",20),e.mxI("visibleChange",function(l){return e.eBV(a),e.DH7(o.visiblepath,l)||(o.visiblepath=l),e.Njj(l)}),e.j41(26,"div",21),e.DNE(27,oi,5,4,"ng-container",22),e.k0s()()}2&i&&(e.R50("visible",o.sidebarVisible),e.Y8G("position","center")("fullScreen",!0),e.R7$(),e.Y8G("ngIf",o.check.DashboardComponent),e.R7$(4),e.xc7("display","none"),e.R7$(3),e.R50("ngModel",o.query),e.Y8G("suggestions",o.predictions)("forceSelection",!0),e.R7$(),e.Y8G("ngIf",!o.load_fullscreen),e.R7$(2),e.xc7("display","none"),e.R7$(5),e.Y8G("ngIf",o.mostrarficha),e.R7$(),e.Y8G("ngIf",o.mostrarincidente),e.R7$(2),e.Y8G("ngIf",o.features[o.id_feature]),e.R7$(3),e.xc7("display","none"),e.R7$(),e.Y8G("model",o.items)("buttonStyle",e.lJ4(28,Nt)),e.R7$(),e.Aen(e.lJ4(29,At)),e.Y8G("model",o.items)("multiple",!0),e.R7$(),e.Aen(e.eq3(30,xe,o.isMobil()?"100%":"50vw")),e.R50("visible",o.visiblepath),e.Y8G("modal",!0),e.R7$(2),e.Y8G("ngForOf",o.rutas))},styles:['@charset "UTF-8";.combo-box[_ngcontent-%COMP%]{position:relative}.options-list[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;z-index:1000;background-color:#fff;border:1px solid #ccc;border-top:none;list-style:none;padding:0;margin:0;width:100%}.options-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:5px 10px;cursor:pointer}.options-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}@media (min-width: 992px){.card-body[_ngcontent-%COMP%]   .row-cols-lg-2[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.card-body[_ngcontent-%COMP%]   .row-cols-lg-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 50%;max-width:50%}}@media (max-width: 991.98px){.card-body[_ngcontent-%COMP%]   .row-cols-lg-2[_ngcontent-%COMP%]{display:block}.card-body[_ngcontent-%COMP%]   .row-cols-lg-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}}.inputmap[_ngcontent-%COMP%]{height:50px}@media (max-width: 700px){.inputmap[_ngcontent-%COMP%]{width:calc(100vw - 30px)}}@media (min-width: 700px){.inputmap[_ngcontent-%COMP%]{width:430px}}#lista[_ngcontent-%COMP%]{height:50px}@media (max-width: 700px){#lista[_ngcontent-%COMP%]{width:calc(100vw - 50px)}}@media (min-width: 700px){#lista[_ngcontent-%COMP%]{width:430px}}.formulario-flotante[_ngcontent-%COMP%]{position:absolute;z-index:1000;border-radius:5px}@media (max-width: 700px){.formulario-flotante[_ngcontent-%COMP%]{top:24px;left:auto}}@media (min-width: 700px){.formulario-flotante[_ngcontent-%COMP%]{top:24px;left:55px}}#formulario[_ngcontent-%COMP%]{position:absolute;padding:0;border:0px solid black;z-index:1000}.container[_ngcontent-%COMP%]{height:-webkit-fill-available;z-index:1000}@media (max-width: 767px){#listarficha[_ngcontent-%COMP%]{bottom:0;--bs-gutter-x: 0rem}}@media (min-width: 768px){#listarficha[_ngcontent-%COMP%]{--bs-gutter-x: 1.5rem}}@media (min-width: 1400px){.container[_ngcontent-%COMP%]{max-width:-webkit-fill-availabl!important}}@media (min-width: 1400px){.container[_ngcontent-%COMP%]{max-width:-webkit-fill-available}}.imagen-popup[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;display:block;height:100px;object-fit:cover}.fullscreen-button[_ngcontent-%COMP%]{background:none #fff;border:0px;margin:10px;padding:0;text-transform:none;appearance:none;position:absolute;cursor:pointer;-webkit-user-select:none;user-select:none;border-radius:2px;height:40px;width:40px;box-shadow:#0000004d 0 1px 4px -1px;overflow:hidden;top:0;right:0}.fullscreen-button[_ngcontent-%COMP%]   .hover-image[_ngcontent-%COMP%], .fullscreen-button[_ngcontent-%COMP%]:hover   .normal-image[_ngcontent-%COMP%]{display:none}.fullscreen-button[_ngcontent-%COMP%]:hover   .hover-image[_ngcontent-%COMP%]{display:inline-block}.p-inputtext[_ngcontent-%COMP%]{width:400px}.p-fluid[_ngcontent-%COMP%]   .p-button-icon-only[_ngcontent-%COMP%]{width:3rem!important}']})}return n})();var K=d(260),Se=d(3346),C=d(259),ai=d(2658);let P=(()=>{class n{constructor(t){this.http=t,this.url=V.M.url}actualizarUsuario(t,i,o,a){const s=new C.Lr({Authorization:t}),l=new FormData;for(const m in o)if(o.hasOwnProperty(m)){const _=o[m];"role"===m&&"object"==typeof _&&_._id?l.append("role",_._id):l.append(m,_)}a&&l.append("photo",a);const p=(new C.Nl).set("id",i);return this.http.put(this.url+"actualizaruser",o,{headers:s,params:p})}actualizarActividadProyecto(t,i,o){const a=new C.Lr({Authorization:t});return this.http.put(this.url+"ficha_sectorial/"+i,o,{headers:a})}actualizarIncidenteDenuncia(t,i,o){const a=new C.Lr({Authorization:t});return new Se.c(s=>{const l=new FormData;if(o.categoria&&l.append("categoria",o.categoria._id),o.subcategoria&&l.append("subcategoria",o.subcategoria._id),o.ciudadano&&l.append("ciudadano",o.ciudadano._id?o.ciudadano._id:o.ciudadano),o.descripcion&&l.append("descripcion",o.descripcion),o.estado&&l.append("estado",o.estado._id),o.respuesta&&l.append("respuesta",o.respuesta),o.encargado&&l.append("encargado",o.encargado),o.direccion_geo&&l.append("direccion_geo",JSON.stringify(o.direccion_geo)),l.append("view",o.view),o.view_id&&l.append("view_id",o.view_id),o.view_date&&l.append("view_date",o.view_date),Array.isArray(o.evidencia)&&o.evidencia.every(p=>p instanceof File||p instanceof Blob)){const p=o.evidencia.map(m=>this.compressor(m));Promise.all(p).then(m=>{m.forEach((_,h)=>{l.append(`evidencia${h}`,_)}),console.log("Con imagenes"),l.forEach((_,h)=>{console.log(`${h}: ${_}`)}),this.http.put(this.url+"incidentes_denuncia/"+i,l,{headers:a}).subscribe(_=>{s.next(_),s.complete()},_=>s.error(_))}).catch(m=>s.error(m))}else console.log("Sin imagenes"),l.forEach((p,m)=>{console.log(`${m}: ${p}`)}),this.http.put(this.url+"incidentes_denuncia/"+i,l,{headers:a}).subscribe(p=>{s.next(p),s.complete()},p=>s.error(p))})}actualizarCategoria(t,i,o){const a=new C.Lr({"Content-Type":"application/json",Authorization:t}),s=(new C.Nl).set("id",i);return this.http.put(this.url+"categoria",o,{headers:a,params:s})}actualizarSubcategoria(t,i,o){const a=new C.Lr({"Content-Type":"application/json",Authorization:t}),s=(new C.Nl).set("id",i);return this.http.put(this.url+"subcategoria",o,{headers:a,params:s})}actualizarEncargadoCategoria(t,i,o){const a=new C.Lr({"Content-Type":"application/json",Authorization:t}),s=(new C.Nl).set("id",i);return this.http.put(this.url+"encargado_categoria",o,{headers:a,params:s})}actualizarRolUsuario(t,i,o){const a=new C.Lr({"Content-Type":"application/json",Authorization:t}),s=(new C.Nl).set("id",i);return this.http.put(this.url+"actualizarrole",o,{headers:a,params:s})}actualizarEstadoIncidente(t,i,o){const a=new C.Lr({"Content-Type":"application/json",Authorization:t}),s=(new C.Nl).set("id",i);return this.http.put(this.url+"estado_incidente",o,{headers:a,params:s})}actualizarEstadoActividadProyecto(t,i,o){const a=new C.Lr({"Content-Type":"application/json",Authorization:t}),s=(new C.Nl).set("id",i);return this.http.put(this.url+"estado_actividad_proyecto",o,{headers:a,params:s})}actualizarTipoActividadProyecto(t,i,o){const a=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.put(this.url+"actividad_proyecto/"+i,o,{headers:a})}actualizarDireccionGeo(t,i,o){const a=new C.Lr({"Content-Type":"application/json",Authorization:t}),s=(new C.Nl).set("id",i);return this.http.put(this.url+"direccion_geo",o,{headers:a,params:s})}actualizarPermisos(t,i,o){const a=new C.Lr({"Content-Type":"application/json",Authorization:t}),s=(new C.Nl).set("id",i);return this.http.put(`${this.url}actualizarpermiso`,o,{headers:a,params:s})}compressor(t){return(0,g.A)(function*(){const i={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0};try{return yield(0,ai.A)(t,i)}catch(o){throw o}})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.KVO(C.Qq))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ae=d(4870);function ri(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI(" ",t.categoria.nombre," ")}}function si(n,r){1&n&&(e.qex(0),e.nrm(1,"p-skeleton",8)(2,"p-skeleton",9)(3,"p-skeleton",10)(4,"p-skeleton",11)(5,"p-skeleton",12),e.bVm())}function li(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",13)(2,"label",14),e.EFF(3,"Nombre de Categoria"),e.k0s(),e.j41(4,"input",15),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.categoria.nombre,o)||(a.categoria.nombre=o),e.Njj(o)}),e.k0s()(),e.j41(5,"div",16)(6,"label",14),e.EFF(7,"URL del icono"),e.k0s(),e.j41(8,"input",17),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.categoria.icono,o)||(a.categoria.icono=o),e.Njj(o)}),e.k0s()(),e.j41(9,"div",13)(10,"label",18),e.EFF(11,"Descripci\xf3n"),e.k0s(),e.j41(12,"textarea",19),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.categoria.descripcion,o)||(a.categoria.descripcion=o),e.Njj(o)}),e.k0s()(),e.j41(13,"div",16),e.nrm(14,"img",20),e.k0s(),e.bVm()}if(2&n){const t=e.XpG();e.R7$(4),e.R50("ngModel",t.categoria.nombre),e.R7$(4),e.R50("ngModel",t.categoria.icono),e.R7$(4),e.R50("ngModel",t.categoria.descripcion),e.R7$(2),e.Y8G("src",t.categoria.icono,e.B4B)}}let ci=(()=>{class n{constructor(t,i,o,a,s,l,p){this.obtener=t,this.update=i,this.helper=o,this.modalService=a,this.messageService=s,this.config=l,this.auth=p,this.token=this.auth.token(),this.loadcategoria=!1}ngOnInit(){this.id=this.config.data.id,this.obtenerCategoria()}obtenerCategoria(){this.loadcategoria=!1,this.obtener.obtenerCategoria(this.token,this.id).subscribe(t=>{this.categoria=t.data}),setTimeout(()=>{this.loadcategoria=!0},500)}cerrar(){this.modalService.dismissAll()}updateCate(){this.update.actualizarCategoria(this.token,this.id,this.categoria).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Actualizado",detail:t.data.nombre}),setTimeout(()=>{this.modalService.dismissAll()},1e3))},t=>{this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(K.E),e.rXU(P),e.rXU(k.w),e.rXU(L.Bq),e.rXU(u.bg),e.rXU(f.sb),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-edit-categoria"]],features:[e.Jv_([u.bg])],decls:12,vars:3,consts:[[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],[1,"modal-body"],[1,"p-fluid","p-formgrid","grid"],[1,"d-flex","justify-content-end","mt-3"],["type","button","pButton","","label","Guardar",1,"btn","btn-primary",3,"click"],["styleClass","mb-2","borderRadius","16px"],["width","10rem","styleClass","mb-2","borderRadius","16px"],["width","5rem","styleClass","mb-2","borderRadius","16px"],["height","2rem","styleClass","mb-2","borderRadius","16px"],["width","10rem","height","4rem","borderRadius","16px"],[1,"field","col-12","md:col-6"],["for","nombre",1,"form-label"],["type","text","id","nombre","placeholder","Nombre de Categoria","pInputText","",1,"form-control",3,"ngModelChange","ngModel"],[1,"field","col-12","md:col-6",2,"display","flex","flex-direction","column","align-items","center"],["type","text","id","icono","placeholder","URL del ICONO","pInputText","",1,"form-control",3,"ngModelChange","ngModel"],["for","descripcion",1,"form-label"],["id","descripcion","rows","5","cols","30","pInputTextarea","",1,"form-control",3,"ngModelChange","ngModel"],["alt","",2,"max-width","150px","width","auto",3,"src"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.nrm(1,"p-toast"),e.j41(2,"div",1)(3,"h5",2),e.EFF(4," Editar Categor\xeda: "),e.DNE(5,ri,2,1,"span",3),e.k0s()(),e.j41(6,"div",4),e.DNE(7,si,6,0,"ng-container",3),e.j41(8,"div",5),e.DNE(9,li,15,4,"ng-container",3),e.k0s()(),e.j41(10,"div",6)(11,"button",7),e.bIt("click",function(){return o.updateCate()}),e.k0s()()()),2&i&&(e.R7$(5),e.Y8G("ngIf",o.loadcategoria),e.R7$(2),e.Y8G("ngIf",!o.loadcategoria),e.R7$(2),e.Y8G("ngIf",o.loadcategoria))},dependencies:[b.bT,v._f,E.y8,c.me,c.BC,c.vS,M.S,ae.E,H.Z]})}return n})();function di(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI(" ",t.subcategoria.nombre," ")}}function pi(n,r){1&n&&(e.qex(0),e.nrm(1,"p-skeleton",7)(2,"p-skeleton",8)(3,"p-skeleton",9)(4,"p-skeleton",10)(5,"p-skeleton",11),e.bVm())}function mi(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",12)(2,"div",13)(3,"label",14),e.EFF(4),e.k0s(),e.j41(5,"p-dropdown",15),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.subcategoria.categoria,o)||(a.subcategoria.categoria=o),e.Njj(o)}),e.k0s()(),e.j41(6,"div",13)(7,"label",16),e.EFF(8,"Nombre de Sub Categor\xeda"),e.k0s(),e.j41(9,"input",17),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.subcategoria.nombre,o)||(a.subcategoria.nombre=o),e.Njj(o)}),e.k0s()(),e.j41(10,"div",13)(11,"label",18),e.EFF(12,"Descripci\xf3n"),e.k0s(),e.j41(13,"textarea",19),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.subcategoria.descripcion,o)||(a.subcategoria.descripcion=o),e.Njj(o)}),e.k0s()()(),e.bVm()}if(2&n){const t=e.XpG();e.R7$(4),e.SpI("Categor\xeda: ",t.subcategoria.categoria.nombre,""),e.R7$(),e.Y8G("options",t.arrayCategoria),e.R50("ngModel",t.subcategoria.categoria),e.R7$(4),e.R50("ngModel",t.subcategoria.nombre),e.R7$(4),e.R50("ngModel",t.subcategoria.descripcion)}}let ui=(()=>{class n{constructor(t,i,o,a,s,l,p,m){this.obtener=t,this.update=i,this.helper=o,this.modalService=a,this.listar=s,this.messageService=l,this.config=p,this.auth=m,this.token=this.auth.token(),this.loadcategoria=!1,this.arrayCategoria=[]}ngOnInit(){var t=this;return(0,g.A)(function*(){t.id=t.config.data.id,t.loadcategoria=!1;try{yield t.obtenerCategoria(),yield t.listarcategoria()}catch{t.modalService.dismissAll()}finally{setTimeout(()=>{t.loadcategoria=!0},500)}})()}listarcategoria(){var t=this;return(0,g.A)(function*(){t.listar.listarCategorias(t.token).subscribe(i=>{i.data&&(t.arrayCategoria=i.data)})})()}filterItems(t){let i=[],o=t.query;for(let a=0;a<this.arrayCategoria.length;a++){let s=this.arrayCategoria[a];0==s.nombre.toLowerCase().indexOf(o.toLowerCase())&&i.push(s)}this.filteredItems=i}obtenerCategoria(){var t=this;return(0,g.A)(function*(){t.obtener.obtenerSubcategoria(t.token,t.id).subscribe(i=>{t.subcategoria=i.data})})()}cerrar(){this.modalService.dismissAll()}updateCate(){this.update.actualizarSubcategoria(this.token,this.id,this.subcategoria).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Ingreso",detail:"Bienvenido"}),setTimeout(()=>{this.modalService.dismissAll()},1e3))},t=>{this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(K.E),e.rXU(P),e.rXU(k.w),e.rXU(L.Bq),e.rXU(S.a),e.rXU(u.bg),e.rXU(f.sb),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-edit-subcategoria"]],features:[e.Jv_([u.bg])],decls:11,vars:3,consts:[[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],[1,"modal-body"],[1,"d-flex","justify-content-end","mt-3"],["type","button","pButton","","label","Guardar",1,"btn","btn-primary",3,"click"],["styleClass","mb-2","borderRadius","16px"],["width","10rem","styleClass","mb-2","borderRadius","16px"],["width","5rem","styleClass","mb-2","borderRadius","16px"],["height","2rem","styleClass","mb-2","borderRadius","16px"],["width","10rem","height","4rem","borderRadius","16px"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6","mb-3"],["for","categoria",1,"form-label"],["optionLabel","nombre",3,"ngModelChange","options","ngModel"],["for","nombre",1,"form-label"],["type","text","id","nombre","placeholder","Nombre de Sub Categor\xeda","pInputText","",1,"form-control",3,"ngModelChange","ngModel"],["for","descripcion",1,"form-label"],["id","descripcion","rows","5","cols","30","pInputTextarea","",1,"form-control",3,"ngModelChange","ngModel"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.nrm(1,"p-toast"),e.j41(2,"div",1)(3,"h5",2),e.EFF(4," Editar Categor\xeda: "),e.DNE(5,di,2,1,"span",3),e.k0s()(),e.j41(6,"div",4),e.DNE(7,pi,6,0,"ng-container",3)(8,mi,14,5,"ng-container",3),e.k0s(),e.j41(9,"div",5)(10,"button",6),e.bIt("click",function(){return o.updateCate()}),e.k0s()()()),2&i&&(e.R7$(5),e.Y8G("ngIf",o.loadcategoria),e.R7$(2),e.Y8G("ngIf",!o.loadcategoria),e.R7$(),e.Y8G("ngIf",o.loadcategoria))},dependencies:[b.bT,v._f,E.y8,c.me,c.BC,c.vS,X.ms,M.S,ae.E,H.Z]})}return n})(),ue=(()=>{class n{constructor(t){this.http=t,this.url=V.M.url}eliminarUsuario(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"eliminaruser/"+i,{headers:o})}eliminarfichaSectorial(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"ficha_sectorial/"+i,{headers:o})}eliminarIncidenteDenuncia(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"incidentes_denuncia/"+i,{headers:o})}eliminarEncargadoCategoria(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"encargado_categoria/"+i,{headers:o})}eliminarRolUsuario(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"eliminarrole/"+i,{headers:o})}eliminarEstadoIncidente(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"estado_incidente/"+i,{headers:o})}eliminarEstadoActividadProyecto(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"estado_actividad_proyecto/"+i,{headers:o})}eliminarTipoActividadProyecto(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"actividad_proyecto/"+i,{headers:o})}eliminarDireccionGeo(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"direccion_geo/"+i,{headers:o})}verificarCategoria(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.get(this.url+"subcategoria?categoria="+i,{headers:o})}eliminarCategoria(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"categoria/"+i,{headers:o})}verificarSubCategoria(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.get(this.url+"incidentes_denuncia?subcategoria="+i,{headers:o})}eliminarSubcategoria(t,i){let o=new C.Lr({"Content-Type":"application/json",Authorization:t});return this.http.delete(this.url+"subcategoria/"+i,{headers:o})}static#e=this.\u0275fac=function(i){return new(i||n)(e.KVO(C.Qq))};static#t=this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ie=d(719),ne=d(2017),J=d(2162);const _i=["Confirmar"],gi=()=>({"min-width":"30rem"}),hi=()=>({"margin-left":".5em"}),fi=()=>({width:"50vw"});function bi(n,r){1&n&&(e.j41(0,"p-button",11),e.EFF(1," Nueva Categor\xeda "),e.k0s())}function vi(n,r){1&n&&(e.j41(0,"p-button",12),e.EFF(1," Nueva Sub Categor\xeda "),e.k0s())}function Ci(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",13),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.opcion=!o.opcion)}),e.EFF(1," Opciones "),e.k0s()}}function Ii(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",6)(1,"h2"),e.EFF(2,"Listado de Categor\xedas"),e.k0s()(),e.DNE(3,bi,2,0,"p-button",7)(4,vi,2,0,"p-button",8)(5,Ci,2,0,"p-button",9),e.j41(6,"p-button",10),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.exportToCSV())}),e.k0s()}if(2&n){const t=e.XpG();e.R7$(3),e.Y8G("ngIf",t.check.CreateCategoriaComponent),e.R7$(),e.Y8G("ngIf",t.check.CreateSubcategoriaComponent),e.R7$(),e.Y8G("ngIf",t.check.EditCategoriaComponent||t.check.EditSubcategoriaComponent)}}function yi(n,r){if(1&n&&e.nrm(0,"p-treeTableSortIcon",18),2&n){const t=e.XpG(2).$implicit;e.Y8G("field",t.field)}}function xi(n,r){if(1&n&&(e.j41(0,"th",16),e.EFF(1),e.DNE(2,yi,1,1,"p-treeTableSortIcon",17),e.k0s()),2&n){const t=e.XpG(),i=t.$implicit,o=t.last;e.Y8G("ttSortableColumn",i.field),e.R7$(),e.SpI(" ",i.header," "),e.R7$(),e.Y8G("ngIf",!o)}}function ki(n,r){if(1&n&&(e.qex(0),e.DNE(1,xi,3,3,"th",15),e.bVm()),2&n){const t=r.last,i=e.XpG(2);e.R7$(),e.Y8G("ngIf",!t||i.opcion&&t)}}function Fi(n,r){if(1&n&&(e.j41(0,"tr"),e.DNE(1,ki,2,1,"ng-container",14),e.k0s()),2&n){const t=r.$implicit;e.R7$(),e.Y8G("ngForOf",t)}}function Ei(n,r){if(1&n&&e.nrm(0,"p-treeTableToggler",22),2&n){const t=e.XpG(3).$implicit;e.Y8G("rowNode",t)}}function Si(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"p-button",23),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3).rowData,a=e.XpG();return e.Njj(a.editRow(o._id,o.cat))}),e.k0s(),e.j41(2,"p-button",24),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3).rowData,a=e.XpG();return e.Njj(a.remoRow(o,o.cat))}),e.k0s(),e.bVm()}2&n&&(e.R7$(),e.Y8G("rounded",!0),e.R7$(),e.Aen(e.lJ4(4,hi)),e.Y8G("rounded",!0))}function Mi(n,r){if(1&n&&(e.j41(0,"td"),e.DNE(1,Ei,1,1,"p-treeTableToggler",21),e.EFF(2),e.DNE(3,Si,3,5,"ng-container",20),e.k0s()),2&n){const t=e.XpG(),i=t.$implicit,o=t.index,a=t.last,s=e.XpG().rowData,l=e.XpG();e.R7$(),e.Y8G("ngIf",0===o),e.R7$(),e.SpI(" ",s[i.field]," "),e.R7$(),e.Y8G("ngIf",l.opcion&&a)}}function ji(n,r){if(1&n&&(e.qex(0),e.DNE(1,Mi,4,3,"td",20),e.bVm()),2&n){const t=r.last,i=e.XpG(2);e.R7$(),e.Y8G("ngIf",!t||i.opcion&&t)}}function Ti(n,r){if(1&n&&(e.j41(0,"tr",19),e.DNE(1,ji,2,1,"ng-container",14),e.k0s()),2&n){const i=r.columns;e.Y8G("ttRow",r.$implicit),e.R7$(),e.Y8G("ngForOf",i)}}function wi(n,r){if(1&n&&(e.j41(0,"div",33)(1,"span",34),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI(" Confirmar Eliminaci\xf3n: ",t.iddelete.nombre,"")}}function Ri(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",38)(1,"p-button",39),e.bIt("onClick",function(){e.eBV(t);const o=e.XpG().nextCallback;return e.Njj(o.emit())}),e.k0s()()}}function Di(n,r){if(1&n&&(e.j41(0,"div",35)(1,"div",36)(2,"p"),e.EFF(3),e.k0s()()(),e.DNE(4,Ri,2,0,"div",37)),2&n){const t=e.XpG(2);e.R7$(3),e.SpI(" \xbfEst\xe1s seguro que deseas eliminar esta ",t.catbool?"categor\xeda":"subcategor\xeda","? "),e.R7$(),e.Y8G("ngIf",t.load_btn_delte)}}function Gi(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG(4);e.R7$(),e.SpI(" (",t.responsemodal.cantidadSubcategorias,")")}}function Pi(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",35)(1,"div",36)(2,"p"),e.EFF(3),e.DNE(4,Gi,2,1,"span",20),e.k0s()()(),e.j41(5,"div",41)(6,"p-button",42),e.bIt("onClick",function(){const o=e.eBV(t).prevCallback;return e.Njj(o.emit())}),e.k0s(),e.j41(7,"p-button",39),e.bIt("onClick",function(){const o=e.eBV(t).nextCallback,a=e.XpG(3);return o.emit(),e.Njj(a.load_btn_delte=!!a.responsemodal.cantidadIncidentes)}),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(3),e.SpI(" ",t.responsemodal.cantidadSubcategorias?"Esta categor\xeda contiene subcategor\xedas. Al eliminarla, tambi\xe9n se eliminar\xe1n todas sus subcategor\xedas.":""," "),e.R7$(),e.Y8G("ngIf",t.responsemodal.cantidadSubcategorias)}}function zi(n,r){1&n&&(e.j41(0,"p-stepperPanel",40),e.DNE(1,Pi,8,2,"ng-template",28),e.k0s())}function Xi(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",35)(1,"div",36)(2,"p"),e.EFF(3),e.k0s()()(),e.j41(4,"div",41)(5,"p-button",42),e.bIt("onClick",function(){const o=e.eBV(t).prevCallback;return e.Njj(o.emit())}),e.k0s(),e.j41(6,"p-button",39),e.bIt("onClick",function(){const o=e.eBV(t).nextCallback,a=e.XpG(3);return o.emit(),e.Njj(a.load_btn_delte=!1)}),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(3),e.SpI(" Esto incluir\xe1 la eliminaci\xf3n de (",t.responsemodal.cantidadIncidentes,") Incidentes ")}}function Ni(n,r){1&n&&(e.j41(0,"p-stepperPanel",43),e.DNE(1,Xi,7,1,"ng-template",28),e.k0s())}function Ai(n,r){if(1&n&&(e.j41(0,"div",51)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(5);e.R7$(2),e.JRh(t.respaldo.nombre)}}function Bi(n,r){if(1&n&&e.DNE(0,Ai,3,1,"div",50),2&n){const t=e.XpG(4);e.Y8G("ngIf",t.respaldo)}}function Ui(n,r){if(1&n&&(e.j41(0,"div",51)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.nombre)}}function Li(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",35)(1,"div",36)(2,"div",45)(3,"p"),e.EFF(4),e.k0s()(),e.j41(5,"div",45)(6,"label",46),e.EFF(7),e.k0s(),e.j41(8,"p-dropdown",47),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(3);return e.DH7(a.respaldo,o)||(a.respaldo=o),e.Njj(o)}),e.DNE(9,Bi,1,1,"ng-template",48)(10,Ui,3,1,"ng-template",49),e.k0s()()()(),e.j41(11,"div",41)(12,"p-button",42),e.bIt("onClick",function(){const o=e.eBV(t).prevCallback,a=e.XpG(3);return o.emit(),e.Njj(a.load_btn_delte=!0)}),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(4),e.SpI(" \xbfDeseas asignar a otra ",t.responsemodal.cantidadSubcategorias?"categor\xeda":"subcategor\xeda","? "),e.R7$(3),e.JRh(t.responsemodal.cantidadSubcategorias?"Categor\xeda":"Subcategor\xeda"),e.R7$(),e.Y8G("options",t.responsemodal.cantidadSubcategorias?t.listadocategoria:t.listadosubcategoria),e.R50("ngModel",t.respaldo),e.Y8G("showClear",!0)}}function Oi(n,r){1&n&&(e.j41(0,"p-stepperPanel",44),e.DNE(1,Li,13,5,"ng-template",28),e.k0s())}function $i(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",52),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.visibledelete=!1)}),e.EFF(1," Cancelar "),e.k0s(),e.j41(2,"p-button",53),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return o.eliminarCategoria(),e.Njj(o.visibledelete=!1)}),e.EFF(3," Eliminar "),e.k0s()}if(2&n){const t=e.XpG(2);e.R7$(2),e.Y8G("disabled",t.load_btn_delte)}}function Vi(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-dialog",25),e.mxI("visibleChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.visibledelete,o)||(a.visibledelete=o),e.Njj(o)}),e.DNE(1,wi,3,1,"ng-template",3),e.j41(2,"p-stepper",26)(3,"p-stepperPanel",27),e.DNE(4,Di,5,2,"ng-template",28),e.k0s(),e.DNE(5,zi,2,0,"p-stepperPanel",29)(6,Ni,2,0,"p-stepperPanel",30)(7,Oi,2,0,"p-stepperPanel",31),e.k0s(),e.DNE(8,$i,4,1,"ng-template",32),e.k0s()}if(2&n){const t=e.XpG();e.Aen(e.lJ4(7,fi)),e.R50("visible",t.visibledelete),e.R7$(2),e.Y8G("linear",!0),e.R7$(3),e.Y8G("ngIf",t.responsemodal.cantidadSubcategorias),e.R7$(),e.Y8G("ngIf",t.responsemodal.cantidadIncidentes),e.R7$(),e.Y8G("ngIf",t.responsemodal.cantidadIncidentes||t.responsemodal.cantidadSubcategorias)}}let Yi=(()=>{class n{constructor(t,i,o,a,s,l,p,m,_){this.ref=t,this.listService=i,this.router=o,this.updateservice=a,this.helperservice=s,this.deleteService=l,this.messageService=p,this.dialogService=m,this.auth=_,this.constcategorias=[],this.clonedProducts={},this.token=this.auth.token(),this.check={},this.opcion=!1,this.loading=!1,this.load_btn_delte=!0,this.visibledelete=!1,this.catbool=!1,this.editCategoriaId=null}ngOnInit(){var t=this;return(0,g.A)(function*(){const i={IndexCategoriaComponent:yield t.auth.hasPermissionComponent("/categoria","get"),EditCategoriaComponent:yield t.auth.hasPermissionComponent("/categoria/:id","put"),EditSubcategoriaComponent:yield t.auth.hasPermissionComponent("/subcategoria/:id","put"),CreateCategoriaComponent:yield t.auth.hasPermissionComponent("/categoria","post"),CreateSubcategoriaComponent:yield t.auth.hasPermissionComponent("/subcategoria","post")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a;try{if(!t.check.IndexCategoriaComponent)return console.log("ERROR");yield t.listarCategorias(),t.cols=[{field:"nombre",header:"Nombre"},{field:"descripcion",header:"Descripci\xf3n"},{field:"",header:""}];const s=yield t.listService.listarSubcategorias(t.token).toPromise();s&&s.data&&(t.listadosubcategoria=s.data)}catch(s){console.error("Error en ngOnInit:",s),t.router.navigate(["/notfound"])}finally{t.loading=!0}});return function(a){return o.apply(this,arguments)}}())})()}clear(t){t.clear()}listarCategorias(){var t=this;return(0,g.A)(function*(){t.loading=!0,t.opcion=!1;try{const i=yield t.listService.listarCategorias(t.token).toPromise();if(!i.data)throw new Error("No se pudo obtener la lista de categor\xedas");{t.listadocategoria=i.data;const o=yield Promise.all(t.listadocategoria.map(function(){var a=(0,g.A)(function*(s){const p=(yield t.listService.listarSubcategorias(t.token,{categoria:s._id}).toPromise()).data.map(m=>({data:{nombre:m.nombre,descripcion:m.descripcion,_id:m._id,cat:!1}}));return{data:{nombre:s.nombre,descripcion:s.descripcion,_id:s._id,cat:!0},children:p}});return function(s){return a.apply(this,arguments)}}()));t.categorias=o}}catch{}finally{t.loading=!1}})()}isMobil(){return this.helperservice.isMobil()}editRow(t,i){i?this.check.EditCategoriaComponent?(this.ref=this.dialogService.open(ci,{header:"Editar Categor\xeda",width:this.isMobil()?"100%":"70%",data:{id:t}}),T.q.addListener("backButton",o=>{this.ref.close()})):this.messageService.add({severity:"error",summary:"Lo sentimos",detail:"No tiene permisos para esto"}):this.check.EditCategoriaComponent?(this.ref=this.dialogService.open(ui,{header:"Editar Subcategor\xeda",width:this.isMobil()?"100%":"70%",data:{id:t}}),T.q.addListener("backButton",o=>{this.ref.close()})):this.messageService.add({severity:"error",summary:"Lo sentimos",detail:"No tiene permisos para esto"})}remoRow(t,i){var o=this;return(0,g.A)(function*(){o.load_btn_delte=!0,o.responsemodal=void 0,o.iddelete=void 0,o.catbool=i,o.catbool?(o.responsemodal=yield o.deleteService.verificarCategoria(o.token,t._id).toPromise(),o.responsemodal.cantidadSubcategorias=o.responsemodal.data.length):(o.responsemodal=yield o.deleteService.verificarSubCategoria(o.token,t._id).toPromise(),o.responsemodal.cantidadIncidentes=o.responsemodal.data.length),0==o.responsemodal.data.length&&(o.load_btn_delte=!1),setTimeout(()=>{o.iddelete=t,setTimeout(()=>{o.visibledelete=!0},200)},200)})()}eliminarCategoria(){if(this.iddelete){const t={};this.respaldo?(t.eliminarSubcategorias=!1,t.nuevaCategoria=this.respaldo._id):t.eliminarSubcategorias=!0,this.iddelete.cat?this.deleteService.eliminarCategoria(this.token,this.iddelete._id).subscribe(i=>{this.messageService.add({severity:"success",summary:"Eliminaci\xf3n",detail:"completado"}),this.ngOnInit()},i=>{console.error(i),this.messageService.add({severity:"error",summary:("("+i.status+")").toString(),detail:i.error.message||"Sin conexi\xf3n"})}):this.deleteService.eliminarSubcategoria(this.token,this.iddelete._id).subscribe(i=>{this.messageService.add({severity:"success",summary:"Eliminaci\xf3n",detail:"completado"}),this.ngOnInit()},i=>{this.messageService.add({severity:"error",summary:("("+i.status+")").toString(),detail:i.error.message||"Sin conexi\xf3n"})})}}onRowEditInit(t){this.clonedProducts[t._id]={...t}}onRowEditSave(t){this.updateservice.actualizarCategoria(this.token,t._id,t).subscribe(i=>{this.messageService.add({severity:"success",summary:"Actualizaci\xf3n",detail:"completado"}),this.ngOnInit()},i=>{this.messageService.add({severity:"error",summary:("("+i.status+")").toString(),detail:i.error.message||"Sin conexi\xf3n"})})}onRowEditCancel(t,i){this.categorias[i]=this.clonedProducts[t._id]}verSubcategorias(t){this.router.navigate(["/subcategorias"],{queryParams:{id:t}})}confirmarEliminacion(t){}get options(){return this.responsemodal.cantidadSubcategorias?this.listadocategoria.filter(t=>t.nombre!==this.iddelete.nombre):this.listadosubcategoria.filter(t=>t.nombre!==this.iddelete.nombre)}exportToCSV(){let i;this.convertToCSV(this.categorias,this.cols),i=[{field:"Categoria",header:"Categoria"},{field:"Descripcion_cat",header:"Descripcion_cat"},{field:"Subategoria",header:"Subategoria"},{field:"Descripcion_sub",header:"Descripcion_sub"}].map(h=>h.header??h.field).join(";");let a=[];this.categorias.map(h=>{const y=h.children.map(G=>[h.data.nombre,h.data.descripcion,G.data.nombre,G.data.descripcion].join(";"));a.push(...y)}),a.map(h=>"string"==typeof h?'"'+h.replace(/"/g,'""')+'"':h).join(";"),a.unshift(i);const s="\ufeff"+a.join("\n"),l=new Blob([s],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(l),m=document.createElement("a");m.href=p,m.download="Categorias.csv",m.click(),URL.revokeObjectURL(p)}convertToCSV(t,i){return[i.map(s=>s.header).join(","),...t.map(s=>i.map(l=>s[l.field]).join(","))].join("\r\n")}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(f.Pw),e.rXU(S.a),e.rXU(x.Ix),e.rXU(P),e.rXU(k.w),e.rXU(ue),e.rXU(u.bg),e.rXU(f.o3),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-categoria"]],viewQuery:function(i,o){if(1&i&&e.GBs(_i,5),2&i){let a;e.mGM(a=e.lsd())&&(o.Confirmar=a.first)}},features:[e.Jv_([u.bg])],decls:6,vars:9,consts:[[1,"container-fluid"],["paginatorLocale","fa-IR","sortMode","multiple","columnResizeMode","expand",3,"value","columns","paginator","rows","scrollable","tableStyle","resizableColumns"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","Header",3,"visible","style","visibleChange",4,"ngIf"],[1,"text-xl","font-bold"],["routerLink","/maps/categoria/create-categoria",4,"ngIf"],["routerLink","/maps/subcategoria/create-subcategoria",4,"ngIf"],[3,"click",4,"ngIf"],["label","Exportar a CSV","icon","pi pi-file",3,"click"],["routerLink","/maps/categoria/create-categoria"],["routerLink","/maps/subcategoria/create-subcategoria"],[3,"click"],[4,"ngFor","ngForOf"],[3,"ttSortableColumn",4,"ngIf"],[3,"ttSortableColumn"],[3,"field",4,"ngIf"],[3,"field"],[3,"ttRow"],[4,"ngIf"],[3,"rowNode",4,"ngIf"],[3,"rowNode"],["icon","pi pi-pencil","severity","success",3,"click","rounded"],["icon","pi pi-trash","severity","danger",3,"click","rounded"],["header","Header",3,"visibleChange","visible"],[3,"linear"],["header","Pregunta"],["pTemplate","content"],["header","Subcategoria",4,"ngIf"],["header","Incidentes",4,"ngIf"],["header","Preservar",4,"ngIf"],["pTemplate","footer"],[1,"inline-flex","align-items-center","justify-content-center","gap-2"],[1,"font-bold","white-space-nowrap"],[1,"flex","flex-column","h-12rem"],[1,"border-2","border-dashed","surface-border","border-round","surface-ground","flex-auto","flex","justify-content-center","align-items-center","font-medium"],["class","flex pt-4 justify-content-end",4,"ngIf"],[1,"flex","pt-4","justify-content-end"],["label","Next","icon","pi pi-arrow-right","iconPos","right",3,"onClick"],["header","Subcategoria"],[1,"flex","pt-4","justify-content-between"],["label","Back","icon","pi pi-arrow-left",3,"onClick"],["header","Incidentes"],["header","Preservar"],[1,"mb-3"],["for","exampleFormControlInput1",1,"form-label"],["appendTo","body","optionLabel","name","placeholder","Selecciona una",3,"ngModelChange","options","ngModel","showClear"],["pTemplate","selectedItem"],["pTemplate","item"],["class","flex align-items-center gap-2",4,"ngIf"],[1,"flex","align-items-center","gap-2"],["severity","danger",3,"click"],[3,"click","disabled"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"p-treeTable",1),e.DNE(2,Ii,7,3,"ng-template",2)(3,Fi,2,1,"ng-template",3)(4,Ti,2,2,"ng-template",4),e.k0s()(),e.DNE(5,Vi,9,8,"p-dialog",5)),2&i&&(e.R7$(),e.Y8G("value",o.categorias)("columns",o.cols)("paginator",!0)("rows",10)("scrollable",!0)("tableStyle",e.lJ4(8,gi))("resizableColumns",!0),e.R7$(4),e.Y8G("ngIf",o.iddelete))},dependencies:[b.Sq,b.bT,x.Wk,u.Ei,v.$n,c.BC,c.vS,ie.l,X.ms,ne.zU,ne.ZH,ne.lr,ne.Ww,ne.no,J.C1,J.ct]})}return n})(),Hi=(()=>{class n{constructor(t,i,o,a,s,l){this.fb=t,this.createService=i,this.router=o,this.helper=a,this.messageService=s,this.auth=l,this.model=!0,this.token=this.auth.token(),this.estadoIncidenteForm=this.fb.group({nombre:["",c.k0.required]})}ngOnInit(){this.router.events.subscribe(t=>{this.model="/create-estado-incidente"!==this.router.url})}abrirModal(){this.model=!0}cerrarModal(){this.model=!1}isMobil(){return this.helper.isMobil()}registrarEstadoActividadP(){this.estadoIncidenteForm.valid&&this.createService.registrarEstadoActividadProyecto(this.token,this.estadoIncidenteForm.value).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Ingresado",detail:"Correcto"}),setTimeout(()=>{this.router.navigate(["/home"])},2e3))},t=>{})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.ok),e.rXU(U.m),e.rXU(x.Ix),e.rXU(k.w),e.rXU(u.bg),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-estado-actividad-proyecto"]],features:[e.Jv_([u.bg])],decls:10,vars:3,consts:[[1,"card"],[1,"card-body"],[1,"field","col-12","md:col-6","mb-3"],[3,"ngSubmit","formGroup"],[1,"field","col-12","md:col-6"],["for","nombre",1,"form-label"],["type","text","pInputText","","id","nombre","name","nombre","formControlName","nombre","required","",1,"form-control"],["pButton","","type","submit","label","Guardar","icon","pi pi-save",1,"p-button-primary"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"p-toast"),e.j41(3,"div",2)(4,"form",3),e.bIt("ngSubmit",function(){return o.registrarEstadoActividadP()}),e.j41(5,"div",4)(6,"label",5),e.EFF(7,"Nombre"),e.k0s(),e.nrm(8,"input",6),e.k0s(),e.nrm(9,"button",7),e.k0s()()()()),2&i&&(e.R7$(4),e.Y8G("formGroup",o.estadoIncidenteForm),e.R7$(4),e.xc7("width",o.isMobil()?"auto":"20rem"))},dependencies:[v._f,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,M.S]})}return n})();var I=d(8629);const Ji=()=>[5,10,20];function Wi(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",7),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.abrirModal())}),e.k0s()}}function Zi(n,r){1&n&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"Nombre"),e.k0s()())}function qi(n,r){if(1&n&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.SpI(" ",t.nombre," ")}}function Ki(n,r){if(1&n&&(e.j41(0,"p-table",8),e.DNE(1,Zi,3,0,"ng-template",9)(2,qi,3,1,"ng-template",10),e.k0s()),2&n){const t=e.XpG();e.Y8G("paginatorDropdownAppendTo","body")("value",t.actividadEstado)("paginator",!0)("rows",10)("rowsPerPageOptions",e.lJ4(5,Ji))}}let Qi=(()=>{class n{constructor(t,i,o,a,s,l){this.ref=t,this.dialogService=i,this.router=o,this.listService=a,this.helper=s,this.auth=l,this.actividadEstado=[],this.model=!0,this.check={},this.token=this.auth.token()}ngOnInit(){this.check.CreateEstadoActividadProyectoComponent=this.helper.decryptData("CreateEstadoActividadProyectoComponent")||!1,this.router.events.subscribe(t=>{this.model="/create-estado-incidente"!==this.router.url}),this.listarestadoser()}listarestadoser(){this.listService.listarEstadosActividadesProyecto(this.token).subscribe(t=>{t.data&&(this.actividadEstado=t.data)},t=>{console.error(t)})}isMobil(){return this.helper.isMobil()}abrirModal(){this.ref=this.dialogService.open(Hi,{header:"Nuevo Estado de Actividad Proyecto",width:this.isMobil()?"100%":"50%"}),T.q.addListener("backButton",t=>{this.ref.close()})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(f.Pw),e.rXU(f.o3),e.rXU(x.Ix),e.rXU(S.a),e.rXU(k.w),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-estado-actividad-proyecto"]],decls:9,vars:2,consts:[[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["pButton","","type","button","icon","pi pi-plus","label","Nuevo",3,"click",4,"ngIf"],[1,"modal-body"],[1,"table-responsive-sm"],["currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","paginator","rows","rowsPerPageOptions",4,"ngIf"],["pButton","","type","button","icon","pi pi-plus","label","Nuevo",3,"click"],["currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","paginator","rows","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3,"Estados de Ficha sectorial"),e.k0s(),e.DNE(4,Wi,1,0,"button",3),e.k0s(),e.j41(5,"div",4),e.nrm(6,"p-toast"),e.j41(7,"div",5),e.DNE(8,Ki,3,6,"p-table",6),e.k0s()()()),2&i&&(e.R7$(4),e.Y8G("ngIf",o.check.CreateEstadoActividadProyectoComponent),e.R7$(4),e.Y8G("ngIf",o.actividadEstado))},dependencies:[b.bT,u.Ei,v._f,E.y8,I.XI]})}return n})(),en=(()=>{class n{constructor(t,i,o,a,s,l){this.auth=t,this.fb=i,this.createService=o,this.router=a,this.helper=s,this.messageService=l,this.model=!0,this.token=this.auth.token(),this.estadoIncidenteForm=this.fb.group({nombre:["",c.k0.required]})}ngOnInit(){this.router.events.subscribe(t=>{this.model="/create-estado-incidente"!==this.router.url})}isMobil(){return this.helper.isMobil()}registrarActividadP(){this.estadoIncidenteForm.valid&&this.createService.registrarTipoActividadProyecto(this.token,this.estadoIncidenteForm.value).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Listo",detail:"Ingresado correctamente"}),setTimeout(()=>{this.router.navigate(["/home"])},2e3))},t=>{})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.u),e.rXU(c.ok),e.rXU(U.m),e.rXU(x.Ix),e.rXU(k.w),e.rXU(u.bg))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-actividad-proyecto"]],features:[e.Jv_([u.bg])],decls:10,vars:3,consts:[[1,"card"],[1,"card-body"],[1,"p-fluid","p-formgrid","grid"],[3,"ngSubmit","formGroup"],[1,"field","col-12","md:col-6","mb-3"],["for","nombre",1,"form-label"],["type","text","pInputText","","id","nombre","name","nombre","formControlName","nombre","required","",1,"form-control"],["pButton","","type","submit","label","Guardar","icon","pi pi-save",1,"btn","btn-primary"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"p-toast"),e.j41(3,"div",2)(4,"form",3),e.bIt("ngSubmit",function(){return o.registrarActividadP()}),e.j41(5,"div",4)(6,"label",5),e.EFF(7,"Nombre"),e.k0s(),e.nrm(8,"input",6),e.k0s(),e.nrm(9,"button",7),e.k0s()()()()),2&i&&(e.R7$(4),e.Y8G("formGroup",o.estadoIncidenteForm),e.R7$(4),e.xc7("width",o.isMobil()?"auto":"30rem"))},dependencies:[v._f,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,M.S]})}return n})();function tn(n,r){1&n&&(e.qex(0),e.nrm(1,"p-skeleton",6)(2,"p-skeleton",7)(3,"p-skeleton",8)(4,"p-skeleton",9)(5,"p-skeleton",10),e.bVm())}function nn(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",11)(2,"label",12),e.EFF(3,"Nombre de Categoria"),e.k0s(),e.j41(4,"input",13),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.categoria.nombre,o)||(a.categoria.nombre=o),e.Njj(o)}),e.k0s()(),e.j41(5,"div",11)(6,"label",12),e.EFF(7,"URL del icono"),e.k0s(),e.j41(8,"input",14),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.categoria.icono,o)||(a.categoria.icono=o),e.Njj(o)}),e.k0s()(),e.bVm()}if(2&n){const t=e.XpG();e.R7$(4),e.R50("ngModel",t.categoria.nombre),e.R7$(4),e.R50("ngModel",t.categoria.icono)}}let on=(()=>{class n{constructor(t,i,o,a,s,l,p){this.obtener=t,this.update=i,this.helper=o,this.modalService=a,this.messageService=s,this.config=l,this.auth=p,this.token=this.auth.token(),this.loadcategoria=!1}ngOnInit(){this.id=this.config.data.id,this.obtenerCategoria()}obtenerCategoria(){this.loadcategoria=!1,this.obtener.obtenerTipoActividadProyecto(this.token,this.id).subscribe(t=>{this.categoria=t.data}),setTimeout(()=>{this.loadcategoria=!0},500)}cerrar(){this.modalService.dismissAll()}updateCate(){this.update.actualizarTipoActividadProyecto(this.token,this.id,this.categoria).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Actualizado",detail:t.data.nombre}),setTimeout(()=>{this.modalService.dismissAll()},1e3))},t=>{console.error(t),this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(K.E),e.rXU(P),e.rXU(k.w),e.rXU(L.Bq),e.rXU(u.bg),e.rXU(f.sb),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-edit-actividad-proyecto"]],features:[e.Jv_([u.bg])],decls:8,vars:2,consts:[[1,"modal-content"],[1,"modal-body"],[4,"ngIf"],[1,"p-fluid","p-formgrid","grid"],[1,"d-flex","justify-content-end","mt-3"],["type","button","pButton","","label","Guardar",1,"btn","btn-primary",3,"click"],["styleClass","mb-2","borderRadius","16px"],["width","10rem","styleClass","mb-2","borderRadius","16px"],["width","5rem","styleClass","mb-2","borderRadius","16px"],["height","2rem","styleClass","mb-2","borderRadius","16px"],["width","10rem","height","4rem","borderRadius","16px"],[1,"field","col-12","md:col-6"],["for","nombre",1,"form-label"],["type","text","id","nombre","placeholder","Nombre de Categoria","pInputText","",1,"form-control",3,"ngModelChange","ngModel"],["type","text","id","icono","placeholder","URL del ICONO","pInputText","",1,"form-control",3,"ngModelChange","ngModel"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.nrm(1,"p-toast"),e.j41(2,"div",1),e.DNE(3,tn,6,0,"ng-container",2),e.j41(4,"div",3),e.DNE(5,nn,9,2,"ng-container",2),e.k0s()(),e.j41(6,"div",4)(7,"button",5),e.bIt("click",function(){return o.updateCate()}),e.k0s()()()),2&i&&(e.R7$(3),e.Y8G("ngIf",!o.loadcategoria),e.R7$(2),e.Y8G("ngIf",o.loadcategoria))},dependencies:[b.bT,v._f,E.y8,c.me,c.BC,c.vS,M.S,ae.E]})}return n})();const an=()=>({"min-width":"50rem"}),rn=()=>[5,10,20];function sn(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",6),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.abrirModal())}),e.k0s()}}function ln(n,r){1&n&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"Nombre"),e.k0s(),e.j41(3,"th"),e.EFF(4,"Opci\xf3n"),e.k0s()())}function cn(n,r){if(1&n){const t=e.RV6();e.j41(0,"td")(1,"p-button",14),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.editRow(o))}),e.k0s()()}2&n&&(e.R7$(),e.Y8G("rounded",!0))}function dn(n,r){if(1&n&&(e.j41(0,"tr")(1,"td")(2,"div",11),e.EFF(3),e.nrm(4,"img",12),e.k0s()(),e.DNE(5,cn,2,1,"td",13),e.k0s()),2&n){const t=r.$implicit,i=e.XpG(2);e.R7$(3),e.SpI(" ",t.nombre," "),e.R7$(),e.Y8G("src",t.icono,e.B4B),e.R7$(),e.Y8G("ngIf",i.check.EditActividadProyectoComponent)}}function pn(n,r){if(1&n&&(e.j41(0,"div",7)(1,"p-table",8),e.DNE(2,ln,5,0,"ng-template",9)(3,dn,6,3,"ng-template",10),e.k0s()()),2&n){const t=e.XpG();e.R7$(),e.Y8G("paginatorDropdownAppendTo","body")("value",t.actividadPro)("tableStyle",e.lJ4(6,an))("paginator",!0)("rows",10)("rowsPerPageOptions",e.lJ4(7,rn))}}let mn=(()=>{class n{constructor(t,i,o,a,s,l,p,m){this.auth=t,this.ref=i,this.modalService=o,this.router=a,this.listService=s,this.helper=l,this.dialogService=p,this.messageService=m,this.model=!0,this.actividadPro=[],this.check={},this.token=this.auth.token()}cerrarModal(){this.modalService.dismissAll()}ngOnInit(){var t=this;return(0,g.A)(function*(){t.helper.llamarspinner("subcategoria");const i={CreateActividadProyectoComponent:yield t.auth.hasPermissionComponent("/actividad_proyecto","post"),EditActividadProyectoComponent:yield t.auth.hasPermissionComponent("/actividad_proyecto/:id","put")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a;try{t.router.events.subscribe(s=>{t.model="/create-estado-incidente"!==t.router.url}),t.listarActividadProyecto()}catch(s){console.error("Error en ngOnInit:",s),t.router.navigate(["/notfound"])}finally{t.helper.cerrarspinner("subcategoria")}});return function(a){return o.apply(this,arguments)}}())})()}listarActividadProyecto(){this.listService.listarTiposActividadesProyecto(this.token).subscribe(t=>{t.data&&(this.actividadPro=t.data)})}isMobil(){return this.helper.isMobil()}abrirModal(){this.ref=this.dialogService.open(en,{header:"Nueva Actividad",width:this.isMobil()?"100%":"50%"}),T.q.addListener("backButton",t=>{this.ref.close()})}editRow(t){this.check.EditActividadProyectoComponent?(this.ref=this.dialogService.open(on,{header:"Editar Actividad de Ficha: "+t.nombre,width:this.isMobil()?"100%":"50%",height:"300px",data:{id:t._id}}),T.q.addListener("backButton",i=>{this.ref.close()})):this.messageService.add({severity:"error",summary:"Lo sentimos",detail:"No tiene permisos para esto"})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.u),e.rXU(f.Pw),e.rXU(L.Bq),e.rXU(x.Ix),e.rXU(S.a),e.rXU(k.w),e.rXU(f.o3),e.rXU(u.bg))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-actividad-proyecto"]],features:[e.Jv_([u.bg])],decls:8,vars:2,consts:[[1,"modal"],[1,"modal-header"],[1,"modal-title"],["pButton","","type","button","icon","pi pi-plus","label","Nuevo",3,"click",4,"ngIf"],[1,"modal-body"],["class","table-responsive-sm",4,"ngIf"],["pButton","","type","button","icon","pi pi-plus","label","Nuevo",3,"click"],[1,"table-responsive-sm"],["currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","tableStyle","paginator","rows","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],[2,"display","flex","justify-content","space-between","align-items","center"],["alt","",2,"max-width","50px","width","auto",3,"src"],[4,"ngIf"],["icon","pi pi-pencil","severity","success",3,"click","rounded"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3,"Actividades de Ficha sectorial"),e.k0s(),e.DNE(4,sn,1,0,"button",3),e.k0s(),e.j41(5,"div",4),e.nrm(6,"p-toast"),e.DNE(7,pn,4,8,"div",5),e.k0s()()),2&i&&(e.R7$(4),e.Y8G("ngIf",o.check.CreateActividadProyectoComponent),e.R7$(3),e.Y8G("ngIf",o.actividadPro))},dependencies:[b.bT,u.Ei,v._f,v.$n,E.y8,I.XI]})}return n})();var Me=d(4528),_e=d(1389);const un=()=>({height:"320px",width:"-webkit-fill-available"});function _n(n,r){1&n&&e.nrm(0,"textarea",30)}function gn(n,r){1&n&&e.nrm(0,"p-editor",31),2&n&&e.Aen(e.lJ4(2,un))}function hn(n,r){1&n&&(e.j41(0,"div",5)(1,"label",32),e.EFF(2,"Titulo que se mostrar\xe1 cuando se abra el marcador:"),e.k0s(),e.j41(3,"div",16),e.nrm(4,"input",33),e.k0s()())}function fn(n,r){1&n&&(e.j41(0,"div",5)(1,"label",34),e.EFF(2,"Quieres a\xf1adir la URL del Marcador?"),e.k0s(),e.j41(3,"div",16),e.nrm(4,"input",35),e.k0s()())}function bn(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"form",1),e.bIt("ngSubmit",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.editarFichaSectorial())}),e.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"label",6),e.EFF(7,"Direcci\xf3n Geogr\xe1fica"),e.k0s(),e.nrm(8,"input",7),e.k0s(),e.j41(9,"div",5)(10,"label",8),e.EFF(11,"Actividad de Proyecto"),e.k0s(),e.nrm(12,"p-dropdown",9),e.k0s(),e.j41(13,"div",5)(14,"label",10),e.EFF(15,"Fecha del Evento:"),e.k0s(),e.nrm(16,"p-calendar",11),e.k0s()()(),e.j41(17,"div",12)(18,"div",5)(19,"div",13)(20,"label",14),e.EFF(21,"Estado de Actividad de Proyecto"),e.k0s(),e.nrm(22,"p-dropdown",15),e.k0s()(),e.j41(23,"div",5)(24,"div",16)(25,"p",17),e.EFF(26,"Es un articulo que quieras publicar?"),e.k0s(),e.nrm(27,"p-inputSwitch",18),e.k0s()(),e.j41(28,"div",5)(29,"div",16)(30,"p",17),e.EFF(31,"Quieres que se muestre en la p\xe1gina principal?"),e.k0s(),e.nrm(32,"p-inputSwitch",19),e.k0s()(),e.j41(33,"div",5)(34,"label",20),e.EFF(35,"Descripci\xf3n"),e.k0s(),e.DNE(36,_n,1,0,"textarea",21)(37,gn,1,3,"p-editor",22),e.nrm(38,"div",23),e.k0s(),e.j41(39,"div",5)(40,"label",24),e.EFF(41,"Observaci\xf3n"),e.k0s(),e.nrm(42,"textarea",25),e.k0s(),e.j41(43,"div",5)(44,"label",26),e.EFF(45,"Mostrar en mapa"),e.k0s(),e.nrm(46,"p-inputSwitch",27),e.k0s(),e.DNE(47,hn,5,0,"div",28)(48,fn,5,0,"div",28),e.k0s()(),e.nrm(49,"p-button",29),e.k0s(),e.bVm()}if(2&n){const t=e.XpG(2);e.R7$(),e.Y8G("formGroup",t.fichaSectorialForm),e.R7$(11),e.Y8G("options",t.actividadesProyecto),e.R7$(4),e.Y8G("touchUI",t.isMobil())("readonlyInput",t.isMobil())("showTime",!0)("showIcon",!0),e.R7$(6),e.Y8G("options",t.estadosActividadProyecto),e.R7$(14),e.Y8G("ngIf",!t.fichaSectorialForm.get("es_articulo").value),e.R7$(),e.Y8G("ngIf",t.fichaSectorialForm.get("es_articulo").value),e.R7$(),e.Y8G("innerHTML",t.fichaSectorialForm.get("descripcion").value,e.npT),e.R7$(9),e.Y8G("ngIf",t.fichaSectorialForm.get("mostrar_en_mapa").value),e.R7$(),e.Y8G("ngIf",t.fichaSectorialForm.get("mostrar_en_mapa").value)}}function vn(n,r){1&n&&(e.qex(0),e.j41(1,"div",36)(2,"div",37)(3,"span",38),e.EFF(4,"Cargando..."),e.k0s()()(),e.bVm())}function Cn(n,r){if(1&n&&(e.qex(0),e.nrm(1,"p-toast"),e.DNE(2,bn,50,12,"ng-container",0)(3,vn,5,0,"ng-container",0),e.bVm()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",t.load_form),e.R7$(),e.Y8G("ngIf",!t.load_form)}}let In=(()=>{class n{constructor(t,i,o,a,s,l,p,m,_,h,y){this.config=t,this.fb=i,this.updateService=o,this.router=a,this.listarService=s,this.adminservice=l,this.helper=p,this.messageService=m,this.ref=_,this.filter=h,this.auth=y,this.estadosActividadProyecto=[],this.actividadesProyecto=[],this.model=!0,this.editingF=!0,this.mostrar=!1,this.check={},this.ficha={},this.token=this.auth.token(),this.hover=!1,this.imagenesSeleccionadas=[],this.load_carrusel=!1,this.selectedFiles=[],this.upload=!0,this.responsiveOptions=[{breakpoint:"1024px",numVisible:5},{breakpoint:"768px",numVisible:3},{breakpoint:"560px",numVisible:1}],this.load_form=!0,this.fichaSectorialForm=this.fb.group({direccion_geo:["",c.k0.required],actividad:["",c.k0.required],fecha_evento:["",c.k0.required],estado:["",c.k0.required],es_articulo:[!1],descripcion:["Texto inicial de la descripci\xf3n",c.k0.required],observacion:[""],mostrar_en_mapa:[!1],title_marcador:[""],icono_marcador:[""],destacado:[!1]})}ngOnInit(){var t=this;return(0,g.A)(function*(){t.load_form=!1;const i={EditFichaSectorialComponent:yield t.auth.hasPermissionComponent("/ficha_sectorial/:id","put")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a;try{if(!t.check.EditFichaSectorialComponent)return void t.router.navigate(["/notfound"]);t.config?.data?.id&&(t.id=t.config.data.id,yield t.obtenerficha());const s=t.auth.idUserToken(t.token);if(!s)return void t.router.navigate(["/auth/login"]);t.fichaSectorialForm.get("encargado")?.setValue(s),t.router.events.subscribe(l=>{t.model="/create-ficha-sectorial"!==t.router.url}),t.listartEstados(),t.listarActividadProyecto()}catch(s){console.error("Error en ngOnInit:",s),t.router.navigate(["/notfound"])}finally{t.load_form=!0}});return function(a){return o.apply(this,arguments)}}())})()}formatear(){var t=this;return(0,g.A)(function*(){t.fichaSectorialForm=t.fb.group({descripcion:new c.MJ(t.ficha.descripcion||"",[]),encargado:[t.ficha.encargado||"",c.k0.required],direccion_geo:[t.ficha.direccion_geo||"",c.k0.required],estado:[t.ficha.estado||void 0,c.k0.required],actividad:[t.ficha.actividad||void 0,c.k0.required],fecha_evento:[t.ficha.fecha_evento||""],observacion:[t.ficha.observacion||""],es_articulo:[t.ficha.es_articulo||!1],view:[t.ficha.view||!1],destacado:[t.ficha.destacado||!1],view_id:[t.ficha.view_id||t.auth.idUserToken()],mostrar_en_mapa:[t.ficha.mostrar_en_mapa||!1],title_marcador:[t.ficha.title_marcador||""],icono_marcador:[t.ficha.icono_marcador||"",c.k0.pattern("https?://.+")]})})()}obtenerficha(){var t=this;return(0,g.A)(function*(){t.filter.obtenerActividadProyecto(t.token,t.id).subscribe(function(){var i=(0,g.A)(function*(o){o.data&&(t.ficha=o.data,yield t.formatear(),Object.keys(t.ficha).forEach(a=>{const s=t.ficha[a],l=t.fichaSectorialForm.get(a);l&&(l.setValue(s),!t.check.EditFichaAll&&-1===["descripcion","observacion","estado","mostrar_en_mapa","icono_marcador","es_articulo","title_marcador","destacado"].indexOf(a)&&t.deshabilitarCampo(a))}),"Administrador"===t.auth.roleUserToken(t.token)?.nombre&&t.habilitarCampo("direccion_geo"))});return function(o){return i.apply(this,arguments)}}())})()}deshabilitarCampo(t){this.fichaSectorialForm.get(t)?.disable()}habilitarCampo(t){this.fichaSectorialForm.get(t)?.enable()}listartEstados(){this.listarService.listarEstadosActividadesProyecto(this.token).subscribe(t=>{t.data.length>0&&(this.estadosActividadProyecto=t.data)},t=>{"InvalidToken"===t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:`(${t.status})`,detail:t.error.message||"Sin conexi\xf3n"})})}listarActividadProyecto(){this.listarService.listarTiposActividadesProyecto(this.token).subscribe(t=>{t.data.length>0&&(this.actividadesProyecto=t.data,this.mostrar=!0)},t=>{"InvalidToken"===t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:`(${t.status})`,detail:t.error.message||"Sin conexi\xf3n"})})}abrirModal(){this.model=!0}cerrarModal(){this.model=!1}activarHover(){this.hover=!0}desactivarHover(){this.hover=!1}isMobil(){return this.helper.isMobil()}onFilesSelected(t){this.load_carrusel=!1,this.upload=!0;for(let i of t.files){this.selectedFiles.push(i);const o=URL.createObjectURL(i);this.imagenesSeleccionadas.push({itemImageSrc:o})}this.messageService.add({severity:"info",summary:"File Uploaded",detail:`${this.selectedFiles.length} Imagenes subidas`}),setTimeout(()=>{this.load_carrusel=!0},1e3),this.upload=!1}eliminarImagen(t){this.load_carrusel=!1,this.upload=!0,this.imagenesSeleccionadas.splice(t,1),this.selectedFiles.splice(t,1),setTimeout(()=>{this.load_carrusel=!0},500)}editarFichaSectorial(){this.load_form=!1,this.fichaSectorialForm?.valid&&this.updateService.actualizarActividadProyecto(this.token,this.id,this.fichaSectorialForm.value).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"\xc9xito",detail:"Ficha Sectorial Actualizado"}),this.ref.close(),location.reload())},t=>{console.error(t),"InvalidToken"===t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:`(${t.status})`,detail:t.error.message||"Sin conexi\xf3n"}),this.load_form=!0})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(f.sb),e.rXU(c.ok),e.rXU(P),e.rXU(x.Ix),e.rXU(S.a),e.rXU(Y.z),e.rXU(k.w),e.rXU(u.bg),e.rXU(f.Pw),e.rXU(K.E),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-edit-ficha-sectorial"]],decls:1,vars:1,consts:[[4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"flex","flex-wrap"],[1,"w-full","lg:w-6","p-4","lg:p-7","surface-card"],[1,"flex","flex-column","gap-2","mx-auto"],[1,"field","p-fluid"],["htmlFor","direccion_geo"],["pInputText","","id","direccion_geo","type","text","formControlName","direccion_geo","optionLabel","direccion_geo.nombre"],["htmlFor","actividad"],["id","actividad","name","actividad","formControlName","actividad","optionLabel","nombre",3,"options"],["htmlFor","fecha_evento"],["id","fecha_evento","name","fecha_evento","formControlName","fecha_evento","appendTo","body","inputId","buttondisplay","hourFormat","12",3,"touchUI","readonlyInput","showTime","showIcon"],[1,"w-full","lg:w-6","p-4","lg:p-7"],[1,"mb-3"],["htmlFor","estado"],["id","estado","name","estado","formControlName","estado","optionLabel","nombre",3,"options"],[2,"display","flex","align-items","center","justify-content","flex-start"],[2,"margin","1rem"],["formControlName","es_articulo"],["formControlName","destacado"],["htmlFor","descripcion"],["rows","5","cols","25","pInputTextarea","","id","descripcion","name","descripcion","formControlName","descripcion","required","",4,"ngIf"],["formControlName","descripcion",3,"style",4,"ngIf"],[3,"innerHTML"],["htmlFor","observacion"],["rows","5","cols","25","pInputTextarea","","id","observacion","name","observacion","formControlName","observacion",1,"form-control"],["htmlFor","mostrar_en_mapa"],["formControlName","mostrar_en_mapa"],["class","field p-fluid",4,"ngIf"],["label","Registrar","type","submit","icon","bi bi-save"],["rows","5","cols","25","pInputTextarea","","id","descripcion","name","descripcion","formControlName","descripcion","required",""],["formControlName","descripcion"],["htmlFor","title_marcador"],["type","text","pInputText","","formControlName","title_marcador"],["htmlFor","icono_marcador"],["type","text","pInputText","","formControlName","icono_marcador"],[1,"text-center"],["role","status",1,"spinner-border","text-success"],[1,"visually-hidden"]],template:function(i,o){1&i&&e.DNE(0,Cn,4,2,"ng-container",0),2&i&&e.Y8G("ngIf",o.model)},dependencies:[b.bT,v.$n,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,me.Vv,X.ms,M.S,Me.KE,_e.HW,H.Z]})}return n})();var ge=d(7793);const yn=["contentimage"],xn=()=>({"max-width":"50%"}),kn=n=>({width:n}),je=()=>({width:"50vw","z-index":1e4}),Te=()=>({"1199px":"75vw","575px":"90vw"}),se=()=>[10,25,50],Fn=()=>["direccion_geo","actividad.nombre","encargado.name","estado.nombre"],En=()=>["direccion_geo","direccion_geo.nombre","actividad.nombre","encargado.name","estado.nombre"],Sn=()=>({width:"50vw"});function Mn(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3);return e.Njj(o.llamarmodal2())}),e.k0s()}}function jn(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3);return e.Njj(o.llamarmodal())}),e.k0s()}}function Tn(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",24)(1,"button",25),e.bIt("click",function(){e.eBV(t),e.XpG();const o=e.sdS(7),a=e.XpG(2);return e.Njj(a.clear(o))}),e.k0s(),e.j41(2,"span",26),e.nrm(3,"i",27),e.j41(4,"input",28),e.bIt("input",function(o){e.eBV(t),e.XpG();const a=e.sdS(7);return e.Njj(a.filterGlobal(o.target.value,"contains"))}),e.k0s()()()}}function wn(n,r){1&n&&(e.j41(0,"th",35)(1,"div",31),e.EFF(2," Direcci\xf3n "),e.nrm(3,"p-columnFilter",43),e.j41(4,"th",44),e.nrm(5,"p-sortIcon",45),e.k0s()()())}function Rn(n,r){1&n&&(e.j41(0,"th",30)(1,"div",31),e.EFF(2," Encargado "),e.nrm(3,"p-columnFilter",46),e.j41(4,"th",47),e.nrm(5,"p-sortIcon",48),e.k0s()()())}function Dn(n,r){if(1&n&&(e.j41(0,"tr"),e.DNE(1,wn,6,0,"th",29),e.j41(2,"th",30)(3,"div",31),e.EFF(4," Actividad "),e.nrm(5,"p-columnFilter",32),e.j41(6,"th",33),e.nrm(7,"p-sortIcon",34),e.k0s()()(),e.j41(8,"th",35)(9,"div",31),e.EFF(10," Fecha del evento "),e.nrm(11,"p-columnFilter",36),e.j41(12,"th",37),e.nrm(13,"p-sortIcon",38),e.k0s()()(),e.DNE(14,Rn,6,0,"th",39),e.j41(15,"th",30)(16,"div",31),e.EFF(17," Estado "),e.nrm(18,"p-columnFilter",40),e.j41(19,"th",41),e.nrm(20,"p-sortIcon",42),e.k0s()()()()),2&n){const t=e.XpG(3);e.R7$(),e.Y8G("ngIf",!t.modal),e.R7$(13),e.Y8G("ngIf",t.check.IndexFichaSectorialComponent)}}function Gn(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG(2).$implicit,i=e.XpG(3);e.R7$(),e.JRh(i.parseJSON(t.direccion_geo).nombre)}}function Pn(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG(3).$implicit;e.R7$(),e.SpI(" ",t.direccion_geo.nombre," ")}}function zn(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG(3).$implicit;e.R7$(),e.SpI(" ",t.direccion_geo," ")}}function Xn(n,r){if(1&n&&(e.qex(0),e.DNE(1,Pn,2,1,"ng-container",2)(2,zn,2,1,"ng-container",2),e.bVm()),2&n){const t=e.XpG(2).$implicit;e.R7$(),e.Y8G("ngIf",t.direccion_geo.nombre),e.R7$(),e.Y8G("ngIf",!t.direccion_geo.nombre)}}function Nn(n,r){if(1&n&&(e.j41(0,"td"),e.DNE(1,Gn,2,1,"ng-container",2)(2,Xn,3,2,"ng-container",2),e.k0s()),2&n){const t=e.XpG().$implicit,i=e.XpG(3);e.R7$(),e.Y8G("ngIf",i.isJSONString(t.direccion_geo)),e.R7$(),e.Y8G("ngIf",!i.isJSONString(t.direccion_geo))}}function An(n,r){if(1&n){const t=e.RV6();e.j41(0,"span",52),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(3);return a.displayBasic=!0,e.Njj(a.openModalimagen(o.foto))}),e.k0s()}}function Bn(n,r){if(1&n&&(e.j41(0,"td"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.Lme(" ",t.encargado.name," ",t.encargado.last_name," ")}}function Un(n,r){if(1&n){const t=e.RV6();e.j41(0,"tr",49),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG(3);return e.Njj(a.showdialog(o))}),e.DNE(1,Nn,3,2,"td",2),e.j41(2,"td",49),e.bIt("click",function(o){const a=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(a.foto&&a.foto.length>0&&s.stopPropagation(o))}),e.DNE(3,An,1,0,"span",50),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.nI1(7,"date"),e.k0s(),e.DNE(8,Bn,2,2,"td",2),e.j41(9,"td"),e.nrm(10,"p-tag",51),e.k0s()()}if(2&n){const t=r.$implicit,i=e.XpG(3);e.R7$(),e.Y8G("ngIf",!i.modal),e.R7$(2),e.Y8G("ngIf",t.foto&&t.foto.length>0),e.R7$(),e.SpI(" ",t.actividad.nombre," "),e.R7$(2),e.SpI(" ",e.brH(7,7,t.fecha_evento,"medium","es")," "),e.R7$(2),e.Y8G("ngIf",i.check.IndexFichaSectorialComponent),e.R7$(2),e.Y8G("value",t.estado.nombre)("severity",i.getSeverity(t.estado.nombre))}}function Ln(n,r){1&n&&(e.j41(0,"tr")(1,"td",53),e.EFF(2,"No se encontraron incidentes."),e.k0s()())}function On(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-dialog",11),e.mxI("visibleChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.vermodal,o)||(a.vermodal=o),e.Njj(o)}),e.j41(1,"div",12)(2,"div",13)(3,"div",14),e.DNE(4,Mn,1,0,"button",15)(5,jn,1,0,"button",16),e.k0s()()(),e.j41(6,"p-table",17,1),e.DNE(8,Tn,5,0,"ng-template",18)(9,Dn,21,2,"ng-template",19)(10,Un,11,11,"ng-template",20)(11,Ln,3,0,"ng-template",21),e.k0s()()}if(2&n){const t=e.XpG(2);e.Aen(e.lJ4(19,je)),e.Y8G("header","Listado de Ficha Sectorial de: "+t.valor)("modal",!1),e.R50("visible",t.vermodal),e.Y8G("position","bottom")("maximizable",!0)("breakpoints",e.lJ4(20,Te)),e.R7$(4),e.Y8G("ngIf",t.check.TotalFilter&&t.check.IndexActividadProyectoComponent),e.R7$(),e.Y8G("ngIf",t.check.TotalFilter&&t.check.IndexEstadoActividadProyectoComponent),e.R7$(),e.Y8G("paginatorDropdownAppendTo","body")("value",t.fichasectorial)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.lJ4(21,se))("loading",t.load_lista)("paginator",!0)("globalFilterFields",e.lJ4(22,Fn))("sortMode","multiple")}}function $n(n,r){if(1&n&&(e.j41(0,"div",12)(1,"div",56)(2,"div",57)(3,"h3"),e.EFF(4),e.k0s()()()()),2&n){const t=e.XpG(3);e.R7$(4),e.SpI("Actividades de ",t.valor,"")}}function Vn(n,r){1&n&&(e.j41(0,"tr")(1,"th",58)(2,"div",31),e.EFF(3,"Actividad"),e.k0s()(),e.j41(4,"th",35)(5,"div",31),e.EFF(6,"Desripci\xf3n"),e.k0s()(),e.j41(7,"th",58)(8,"div",31),e.EFF(9," Fecha del evento "),e.k0s()()())}function Yn(n,r){if(1&n){const t=e.RV6();e.j41(0,"span",52),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(3);return a.displayBasic=!0,e.Njj(a.openModalimagen(o.foto))}),e.k0s()}}function Hn(n,r){if(1&n){const t=e.RV6();e.j41(0,"tr")(1,"td",49),e.bIt("click",function(o){const a=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(a.foto&&a.foto.length>0&&s.stopPropagation(o))}),e.DNE(2,Yn,1,0,"span",50),e.EFF(3),e.k0s(),e.j41(4,"td"),e.EFF(5),e.k0s(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.k0s()()}if(2&n){const t=r.$implicit;e.R7$(2),e.Y8G("ngIf",t.foto&&t.foto.length>0),e.R7$(),e.SpI(" ",t.actividad.nombre," "),e.R7$(2),e.SpI(" ",t.descripcion," "),e.R7$(2),e.SpI(" ",e.brH(8,4,t.fecha_evento,"medium","es")," ")}}function Jn(n,r){1&n&&(e.j41(0,"tr")(1,"td",53),e.EFF(2,"No se encontraron incidentes."),e.k0s()())}function Wn(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-dialog",54),e.mxI("visibleChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.vermodal,o)||(a.vermodal=o),e.Njj(o)}),e.DNE(1,$n,5,1,"ng-template",19),e.j41(2,"p-table",55,1),e.DNE(4,Vn,10,0,"ng-template",19)(5,Hn,9,8,"ng-template",20)(6,Jn,3,0,"ng-template",21),e.k0s()()}if(2&n){const t=e.XpG(2);e.Aen(e.lJ4(14,je)),e.Y8G("modal",!1),e.R50("visible",t.vermodal),e.Y8G("position","bottom")("maximizable",!0)("breakpoints",e.lJ4(15,Te)),e.R7$(2),e.Y8G("paginatorDropdownAppendTo","body")("value",t.fichasectorial)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.lJ4(16,se))("loading",t.load_lista)("paginator",!0)}}function Zn(n,r){if(1&n&&(e.qex(0),e.DNE(1,On,12,23,"p-dialog",9)(2,Wn,7,17,"p-dialog",10),e.bVm()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.check.IndexFichaSectorialComponent),e.R7$(),e.Y8G("ngIf",!t.check.IndexFichaSectorialComponent)}}function qn(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3);return e.Njj(o.llamarmodal2())}),e.k0s()}}function Kn(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3);return e.Njj(o.llamarmodal())}),e.k0s()}}function Qn(n,r){if(1&n&&(e.j41(0,"div",14),e.DNE(1,qn,1,0,"button",15)(2,Kn,1,0,"button",16),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.check.IndexActividadProyectoComponent),e.R7$(),e.Y8G("ngIf",t.check.IndexEstadoActividadProyectoComponent)}}function eo(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",24)(1,"button",25),e.bIt("click",function(){e.eBV(t),e.XpG();const o=e.sdS(1),a=e.XpG(2);return e.Njj(a.clear(o))}),e.k0s(),e.j41(2,"span",26),e.nrm(3,"i",27),e.j41(4,"input",65),e.bIt("input",function(o){e.eBV(t),e.XpG();const a=e.sdS(1);return e.Njj(a.filterGlobal(o.target.value,"contains"))}),e.k0s()()()}}function to(n,r){1&n&&(e.j41(0,"tr")(1,"th",66),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",58)(4,"div",31),e.EFF(5," Sector "),e.nrm(6,"p-columnFilter",43),e.j41(7,"th",44),e.nrm(8,"p-sortIcon",45),e.k0s()()(),e.j41(9,"th",58)(10,"div",31),e.EFF(11," Actividad "),e.nrm(12,"p-columnFilter",32),e.j41(13,"th",33),e.nrm(14,"p-sortIcon",34),e.k0s()()(),e.j41(15,"th",35)(16,"div",31),e.EFF(17," Descripci\xf3n "),e.nrm(18,"p-columnFilter",67),e.j41(19,"th",68),e.nrm(20,"p-sortIcon",69),e.k0s()()(),e.j41(21,"th",58)(22,"div",31),e.EFF(23," Fecha del evento "),e.nrm(24,"p-columnFilter",36),e.j41(25,"th",37),e.nrm(26,"p-sortIcon",38),e.k0s()()(),e.j41(27,"th",58)(28,"div",31),e.EFF(29," Encargado "),e.nrm(30,"p-columnFilter",46),e.j41(31,"th",47),e.nrm(32,"p-sortIcon",48),e.k0s()()(),e.j41(33,"th",58)(34,"div",31),e.EFF(35," Estado "),e.nrm(36,"p-columnFilter",40),e.j41(37,"th",41),e.nrm(38,"p-sortIcon",42),e.k0s()()(),e.j41(39,"th"),e.EFF(40,"Foto"),e.k0s(),e.j41(41,"th",70)(42,"div",31),e.EFF(43," Funciones "),e.nrm(44,"p-columnFilter",71),e.j41(45,"th",72),e.nrm(46,"p-sortIcon",73),e.k0s()()()())}function io(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG().$implicit,i=e.XpG(3);e.R7$(),e.JRh(i.parseJSON(t.direccion_geo).nombre)}}function no(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",t.direccion_geo.nombre," ")}}function oo(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",t.direccion_geo," ")}}function ao(n,r){if(1&n&&(e.qex(0),e.DNE(1,no,2,1,"ng-container",2)(2,oo,2,1,"ng-container",2),e.bVm()),2&n){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",t.direccion_geo.nombre),e.R7$(),e.Y8G("ngIf",!t.direccion_geo.nombre)}}function ro(n,r){if(1&n){const t=e.RV6();e.j41(0,"img",76),e.bIt("click",function(o){e.eBV(t);const a=e.XpG().$implicit,s=e.XpG(3);return s.stopPropagation(o),s.openimagen(a.foto),e.Njj(s.displayBasic=!0)}),e.k0s()}if(2&n){const t=e.XpG().$implicit,i=e.XpG(3);e.Y8G("src",i.url+"obtener_imagen/ficha_sectorial/"+t.foto[0],e.B4B)}}function so(n,r){if(1&n){const t=e.RV6();e.j41(0,"tr",49),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG(3);return a.visible=!0,e.Njj(a.option=o)}),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.DNE(4,io,2,1,"ng-container",2)(5,ao,3,2,"ng-container",2),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.nrm(16,"p-tag",51),e.k0s(),e.j41(17,"td"),e.DNE(18,ro,1,1,"img",74),e.k0s(),e.j41(19,"td")(20,"i",75),e.EFF(21," Mapa "),e.k0s(),e.j41(22,"i",75),e.EFF(23," Destacado"),e.k0s(),e.j41(24,"i",75),e.EFF(25,"Art\xedculo"),e.k0s()()()}if(2&n){const t=r.$implicit,i=r.rowIndex,o=e.XpG(3);e.R7$(2),e.JRh(i+1),e.R7$(2),e.Y8G("ngIf",o.isJSONString(t.direccion_geo)),e.R7$(),e.Y8G("ngIf",!o.isJSONString(t.direccion_geo)),e.R7$(2),e.SpI(" ",t.actividad.nombre," "),e.R7$(2),e.SpI(" ",t.descripcion," "),e.R7$(2),e.SpI(" ",e.brH(12,17,t.fecha_evento,"medium","es")," "),e.R7$(3),e.Lme(" ",t.encargado.name," ",t.encargado.last_name," "),e.R7$(2),e.Y8G("value",t.estado.nombre)("severity",o.getSeverity(t.estado.nombre)),e.R7$(2),e.Y8G("ngIf",t.foto&&t.foto.length>0),e.R7$(2),e.xc7("color",t.mostrar_en_mapa?"var(--primary-color)":""),e.R7$(2),e.xc7("color",t.destacado?"var(--primary-color)":""),e.R7$(2),e.xc7("color",t.es_articulo?"var(--primary-color)":"")}}function lo(n,r){1&n&&(e.j41(0,"tr")(1,"td",53),e.EFF(2,"No se encontraron incidentes."),e.k0s()())}function co(n,r){if(1&n&&(e.j41(0,"p-table",17,1),e.DNE(2,eo,5,0,"ng-template",18)(3,to,47,0,"ng-template",19)(4,so,26,21,"ng-template",20)(5,lo,3,0,"ng-template",21),e.k0s()),2&n){const t=e.XpG(2);e.Y8G("paginatorDropdownAppendTo","body")("value",t.fichasectorial)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.lJ4(9,se))("loading",t.load_lista)("paginator",!0)("globalFilterFields",e.lJ4(10,En))("sortMode","multiple")}}function po(n,r){1&n&&(e.j41(0,"tr")(1,"th",66),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",58)(4,"div",31),e.EFF(5,"Direcci\xf3n"),e.k0s()(),e.j41(6,"th",58)(7,"div",31),e.EFF(8,"Actividad"),e.k0s()(),e.j41(9,"th",35)(10,"div",31),e.EFF(11," Desripci\xf3n "),e.k0s()(),e.j41(12,"th",58)(13,"div",31),e.EFF(14," Fecha del evento "),e.k0s()(),e.j41(15,"th",58)(16,"div",31),e.EFF(17,"Fotos"),e.k0s()()())}function mo(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG().$implicit,i=e.XpG(3);e.R7$(),e.SpI(" ",i.parseJSON(t.direccion_geo).nombre," ")}}function uo(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",t.direccion_geo.nombre," ")}}function _o(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",t.direccion_geo," ")}}function go(n,r){if(1&n&&(e.qex(0),e.DNE(1,uo,2,1,"ng-container",2)(2,_o,2,1,"ng-container",2),e.bVm()),2&n){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",t.direccion_geo.nombre),e.R7$(),e.Y8G("ngIf",!t.direccion_geo.nombre)}}function ho(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",78),e.bIt("click",function(o){e.eBV(t);const a=e.XpG().$implicit,s=e.XpG(3);return s.displayBasic=!0,s.openModalimagen(a.foto),e.Njj(o.stopPropagation())}),e.k0s()}2&n&&e.Y8G("raised",!0)("outlined",!0)}function fo(n,r){if(1&n){const t=e.RV6();e.j41(0,"tr",49),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG(3);return e.Njj(a.navigateToFicha(o._id))}),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.DNE(4,mo,2,1,"ng-container",2)(5,go,3,2,"ng-container",2),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"td"),e.DNE(14,ho,1,2,"p-button",77),e.k0s()()}if(2&n){const t=r.$implicit,i=r.rowIndex,o=e.XpG(3);e.R7$(2),e.JRh(i+1),e.R7$(2),e.Y8G("ngIf",o.isJSONString(t.direccion_geo)),e.R7$(),e.Y8G("ngIf",!o.isJSONString(t.direccion_geo)),e.R7$(2),e.JRh(t.actividad.nombre),e.R7$(2),e.JRh(t.title_marcador),e.R7$(2),e.JRh(e.brH(12,7,t.fecha_evento,"medium","es")),e.R7$(3),e.Y8G("ngIf",t.foto&&t.foto.length>0)}}function bo(n,r){1&n&&(e.j41(0,"tr")(1,"td",53),e.EFF(2,"No se encontraron incidentes."),e.k0s()())}function vo(n,r){if(1&n&&(e.j41(0,"p-table",55,1),e.DNE(2,po,18,0,"ng-template",19)(3,fo,15,11,"ng-template",20)(4,bo,3,0,"ng-template",21),e.k0s()),2&n){const t=e.XpG(2);e.Y8G("paginatorDropdownAppendTo","body")("value",t.fichasectorial)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.lJ4(7,se))("loading",t.load_lista)("paginator",!0)}}function Co(n,r){if(1&n&&(e.qex(0),e.j41(1,"div",59)(2,"div",60)(3,"div",12)(4,"div",56)(5,"div",57)(6,"h3"),e.EFF(7,"Listado de Ficha Sectorial"),e.k0s()(),e.DNE(8,Qn,3,2,"div",61),e.k0s()()(),e.j41(9,"div",62),e.nrm(10,"p-toast"),e.DNE(11,co,6,11,"p-table",63)(12,vo,5,8,"p-table",64),e.k0s()(),e.bVm()),2&n){const t=e.XpG();e.R7$(8),e.Y8G("ngIf",t.check.TotalFilter),e.R7$(3),e.Y8G("ngIf",t.check.IndexFichaSectorialComponent),e.R7$(),e.Y8G("ngIf",!t.check.IndexFichaSectorialComponent)}}function Io(n,r){if(1&n&&e.nrm(0,"button",96),2&n){const t=r.index;e.AVh("active",0===t),e.BMQ("data-bs-slide-to",t)}}function yo(n,r){if(1&n&&(e.j41(0,"div",97),e.nrm(1,"img",98),e.k0s()),2&n){const t=r.$implicit,i=r.index,o=e.XpG(2);e.AVh("active",0===i),e.R7$(),e.Y8G("src",o.url+"obtener_imagen/ficha_sectorial/"+t,e.B4B)}}function xo(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",99)(1,"img",100),e.bIt("click",function(){const o=e.eBV(t).index,a=e.XpG(2);return e.Njj(a.mostrarImagen(o))}),e.k0s()()}if(2&n){const t=r.$implicit,i=e.XpG(2);e.R7$(),e.Y8G("src",i.url+"obtener_imagen/ficha_sectorial/"+t,e.B4B)}}function ko(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",79)(1,"h4",80),e.EFF(2,"Imagenes"),e.k0s(),e.j41(3,"button",81),e.bIt("click",function(){const o=e.eBV(t).$implicit;return e.Njj(o.dismiss("Cross click"))}),e.j41(4,"span",82),e.EFF(5,"\xd7"),e.k0s()()(),e.j41(6,"div",83)(7,"div",84)(8,"div",85),e.DNE(9,Io,1,3,"button",86),e.k0s(),e.j41(10,"div",87),e.DNE(11,yo,2,3,"div",88),e.k0s(),e.j41(12,"button",89),e.nrm(13,"span",90),e.j41(14,"span",91),e.EFF(15,"Previous"),e.k0s()(),e.j41(16,"button",92),e.nrm(17,"span",93),e.j41(18,"span",91),e.EFF(19,"Next"),e.k0s()()(),e.j41(20,"div",94),e.DNE(21,xo,2,1,"div",95),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(9),e.Y8G("ngForOf",t.imagenModal),e.R7$(2),e.Y8G("ngForOf",t.imagenModal),e.R7$(10),e.Y8G("ngForOf",t.imagenModal.slice(0,3))}}function Fo(n,r){if(1&n&&e.nrm(0,"img",101),2&n){const t=r.$implicit,i=e.XpG();e.Y8G("src",i.url+"obtener_imagen/ficha_sectorial/"+t,e.B4B)}}function Eo(n,r){if(1&n&&(e.j41(0,"div",102),e.nrm(1,"img",103),e.k0s()),2&n){const t=r.$implicit,i=e.XpG();e.R7$(),e.Y8G("src",i.url+"obtener_imagen/ficha_sectorial/"+t,e.B4B)}}function So(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",110),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return o.displayBasic=!0,e.Njj(o.openModalimagen(o.option.foto))}),e.k0s()}}function Mo(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",111),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.editingrow(o.option._id))}),e.k0s()}}function jo(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",112),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.eliminarModal(o.option))}),e.k0s()}}function To(n,r){if(1&n&&(e.j41(0,"div",83)(1,"p")(2,"strong"),e.EFF(3,"Actividad:"),e.k0s(),e.EFF(4),e.k0s(),e.j41(5,"p")(6,"strong"),e.EFF(7,"Descripci\xf3n:"),e.k0s(),e.EFF(8),e.k0s(),e.j41(9,"p")(10,"strong"),e.EFF(11,"Encargado:"),e.k0s(),e.EFF(12),e.k0s(),e.j41(13,"p")(14,"strong"),e.EFF(15,"Estado:"),e.k0s(),e.nrm(16,"p-tag",51),e.k0s(),e.j41(17,"p")(18,"strong"),e.EFF(19,"Fecha Evento:"),e.k0s(),e.EFF(20),e.nI1(21,"date"),e.k0s(),e.j41(22,"p")(23,"strong"),e.EFF(24,"Observaci\xf3n:"),e.k0s(),e.EFF(25),e.k0s(),e.j41(26,"div",104)(27,"div",105),e.DNE(28,So,1,0,"p-button",106),e.k0s(),e.j41(29,"div",107),e.DNE(30,Mo,1,0,"p-button",108)(31,jo,1,0,"p-button",109),e.k0s()()()),2&n){const t=e.XpG();e.R7$(4),e.SpI(" ",t.option.actividad.nombre," "),e.R7$(4),e.SpI(" ",t.option.descripcion," "),e.R7$(4),e.Lme(" ",t.option.encargado.name," ",t.option.encargado.last_name," "),e.R7$(4),e.Y8G("value",t.option.estado.nombre)("severity",t.getSeverity(t.option.estado.nombre)),e.R7$(4),e.SpI(" ",e.i5U(21,11,t.option.fecha_evento,"dd/MM/yyyy")," "),e.R7$(5),e.SpI(" ",t.option.observacion," "),e.R7$(3),e.Y8G("ngIf",t.option.foto&&t.option.foto.length>0),e.R7$(2),e.Y8G("ngIf",t.id==t.option.encargado._id||t.check.EditFichaSectorialComponent),e.R7$(),e.Y8G("ngIf",t.id==t.option.encargado._id||t.check.BorrarFichaSectorialComponent)}}function wo(n,r){if(1&n&&(e.j41(0,"div",118)(1,"span",119),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI(" Confirmar Eliminaci\xf3n: ",t.iddelete.nombre,"")}}function Ro(n,r){1&n&&(e.j41(0,"div",120)(1,"div",121)(2,"p"),e.EFF(3," \xbfEst\xe1s seguro que deseas eliminar esta ficha sectorial? "),e.k0s()()())}function Do(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",122),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.visibledelete=!1)}),e.EFF(1," Cancelar "),e.k0s(),e.j41(2,"p-button",49),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return o.eliminarIncidente(),e.Njj(o.visibledelete=!1)}),e.EFF(3," Eliminar "),e.k0s()}}function Go(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-dialog",113),e.mxI("visibleChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.visibledelete,o)||(a.visibledelete=o),e.Njj(o)}),e.DNE(1,wo,3,1,"ng-template",19),e.j41(2,"p-stepper",114)(3,"p-stepperPanel",115),e.DNE(4,Ro,4,0,"ng-template",116),e.k0s()(),e.DNE(5,Do,4,0,"ng-template",117),e.k0s()}if(2&n){const t=e.XpG();e.Aen(e.lJ4(4,Sn)),e.R50("visible",t.visibledelete),e.R7$(2),e.Y8G("linear",!0)}}let we=(()=>{class n{clear(t){t.clear()}getSeverity(t){if(!t)return null;switch(t.toLowerCase()){case"suspendido":return"danger";case"finalizado":return"success";case"en proceso":case"planificada":return"info";case"pendiente":return"warning";default:return"secondary"}}deshabilitarMapaDesdeIndexFichaSectorial(t){this.stopPropagation(t),this.helperservice.deshabilitarMapa()}constructor(t,i,o,a,s,l,p,m,_,h,y){this.ref=t,this.router=i,this.listService=o,this.helperservice=a,this.messageService=s,this.dialogService=l,this.admin=p,this.deleteService=m,this.updateService=_,this.auth=h,this.filter=y,this.url=V.M.url,this.modal=!1,this.load_lista=!0,this.fichasectorial=[],this.check={},this.visible=!1,this.token=this.auth.token(),this.id=this.auth.idUserToken(this.token),this.loading=!1,this.limit=!1,this.width=200,this.height=200,this.isResizing=!1,this.initialTouchY=0,this.isDragging=!1,this.imagenModal=[],this.imagenModalChange=new e.bkB,this.displayBasic=!1,this.responsiveOptions=[{breakpoint:"1500px",numVisible:5},{breakpoint:"1024px",numVisible:3},{breakpoint:"768px",numVisible:2},{breakpoint:"560px",numVisible:1}],this.iddelete="",this.visibledelete=!1}ngOnChanges(t){(t.filtro||t.valor)&&(this.listarficha(),this.height=300)}get vermodal(){return!!this.modal&&this.modal}set vermodal(t){this.helperservice.cerrarficha()}ngOnInit(){var t=this;return(0,g.A)(function*(){t.modal||t.helperservice.llamarspinner("index ficha");const i={IndexFichaSectorialComponent:yield t.auth.hasPermissionComponent("/ficha_sectorial","post"),EditFichaSectorialComponent:yield t.auth.hasPermissionComponent("/ficha_sectorial/:id","put"),IndexEstadoActividadProyectoComponent:yield t.auth.hasPermissionComponent("/estado_actividad_proyecto","get"),IndexActividadProyectoComponent:yield t.auth.hasPermissionComponent("/actividad_proyecto","get"),TotalFilter:yield t.auth.hasPermissionComponent("mostra_todas_fichas","get"),BorrarFichaSectorialComponent:yield t.auth.hasPermissionComponent("/ficha_sectorial/:id","delete")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a;try{a.IndexFichaSectorialComponent||a.TotalFilter?t.listarficha():t.listarFichaSectorial()}catch(s){console.error("Error en ngOnInit:",s),t.router.navigate(["/notfound"])}finally{t.modal||t.helperservice.cerrarspinner("index ficha"),setTimeout(()=>{t.loading=!0},2e3)}});return function(a){return o.apply(this,arguments)}}())})()}listarFichaSectorial(){this.load_lista=!0,this.listService.listarFichaSectorialMapa().subscribe(t=>{t.data&&t.data.length>0&&(this.fichasectorial=t.data,this.limit=!0),this.load_lista=!1})}isMobil(){return this.helperservice.isMobil()}isJSONString(t){try{return JSON.parse(t),!0}catch{return!1}}parseJSON(t){try{return JSON.parse(t)}catch(i){return console.error("Error parsing JSON string:",i),null}}listarficha(){this.modal||this.helperservice.llamarspinner("listar ficha sectorial"),this.load_lista=!0;let i,t="";this.filtro&&this.valor&&(t=this.filtro,i=this.valor),this.check.TotalFilter||(t="encargado",i=this.id),this.listService.listarFichaSectorial(this.token,{[t]:i}).subscribe(o=>{o.data&&(this.fichasectorial=o.data,this.filtro&&this.valor&&!this.check.TotalFilter&&(this.fichasectorial=this.fichasectorial.filter(a=>a[this.filtro]==this.valor)),this.check.TotalFilter&&(this.fichasectorial=this.fichasectorial.filter(a=>a.view)),this.load_lista=!1)},o=>{this.load_lista=!1,"InvalidToken"==o.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+o.status+")").toString(),detail:o.error.message||"Sin conexi\xf3n"})}),this.modal||this.helperservice.cerrarspinner("listar ficha sectorial")}llamarmodal2(){this.ref=this.dialogService.open(mn,{header:"",width:this.isMobil()?"100%":"70%"}),T.q.addListener("backButton",t=>{this.ref.close()})}llamarmodal(){this.ref=this.dialogService.open(Qi,{header:"",width:this.isMobil()?"100%":"70%"}),T.q.addListener("backButton",t=>{this.ref.close()})}stopPropagation(t){t.stopPropagation()}startResize(t){let i=0;t instanceof MouseEvent?i=t.clientY:t instanceof TouchEvent&&(i=t.touches[0].clientY);const o=s=>{let l=0;s instanceof MouseEvent?l=s.clientY:s instanceof TouchEvent&&(l=s.touches[0].clientY),this.height+=i-l,i=l},a=()=>{document.removeEventListener("mousemove",o),document.removeEventListener("touchmove",o),document.removeEventListener("mouseup",a),document.removeEventListener("touchend",a)};document.addEventListener("mousemove",o),document.addEventListener("touchmove",o),document.addEventListener("mouseup",a),document.addEventListener("touchend",a)}cerrarmodal(){}onTouchStart(t){this.initialTouchY=t.touches[0].clientY,this.isDragging=!0}onTouchMove(t){}onTouchEnd(){this.isDragging=!1}openModalimagen(t){this.imagenModal=t,this.imagenAMostrar=this.imagenModal[0]}updateImagenModal(t){this.imagenModal=t,this.imagenModalChange.emit(this.imagenModal)}openimagen(t){this.imagenModal=t,this.imagenAMostrar=this.imagenModal[0]}mostrarImagen(t){this.imagenAMostrar=this.imagenModal[t],document.querySelectorAll(".carousel-item").forEach((i,o)=>{o===t?i.classList.add("active"):i.classList.remove("active")})}editingrow(t){this.ref=this.dialogService.open(In,{header:"Editar Ficha Sectorial",width:this.isMobil()?"100%":"70%",data:{id:t}}),T.q.addListener("backButton",i=>{this.ref.close()})}eliminarModal(t){this.iddelete=t,this.visibledelete=!0}eliminarIncidente(){this.check.BorrarFichaSectorialComponent?this.deleteService.eliminarfichaSectorial(this.token,this.iddelete._id).subscribe(t=>{this.messageService.add({severity:"success",summary:"Eliminado",detail:t.message}),setTimeout(()=>{this.ref.close(),this.listarficha(),this.visible=!1,this.option=void 0},1e3)},t=>{this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})}):(this.iddelete.view=!1,this.iddelete.view_id=this.id,this.iddelete.view_date=new Date,this.updateService.actualizarActividadProyecto(this.token,this.iddelete._id,this.iddelete).subscribe(t=>{this.messageService.add({severity:"success",summary:"Eliminado",detail:t.message}),setTimeout(()=>{this.ref.close(),this.listarficha(),this.visible=!1,this.option=void 0},1e3)},t=>{console.error(t),this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})}))}showdialog(t){this.check.TotalFilter||(this.visible=!0,this.option=t)}navigateToFicha(t){this.router.navigate(["/ver-ficha",t])}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(f.Pw),e.rXU(x.Ix),e.rXU(S.a),e.rXU(k.w),e.rXU(u.bg),e.rXU(f.o3),e.rXU(Y.z),e.rXU(ue),e.rXU(P),e.rXU(F.u),e.rXU(K.E))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-ficha-sectorial"]],viewQuery:function(i,o){if(1&i&&e.GBs(yn,5),2&i){let a;e.mGM(a=e.lsd())&&(o.modalContent=a.first)}},inputs:{filtro:"filtro",valor:"valor",modal:"modal"},outputs:{imagenModalChange:"imagenModalChange"},features:[e.Jv_([u.bg]),e.OA$],decls:11,vars:19,consts:[["contentimage",""],["dt1",""],[4,"ngIf"],[3,"visibleChange","value","visible","responsiveOptions","containerStyle","numVisible","circular","fullScreen","showItemNavigators"],["pTemplate","item"],["pTemplate","thumbnail"],["header","Detalles de la Ficha Sectorial",3,"visibleChange","visible","modal"],["class","modal-body",4,"ngIf"],["header","Header",3,"visible","style","visibleChange",4,"ngIf"],[3,"header","modal","visible","position","style","maximizable","breakpoints","visibleChange",4,"ngIf"],["header","Header",3,"modal","visible","position","style","maximizable","breakpoints","visibleChange",4,"ngIf"],[3,"visibleChange","header","modal","visible","position","maximizable","breakpoints"],[1,"d-flex","flex-column","flex-sm-row","align-items-center","justify-content-center","gap-2"],[1,"col-auto"],[1,"flex","pt-4","justify-content-end"],["class","m-3","pButton","","label","Actividades","icon","pi pi-box",3,"click",4,"ngIf"],["class","m-3","pButton","","label","Estados","icon","pi pi-bell",3,"click",4,"ngIf"],["styleClass","p-datatable-striped","dataKey","_id","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","rows","showCurrentPageReport","rowsPerPageOptions","loading","paginator","globalFilterFields","sortMode"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pButton","","label","Actividades","icon","pi pi-box",1,"m-3",3,"click"],["pButton","","label","Estados","icon","pi pi-bell",1,"m-3",3,"click"],[1,"flex"],["pButton","","label","","icon","pi pi-filter-slash",1,"p-button-outlined",3,"click"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],["style","min-width: 15rem",4,"ngIf"],[2,"min-width","10rem"],[1,"flex","align-items-center"],["type","text","field","actividad.nombre","display","menu"],["pSortableColumn","actividad.nombre",2,"width","20%"],["field","actividad.nombre"],[2,"min-width","15rem"],["type","text","field","fecha_evento","display","menu"],["pSortableColumn","fecha_evento",2,"width","20%"],["field","fecha_evento"],["style","min-width: 10rem",4,"ngIf"],["type","text","field","estado.nombre","display","menu"],["pSortableColumn","estado.nombre",2,"width","20%"],["field","estado.nombre"],["type","text","field","direccion_geo","display","menu"],["pSortableColumn","direccion_geo",2,"width","20%"],["field","direccion_geo"],["type","text","field","encargado.name","display","menu"],["pSortableColumn","encargado.name",2,"width","20%"],["field","encargado.name"],[3,"click"],["class","pi pi-image","style","vertical-align: middle",3,"click",4,"ngIf"],[3,"value","severity"],[1,"pi","pi-image",2,"vertical-align","middle",3,"click"],["colspan","5"],["header","Header",3,"visibleChange","modal","visible","position","maximizable","breakpoints"],["styleClass","p-datatable-striped","dataKey","_id","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","rows","showCurrentPageReport","rowsPerPageOptions","loading","paginator"],[1,"col-12"],[1,"p-fluid","p-formgrid","grid"],[2,"min-width","8rem"],[1,"card"],[1,"card-header"],["class","flex pt-4 justify-content-end",4,"ngIf"],[1,"card-body"],["styleClass","p-datatable-striped","dataKey","_id","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","rows","showCurrentPageReport","rowsPerPageOptions","loading","paginator","globalFilterFields","sortMode",4,"ngIf"],["styleClass","p-datatable-striped","dataKey","_id","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","rows","showCurrentPageReport","rowsPerPageOptions","loading","paginator",4,"ngIf"],["pInputText","","type","text","placeholder","Search keyword",3,"input"],[2,"width","3rem"],["type","text","field","descripcion","display","menu"],["pSortableColumn","descripcion",2,"width","20%"],["field","descripcion"],[2,"min-width","2rem"],["type","text","field","mostrar_en_mapa","display","menu"],["pSortableColumn","mostrar_en_mapa",2,"width","5%"],["field","mostrar_en_mapa"],["class","navbar-brand-img mx-auto","style","\n                                    max-height: 4rem !important;\n                                    cursor: pointer;\n                                ","alt","...",3,"src","click",4,"ngIf"],[1,"pi","pi-circle-on"],["alt","...",1,"navbar-brand-img","mx-auto",2,"max-height","4rem !important","cursor","pointer",3,"click","src"],["id","fotoButton","icon","pi bi-camera2-custom","label","Ver",3,"raised","outlined","click",4,"ngIf"],["id","fotoButton","icon","pi bi-camera2-custom","label","Ver",3,"click","raised","outlined"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["id","carouselExample","data-bs-ride","carousel",1,"carousel","slide","carousel-fade"],[1,"carousel-indicators"],["type","button","data-bs-target","#carouselExample",3,"active",4,"ngFor","ngForOf"],[1,"carousel-inner",2,"height","70vh"],["class","carousel-item",3,"active",4,"ngFor","ngForOf"],["type","button","data-bs-target","#carouselExample","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExample","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"d-flex","justify-content-center","mt-3"],["class","m-1",4,"ngFor","ngForOf"],["type","button","data-bs-target","#carouselExample"],[1,"carousel-item"],["alt","Imagen",1,"d-block","w-100",3,"src"],[1,"m-1"],[1,"img-thumbnail",2,"cursor","pointer","max-width","100px","max-height","100px",3,"click","src"],[2,"width","100%","display","block",3,"src"],[1,"grid","grid-nogutter","justify-content-center"],[2,"width","30%",3,"src"],[1,"flex","justify-content-between"],[1,"justify-content-between"],["class","m-3","label","Fotos","icon","pi pi-images",3,"click",4,"ngIf"],[1,"justify-content-end"],["class","m-3","label","Editar","icon","pi pi-file-edit",3,"click",4,"ngIf"],["class","m-3","label","Borrar","icon","pi pi-images",3,"click",4,"ngIf"],["label","Fotos","icon","pi pi-images",1,"m-3",3,"click"],["label","Editar","icon","pi pi-file-edit",1,"m-3",3,"click"],["label","Borrar","icon","pi pi-images",1,"m-3",3,"click"],["header","Header",3,"visibleChange","visible"],[3,"linear"],["header","Pregunta"],["pTemplate","content"],["pTemplate","footer"],[1,"inline-flex","align-items-center","justify-content-center","gap-2"],[1,"font-bold","white-space-nowrap"],[1,"flex","flex-column","h-12rem"],[1,"border-2","border-dashed","surface-border","border-round","surface-ground","flex-auto","flex","justify-content-center","align-items-center","font-medium"],["severity","danger",3,"click"]],template:function(i,o){if(1&i){const a=e.RV6();e.nrm(0,"p-toast"),e.DNE(1,Zn,3,2,"ng-container",2)(2,Co,13,3,"ng-container",2)(3,ko,22,3,"ng-template",null,0,e.C5r),e.j41(5,"p-galleria",3),e.mxI("visibleChange",function(l){return e.eBV(a),e.DH7(o.displayBasic,l)||(o.displayBasic=l),e.Njj(l)}),e.DNE(6,Fo,1,1,"ng-template",4)(7,Eo,2,1,"ng-template",5),e.k0s(),e.j41(8,"p-dialog",6),e.mxI("visibleChange",function(l){return e.eBV(a),e.DH7(o.visible,l)||(o.visible=l),e.Njj(l)}),e.DNE(9,To,32,14,"div",7),e.k0s(),e.DNE(10,Go,6,5,"p-dialog",8)}2&i&&(e.R7$(),e.Y8G("ngIf",o.modal),e.R7$(),e.Y8G("ngIf",!o.modal),e.R7$(3),e.Y8G("value",o.imagenModal),e.R50("visible",o.displayBasic),e.Y8G("responsiveOptions",o.responsiveOptions)("containerStyle",e.lJ4(16,xn))("numVisible",9)("circular",!0)("fullScreen",!0)("showItemNavigators",!0),e.R7$(3),e.Aen(e.eq3(17,kn,o.isMobil()?"100%":"50vw")),e.R50("visible",o.visible),e.Y8G("modal",!1),e.R7$(),e.Y8G("ngIf",o.option),e.R7$(),e.Y8G("ngIf",o.iddelete))},dependencies:[b.Sq,b.bT,u.Ei,v._f,v.$n,E.y8,I.XI,I.Tg,I.yc,I.rl,ie.l,ge.v,ee.aQ,M.S,J.C1,J.ct,b.vh],styles:[".table-fixed[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1;background-color:#fff}.table-fixed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{position:relative;z-index:0}@media (max-width: 767px){.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:0rem 2px!important;position:relative}}@media (max-width: 767.98px){.main-panel[_ngcontent-%COMP%]   .main-content[_ngcontent-%COMP%]{bottom:70px!important;margin-top:0;padding:10px 0}}.custom-modal[_ngcontent-%COMP%]{z-index:1200!important}"]})}return n})();function Po(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"h2"),e.EFF(8,"Nuevo Estado de Incidente"),e.k0s()()()(),e.j41(9,"div",7),e.nrm(10,"p-toast"),e.j41(11,"div",8)(12,"form",9),e.bIt("ngSubmit",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.registrarEstadoIncidente())}),e.j41(13,"div",10)(14,"label",11),e.EFF(15,"Nombre"),e.k0s(),e.nrm(16,"input",12),e.k0s(),e.nrm(17,"button",13),e.k0s()()()()()(),e.bVm()}if(2&n){const t=e.XpG();e.R7$(12),e.Y8G("formGroup",t.estadoIncidenteForm)}}let zo=(()=>{class n{constructor(t,i,o,a,s,l,p){this.fb=t,this.createService=i,this.router=o,this.helper=a,this.messageService=s,this.listar=l,this.auth=p,this.model=!0,this.arr_status=[],this.token=this.auth.token(),this.estadoIncidenteForm=this.fb.group({nombre:["",c.k0.required],orden:[-1,Number]})}ngOnInit(){this.router.events.subscribe(t=>{this.model="/create-estado-incidente"!==this.router.url}),this.listarestados()}listarestados(){this.listar.listarEstadosIncidentes(this.token).subscribe(t=>{t.data&&(this.arr_status=t.data,this.estadoIncidenteForm.get("orden").setValue(this.arr_status.length+1))})}abrirModal(){this.model=!0}cerrarModal(){this.model=!1}registrarEstadoIncidente(){this.estadoIncidenteForm?.valid&&this.estadoIncidenteForm.value&&this.createService.registrarEstadoIncidente(this.token,this.estadoIncidenteForm.value).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Ingreso",detail:"Correcto"}),setTimeout(()=>{this.router.navigate(["/home"])},2e3))},t=>{console.error(t)})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.ok),e.rXU(U.m),e.rXU(x.Ix),e.rXU(k.w),e.rXU(u.bg),e.rXU(S.a),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-estado-incidente"]],features:[e.Jv_([u.bg])],decls:1,vars:1,consts:[[4,"ngIf"],[1,"main-content"],[1,"container-fluid"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-auto"],[1,"card-body"],[1,"table-responsive-sm"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","nombre",1,"form-label"],["type","text","pInputText","","id","nombre","name","nombre","formControlName","nombre","required",""],["pButton","","type","submit","icon","pi pi-save","label","Guardar"]],template:function(i,o){1&i&&e.DNE(0,Po,18,1,"ng-container",0),2&i&&e.Y8G("ngIf",o.model)},dependencies:[b.bT,v._f,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,M.S]})}return n})();const Xo=()=>({"min-width":"5rem"});function No(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",6)(1,"p-button",7),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.abrirSegundoModal())}),e.nrm(2,"i",8),e.EFF(3," Nuevo "),e.k0s()()}}function Ao(n,r){1&n&&(e.j41(0,"tr")(1,"th",14),e.EFF(2,"Nombre"),e.k0s(),e.j41(3,"th",14),e.EFF(4,"Orden"),e.k0s()())}function Bo(n,r){if(1&n){const t=e.RV6();e.j41(0,"input",18),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.nombre,o)||(a.nombre=o),e.Njj(o)}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.R50("ngModel",t.nombre)}}function Uo(n,r){if(1&n&&e.EFF(0),2&n){const t=e.XpG().$implicit;e.SpI(" ",t.nombre," ")}}function Lo(n,r){if(1&n){const t=e.RV6();e.j41(0,"input",18),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.orden,o)||(a.orden=o),e.Njj(o)}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.R50("ngModel",t.orden)}}function Oo(n,r){if(1&n&&e.EFF(0),2&n){const t=e.XpG().$implicit;e.SpI(" ",t.orden," ")}}function $o(n,r){1&n&&(e.j41(0,"tr",15)(1,"td")(2,"p-cellEditor"),e.DNE(3,Bo,1,1,"ng-template",16)(4,Uo,1,1,"ng-template",17),e.k0s()(),e.j41(5,"td")(6,"p-cellEditor"),e.DNE(7,Lo,1,1,"ng-template",16)(8,Oo,1,1,"ng-template",17),e.k0s()()()),2&n&&e.Y8G("pEditableRow",r.$implicit)}function Vo(n,r){1&n&&(e.j41(0,"div",19)(1,"h5",20),e.nrm(2,"span",21),e.k0s(),e.j41(3,"p",22),e.nrm(4,"span",23)(5,"span",24)(6,"span",24)(7,"span",21)(8,"span",25),e.k0s()())}function Yo(n,r){if(1&n&&(e.j41(0,"div",9)(1,"p-table",10),e.DNE(2,Ao,5,0,"ng-template",11)(3,$o,9,1,"ng-template",12),e.k0s(),e.DNE(4,Vo,9,0,"div",13),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("paginatorDropdownAppendTo","body")("value",t.incidentesDenuncias)("tableStyle",e.lJ4(4,Xo)),e.R7$(3),e.Y8G("ngIf",t.load_lista)}}let Ho=(()=>{class n{constructor(t,i,o,a,s,l,p,m){this.auth=t,this.ref=i,this.fb=o,this.listarService=a,this.router=s,this.helper=l,this.messageService=p,this.dialogService=m,this.incidentesDenuncias=[],this.model=!0,this.load_lista=!0,this.check={},this.token=this.auth.token()}ngOnInit(){this.check.CreateEstadoIncidenteComponent=this.helper.decryptData("CreateEstadoIncidenteComponent")||!1,this.router.events.subscribe(t=>{this.model="/estados-incidente"!==this.router.url}),this.listartEstados()}listartEstados(){this.load_lista=!0,this.listarService.listarEstadosIncidentes(this.token).subscribe(t=>{this.incidentesDenuncias=t.data,this.load_lista=!1},t=>{this.load_lista=!1,"InvalidToken"==t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})}isMobil(){return this.helper.isMobil()}abrirSegundoModal(){this.ref=this.dialogService.open(zo,{header:"",width:this.isMobil()?"100%":"70%"}),T.q.addListener("backButton",t=>{this.ref.close()})}abrirModal(){this.model=!0}cerrarModal(){this.model=!1}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.u),e.rXU(f.Pw),e.rXU(c.ok),e.rXU(S.a),e.rXU(x.Ix),e.rXU(k.w),e.rXU(u.bg),e.rXU(f.o3))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-estado-incidente"]],features:[e.Jv_([u.bg])],decls:9,vars:2,consts:[[1,"card-header"],[1,"row"],[1,"col-auto"],["class","col-6",4,"ngIf"],[1,"card-body"],["class","table-responsive-sm",4,"ngIf"],[1,"col-6"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-square-dotted"],[1,"table-responsive-sm"],["styleClass","p-datatable-striped","dataKey","_id","editMode","row","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",1,"table","table-sm","align-middle","table-striped","table-hover",3,"paginatorDropdownAppendTo","value","tableStyle"],["pTemplate","header"],["pTemplate","body"],["class","card-body","aria-hidden","true",4,"ngIf"],["scope","col"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],["pInputText","","type","text","required","",1,"form-control",3,"ngModelChange","ngModel"],["aria-hidden","true",1,"card-body"],[1,"card-title","placeholder-glow"],[1,"placeholder","col-6"],[1,"card-text","placeholder-glow"],[1,"placeholder","col-7"],[1,"placeholder","col-4"],[1,"placeholder","col-8"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),e.EFF(4,"Listado de Incidentes y Denuncias"),e.k0s()(),e.DNE(5,No,4,0,"div",3),e.k0s()(),e.j41(6,"div",4),e.nrm(7,"p-toast"),e.DNE(8,Yo,5,5,"div",5),e.k0s()),2&i&&(e.R7$(5),e.Y8G("ngIf",o.check.CreateEstadoIncidenteComponent),e.R7$(3),e.Y8G("ngIf",o.incidentesDenuncias.length>0&&!o.load_lista))},dependencies:[b.bT,u.Ei,v.$n,E.y8,c.me,c.BC,c.YS,c.vS,I.XI,I.c5,I.Xk,M.S]})}return n})();const Jo=()=>({"max-width":"850px"});function Wo(n,r){if(1&n&&(e.j41(0,"div",5)(1,"label",24),e.EFF(2,"Sub categorias"),e.k0s(),e.nrm(3,"p-dropdown",25),e.k0s()),2&n){let t;const i=e.XpG(2);e.R7$(3),e.Y8G("options",i.subcategorias)("placeholder",null==(t=i.incidencia.get("subcategoria").value)?null:t.nombre)}}function Zo(n,r){1&n&&(e.j41(0,"div",5)(1,"label",26),e.EFF(2,"Respuesta"),e.k0s(),e.nrm(3,"textarea",27),e.k0s())}function qo(n,r){1&n&&(e.j41(0,"label",26),e.EFF(1,"Imagenes Subdias"),e.k0s())}function Ko(n,r){if(1&n&&e.nrm(0,"img",31),2&n){const t=r.$implicit,i=e.XpG(3);e.Y8G("src",i.url+"obtener_imagen/incidentes_denuncia/"+t,e.B4B)}}function Qo(n,r){if(1&n&&(e.j41(0,"div",32),e.nrm(1,"img",33),e.k0s()),2&n){const t=r.$implicit,i=e.XpG(3);e.R7$(),e.Y8G("src",i.url+"obtener_imagen/incidentes_denuncia/"+t,e.B4B)}}function ea(n,r){if(1&n&&(e.j41(0,"p-galleria",28),e.DNE(1,Ko,1,1,"ng-template",29)(2,Qo,2,1,"ng-template",30),e.k0s()),2&n){const t=e.XpG(2);e.Y8G("value",t.imagenModal)("visible",!0)("responsiveOptions",t.responsiveOptions)("numVisible",9)("circular",!0)("showItemNavigators",!0)}}function ta(n,r){if(1&n&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.R7$(),e.Lme(" ",t.name," - ",t.size," bytes ")}}function ia(n,r){if(1&n&&(e.j41(0,"ul"),e.DNE(1,ta,2,2,"li",37),e.k0s()),2&n){const t=e.XpG(5);e.R7$(),e.Y8G("ngForOf",t.selectedFiles)}}function na(n,r){if(1&n&&e.DNE(0,ia,2,1,"ul",0),2&n){const t=e.XpG(4);e.Y8G("ngIf",t.selectedFiles.length)}}function oa(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",14)(1,"p-fileUpload",35),e.bIt("onUpload",function(o){e.eBV(t);const a=e.XpG(3);return e.Njj(a.onFilesSelected(o))}),e.DNE(2,na,1,1,"ng-template",36),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(),e.Y8G("multiple",!0)("maxFileSize",5e6)("fileLimit",5-t.selectedFiles.length)}}function aa(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",14)(1,"h4",38),e.EFF(2," A\xf1ade fotos: "),e.j41(3,"p-button",39),e.bIt("click",function(o){e.eBV(t);const a=e.XpG(3);return e.Njj(a.tomarFotoYEnviar(o))}),e.k0s()()()}2&n&&(e.R7$(3),e.Y8G("raised",!0)("outlined",!0))}function ra(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",43),e.bIt("click",function(){e.eBV(t);const o=e.XpG(4);return e.Njj(o.imageClick(0))}),e.k0s()}2&n&&e.Y8G("raised",!0)("outlined",!0)}function sa(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",44),e.bIt("onClick",function(){e.eBV(t);const o=e.XpG(4);return o.upload=!0,o.imagenesSeleccionadas=[],e.Njj(o.selectedFiles=[])}),e.k0s()}}function la(n,r){1&n&&e.nrm(0,"img",45),2&n&&e.Y8G("src",r.$implicit.itemImageSrc,e.B4B)}function ca(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",14),e.DNE(1,ra,1,2,"p-button",40)(2,sa,1,0,"p-button",41),e.j41(3,"p-galleria",42),e.mxI("visibleChange",function(o){e.eBV(t);const a=e.XpG(3);return e.DH7(a.displayCustom,o)||(a.displayCustom=o),e.Njj(o)})("activeIndexChange",function(o){e.eBV(t);const a=e.XpG(3);return e.DH7(a.activeIndex,o)||(a.activeIndex=o),e.Njj(o)}),e.DNE(4,la,1,1,"ng-template",29),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(),e.Y8G("ngIf",t.imagenesSeleccionadas.length>0),e.R7$(),e.Y8G("ngIf",t.imagenesSeleccionadas.length>0),e.R7$(),e.Y8G("value",t.imagenesSeleccionadas),e.R50("visible",t.displayCustom)("activeIndex",t.activeIndex),e.Y8G("responsiveOptions",t.responsiveOptions)("containerStyle",e.lJ4(12,Jo))("numVisible",7)("circular",!0)("fullScreen",!0)("showItemNavigators",!0)("showThumbnails",!1)}}function da(n,r){if(1&n&&(e.j41(0,"div",13)(1,"label",26),e.EFF(2,"Imagenes de Respuesta"),e.k0s(),e.DNE(3,oa,3,3,"div",34)(4,aa,4,2,"div",34)(5,ca,5,13,"div",34),e.k0s()),2&n){const t=e.XpG(2);e.R7$(3),e.Y8G("ngIf",!t.isMobil()&&t.upload),e.R7$(),e.Y8G("ngIf",t.isMobil()&&t.upload),e.R7$(),e.Y8G("ngIf",t.load_carrusel)}}function pa(n,r){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"form",1),e.bIt("ngSubmit",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.enviar())}),e.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"label",6),e.EFF(7,"Ciudadano"),e.k0s(),e.nrm(8,"p-dropdown",7),e.k0s(),e.j41(9,"div",5)(10,"label",8),e.EFF(11,"Direcci\xf3n Geogr\xe1fica"),e.k0s(),e.nrm(12,"p-dropdown",9),e.k0s(),e.j41(13,"div",5)(14,"label",10),e.EFF(15,"Categorias"),e.k0s(),e.j41(16,"p-dropdown",11),e.bIt("onChange",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.selectcategoria(!0))}),e.k0s()(),e.DNE(17,Wo,4,2,"div",12),e.k0s()(),e.j41(18,"div",13)(19,"div",5)(20,"div",14)(21,"label",15),e.EFF(22,"Estado"),e.k0s(),e.j41(23,"p-dropdown",16),e.bIt("onChange",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.newstatus())}),e.k0s()()(),e.j41(24,"div",5)(25,"label",17),e.EFF(26,"Descripci\xf3n"),e.k0s(),e.nrm(27,"textarea",18),e.k0s(),e.DNE(28,Zo,4,0,"div",12),e.k0s()(),e.j41(29,"div",2)(30,"div",3),e.DNE(31,qo,2,0,"label",19)(32,ea,3,6,"p-galleria",20),e.k0s(),e.DNE(33,da,6,3,"div",21),e.k0s(),e.j41(34,"div",22),e.nrm(35,"p-button",23),e.k0s()(),e.bVm()}if(2&n){let t,i,o,a,s,l;const p=e.XpG();e.R7$(),e.Y8G("formGroup",p.incidencia),e.R7$(7),e.Y8G("placeholder",null==(t=p.incidencia.get("ciudadano").value)?null:t.name),e.R7$(4),e.Y8G("placeholder",null==(i=p.incidencia.get("direccion_geo").value)?null:i.nombre),e.R7$(4),e.Y8G("options",p.categorias)("placeholder",null==(o=p.incidencia.get("categoria").value)?null:o.nombre),e.R7$(),e.Y8G("ngIf",p.subcategorias),e.R7$(6),e.Y8G("options",p.estados)("placeholder",null==(a=p.incidencia.get("estado").value)?null:a.nombre),e.R7$(5),e.Y8G("ngIf",(null==(s=p.incidencia.get("ciudadano").value)?null:s._id)!=p.id_user||p.check.EditIncidentesDenunciaComponent),e.R7$(3),e.Y8G("ngIf",p.imagenModal.length>0),e.R7$(),e.Y8G("ngIf",p.imagenModal.length>0),e.R7$(),e.Y8G("ngIf",((null==(l=p.incidencia.get("ciudadano").value)?null:l._id)!=p.id_user||p.check.EditIncidentesDenunciaComponent)&&p.load_imagen)}}function ma(n,r){1&n&&(e.qex(0),e.j41(1,"div",46)(2,"div",47)(3,"span",48),e.EFF(4,"Cargando..."),e.k0s()()(),e.bVm())}let ua=(()=>{class n{constructor(t,i,o,a,s,l,p,m,_,h,y){this.conf=t,this.helper=i,this.router=o,this.filter=a,this.fb=s,this.listService=l,this.admin=p,this.messageService=m,this.update=_,this.ref=h,this.auth=y,this.check={},this.token=this.auth.token(),this.load_form=!1,this.categorias=[],this.subcategorias=[],this.id_user=this.auth.idUserToken(this.token),this.imagenesSeleccionadas=[],this.imagenModal=[],this.url=V.M.url,this.upload=!0,this.responsiveOptions=[{breakpoint:"1024px",numVisible:5},{breakpoint:"768px",numVisible:3},{breakpoint:"560px",numVisible:1}],this.estados=[],this.load_imagen=!1,this.selectedFiles=[],this.load_carrusel=!1,this.activeIndex=0,this.incidencia=this.fb.group({direccion_geo:[{value:"",disabled:!0}],ciudadano:[{value:"",disabled:!0},c.k0.required],estado:[{value:"",disabled:!0},c.k0.required],categoria:[{value:"",disabled:!0},c.k0.required],subcategoria:[{value:"",disabled:!0},c.k0.required],descripcion:[{value:"",disabled:!0},c.k0.required],encargado:[{value:"",disabled:!0},c.k0.required],respuesta:[{value:"",disabled:!0},c.k0.required],evidencia:[[]],view:!0})}responsiveimage(){return(window.innerWidth-50).toString()}ngOnInit(){var t=this;return(0,g.A)(function*(){t.helper.llamarspinner("edit incidente");const i={EditIncidentesDenunciaComponent:t.auth.hasPermissionComponent("/incidentes_denuncia/:id","put"),EditIncidenteAll:t.auth.hasPermissionComponent("/incidentes_denuncia/:id","put"),ContestarIncidente:t.auth.hasPermissionComponent("/incidentes_denuncia/:id","put")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a;try{if(t.load_form=!1,!t.check.EditIncidentesDenunciaComponent)return void t.router.navigate(["/notfound"]);t.conf&&(t.id=t.conf.data.id,t.obtenerincidente(),t.listarCategorias(),t.listarEstados())}catch(s){console.error("Error en ngOnInit:",s),t.router.navigate(["/notfound"])}finally{t.helper.cerrarspinner("edit incidente")}});return function(a){return o.apply(this,arguments)}}())})()}obtenerincidente(){this.filter.obtenerIncidenteDenuncia(this.token,this.id).subscribe(t=>{if(t.data){const i=t.data;for(const o in i)if(Object.prototype.hasOwnProperty.call(i,o)){const a=i[o],s=this.incidencia.get(o);s&&(s.setValue(a),"categoria"==o&&this.selectcategoria(!1,a._id),(i.ciudadano._id!=this.id_user||this.check.EditIncidentesDenunciaComponent)&&"estado"==o&&this.habilitarCampos(o),i.ciudadano._id==this.id_user&&"descripcion"==o&&this.habilitarCampos(o))}i.foto&&(this.imagenModal=i.foto),this.load_form=!0}})}enviar(){(this.incidencia.get("ciudadano").value?._id!=this.id_user||this.edit)&&(this.incidencia.get("encargado").enable(),this.incidencia.get("encargado").setValue(this.id_user)),this.update.actualizarIncidenteDenuncia(this.token,this.id,this.incidencia.value).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Actualizado",detail:"Correctamente"}),setTimeout(()=>{this.ref.close(!0)},500))},t=>{console.error(t),"InvalidToken"==t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})}selectcategoria(t,i){i||(i=this.incidencia.get("categoria").value?._id),i&&this.listService.listarSubcategorias(this.token,"categoria",i).subscribe(a=>{this.subcategorias=a.data,t&&this.incidencia.get("subcategoria").setValue("")},a=>{"InvalidToken"==a.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+a.status+")").toString(),detail:a.error.message||"Sin conexi\xf3n"})})}listarCategorias(){var t=this;return(0,g.A)(function*(){t.listService.listarCategorias(t.token).subscribe(i=>{t.categorias=i.data},i=>{"InvalidToken"==i.error.message?t.router.navigate(["/auth/login"]):t.messageService.add({severity:"error",summary:("("+i.status+")").toString(),detail:i.error.message||"Sin conexi\xf3n"})})})()}listarEstados(){this.listService.listarEstadosIncidentes(this.token).subscribe(t=>{this.estados=t.data},t=>{"InvalidToken"==t.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:`(${t.status})`,detail:t.error.message||"Sin conexi\xf3n"})})}isMobil(){return this.helper.isMobil()}newstatus(){this.incidencia.get("estado").value?.orden>1?(this.habilitarCampos("respuesta"),this.load_imagen=!0):(this.deshabilitarCampo("respuesta"),this.load_imagen=!1)}deshabilitarCampo(t){this.incidencia.get(t)?.disable()}habilitarCampos(t){this.incidencia.get(t)?.enable()}tomarFotoYEnviar(t){var i=this;return(0,g.A)(function*(){i.upload=!0,i.mostrargale=!1;const o=yield z.i7.getPhoto({quality:90,allowEditing:!1,resultType:z.LK.Base64,source:z.ru.Prompt,promptLabelPhoto:"Seleccionar de la galer\xeda",promptLabelPicture:"Tomar foto"});if(o&&o.base64String&&i.selectedFiles.length<3){const a=atob(o.base64String),s=new Array(a.length);for(let y=0;y<a.length;y++)s[y]=a.charCodeAt(y);const l=new Uint8Array(s),p=new Blob([l],{type:"image/jpeg"});let m=new File([p],"prueba",{type:"image/jpeg"});i.selectedFiles.push(m);const _=i.incidencia.get("evidencia").value||[];i.incidencia.get("evidencia").setValue([..._,m]);const h=new FileReader;h.onload=y=>{i.imagenesSeleccionadas.push({itemImageSrc:y.target.result})},setTimeout(()=>{i.mostrargale=!0},1e3),h.readAsDataURL(m),i.load_carrusel=!0,5==i.selectedFiles.length&&(i.upload=!1)}else i.messageService.add({severity:"warning",summary:"MAX img",detail:"Solo puede enviar 3 imangenes"}),i.load_carrusel=!0})()}onFilesSelected(t){this.mostrargale=!1;for(let o of t.files){this.selectedFiles.push(o);const a=this.incidencia.get("evidencia").value||[];this.incidencia.get("evidencia").setValue([...a,o]);const s=URL.createObjectURL(o);this.imagenesSeleccionadas.push({itemImageSrc:s}),5==this.selectedFiles.length&&(this.upload=!1)}this.messageService.add({severity:"info",summary:"Excelente",detail:this.selectedFiles.length+"Imagenes subidas"}),this.mostrargale=!0,this.load_carrusel=!0}imageClick(t){this.activeIndex=t,this.displayCustom=!0}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(f.sb),e.rXU(k.w),e.rXU(x.Ix),e.rXU(K.E),e.rXU(c.ok),e.rXU(S.a),e.rXU(Y.z),e.rXU(u.bg),e.rXU(P),e.rXU(f.Pw),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-edit-incidentes-denuncia"]],decls:4,vars:2,consts:[[4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"flex","flex-wrap"],[1,"w-full","lg:w-6","p-4","lg:p-7","surface-card"],[1,"flex","flex-column","gap-2","mx-auto"],[1,"field","p-fluid"],["htmlFor","ciudadano"],["id","ciudadano","name","ciudadano","type","text","formControlName","ciudadano",3,"placeholder"],["htmlFor","direccion_geo"],["id","direccion_geo","name","direccion_geo","type","text","formControlName","direccion_geo",3,"placeholder"],["htmlFor","categoria"],["appendTo","body","id","categoria","name","categoria","formControlName","categoria","optionLabel","nombre",3,"onChange","options","placeholder"],["class","field p-fluid",4,"ngIf"],[1,"w-full","lg:w-6","p-4","lg:p-7"],[1,"mb-3"],["htmlFor","estado"],["appendTo","body","id","estado","name","estado","formControlName","estado","optionLabel","nombre",3,"onChange","options","placeholder"],["htmlFor","descripcion"],["rows","5","cols","25","pInputTextarea","","id","descripcion","name","descripcion","formControlName","descripcion","required",""],["htmlFor","respuesta",4,"ngIf"],[3,"value","visible","responsiveOptions","numVisible","circular","showItemNavigators",4,"ngIf"],["class","w-full lg:w-6 p-4 lg:p-7",4,"ngIf"],[1,"flex","justify-content-end"],["label","Registrar","type","submit","icon","bi bi-save"],["htmlFor","subcategoria"],["appendTo","body","id","subcategoria","name","subcategoria","formControlName","subcategoria","optionLabel","nombre",3,"options","placeholder"],["htmlFor","respuesta"],["rows","5","cols","25","pInputTextarea","","id","respuesta","name","respuesta","formControlName","respuesta",1,"form-control"],[3,"value","visible","responsiveOptions","numVisible","circular","showItemNavigators"],["pTemplate","item"],["pTemplate","thumbnail"],[2,"width","100%","display","block",3,"src"],[1,"grid","grid-nogutter","justify-content-center"],[2,"width","30%",3,"src"],["class","mb-3",4,"ngIf"],["chooseLabel","Seleccionar","uploadLabel","Cargar","cancelLabel","Cancelar","name","demo[]","url","https://www.primefaces.org/cdn/api/upload.php","accept","image/*","invalidFileLimitMessageSummary","Se super\xf3 el n\xfamero m\xe1ximo de archivos",3,"onUpload","multiple","maxFileSize","fileLimit"],["pTemplate","content"],[4,"ngFor","ngForOf"],["for","formFileMultiple",1,"form-label"],["id","fotoButton","icon","pi bi-camera2-custom","label","A\xf1adir nueva Foto",3,"click","raised","outlined"],["class","m-3","icon","pi bi-box-arrow-up-right","label","Ver Fotos",3,"raised","outlined","click",4,"ngIf"],["class","m-3","label","Borrar Fotos","severity","warning","icon","pi pi-trash",3,"onClick",4,"ngIf"],[3,"visibleChange","activeIndexChange","value","visible","activeIndex","responsiveOptions","containerStyle","numVisible","circular","fullScreen","showItemNavigators","showThumbnails"],["icon","pi bi-box-arrow-up-right","label","Ver Fotos",1,"m-3",3,"click","raised","outlined"],["label","Borrar Fotos","severity","warning","icon","pi pi-trash",1,"m-3",3,"onClick"],[2,"width","80%","display","block",3,"src"],[1,"text-center"],["role","status",1,"spinner-border","text-success"],[1,"visually-hidden"]],template:function(i,o){1&i&&(e.qex(0),e.nrm(1,"p-toast"),e.DNE(2,pa,36,12,"ng-container",0)(3,ma,5,0,"ng-container",0),e.bVm()),2&i&&(e.R7$(2),e.Y8G("ngIf",o.load_form),e.R7$(),e.Y8G("ngIf",!o.load_form))},dependencies:[b.Sq,b.bT,u.Ei,v.$n,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,ee.aQ,te.N,X.ms,H.Z]})}return n})();var Re=d(5201),De=d(351);const _a=["contentimage"],ga=()=>({width:"50vw","z-index":1e4}),ha=()=>({"1199px":"75vw","575px":"90vw"}),fa=()=>[10,25,50],ba=()=>["direccion_geo.nombre","categoria.nombre","subcategoria.nombre","ciudadano.name","estado.nombre"],va=()=>({"max-width":"50%"}),Ge=n=>({width:n}),Ca=()=>[10,25,50,100],Ia=()=>["_id","direccion_geo.nombre","categoria.nombre","subcategoria.nombre","ciudadano.name","estado.nombre"];function ya(n,r){if(1&n&&e.nrm(0,"p-tag",21),2&n){const t=e.XpG();e.Y8G("value",t.categoria)}}function xa(n,r){if(1&n&&e.nrm(0,"p-tag",22),2&n){const t=e.XpG();e.Y8G("value",t.subcategoria)}}function ka(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.llamarmodal())}),e.k0s()}}function Fa(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",24)(1,"button",25),e.bIt("click",function(){e.eBV(t);const o=e.XpG(),a=e.sdS(10);return e.Njj(o.clear(a))}),e.k0s(),e.j41(2,"p-toggleButton",26),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.balanceFrozen,o)||(a.balanceFrozen=o),e.Njj(o)}),e.k0s(),e.j41(3,"span",27),e.nrm(4,"i",28),e.j41(5,"input",29),e.bIt("input",function(o){e.eBV(t),e.XpG();const a=e.sdS(10);return e.Njj(a.filterGlobal(o.target.value,"contains"))}),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(2),e.R50("ngModel",t.balanceFrozen),e.Y8G("onIcon","pi pi-lock")}}function Ea(n,r){1&n&&(e.j41(0,"th",32)(1,"div",33),e.EFF(2," Direcci\xf3n "),e.nrm(3,"p-columnFilter",42),e.j41(4,"th",43),e.nrm(5,"p-sortIcon",44),e.k0s()()())}function Sa(n,r){if(1&n&&(e.j41(0,"tr")(1,"th",30),e.EFF(2,"#"),e.k0s(),e.DNE(3,Ea,6,0,"th",31),e.j41(4,"th",32)(5,"div",33),e.EFF(6," Categor\xeda "),e.nrm(7,"p-columnFilter",34),e.j41(8,"th",35),e.nrm(9,"p-sortIcon",36),e.k0s()()(),e.j41(10,"th",37)(11,"div",33),e.EFF(12," Estado "),e.nrm(13,"p-columnFilter",38),e.j41(14,"th",39),e.nrm(15,"p-sortIcon",40),e.k0s()()(),e.j41(16,"th",41)(17,"div",33),e.EFF(18,"Ir"),e.k0s()()()),2&n){const t=e.XpG();e.R7$(3),e.Y8G("ngIf",!t.valor),e.R7$(13),e.Y8G("frozen",t.balanceFrozen)}}function Ma(n,r){if(1&n&&(e.j41(0,"td"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.direccion_geo.nombre," ")}}function ja(n,r){if(1&n&&(e.j41(0,"td"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.categoria.nombre," ")}}function Ta(n,r){if(1&n&&(e.j41(0,"td"),e.nrm(1,"p-tag",50),e.k0s()),2&n){const t=e.XpG().$implicit,i=e.XpG();e.R7$(),e.Y8G("value",t.estado.nombre)("severity",i.getSeverity(t.estado.nombre))}}function wa(n,r){if(1&n){const t=e.RV6();e.j41(0,"tr",45),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG();return a.visible=!0,e.Njj(a.option=o)}),e.j41(1,"td",46),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.isMobil()&&o.openModal(o.modalContent))}),e.EFF(2),e.k0s(),e.DNE(3,Ma,2,1,"td",47)(4,ja,2,1,"td",47)(5,Ta,2,2,"td",47),e.j41(6,"td",48)(7,"p-button",49),e.bIt("click",function(o){const a=e.eBV(t).$implicit,s=e.XpG();return s.stopPropagation(o),e.Njj(s.marcarsitio(a.direccion_geo,a.categoria.nombre))}),e.k0s()()()}if(2&n){const t=r.$implicit,i=r.rowIndex,o=e.XpG();e.R7$(2),e.SpI(" ",i+1," "),e.R7$(),e.Y8G("ngIf",!o.valor),e.R7$(),e.Y8G("ngIf",t.categoria),e.R7$(),e.Y8G("ngIf",t.estado),e.R7$(),e.Y8G("frozen",o.balanceFrozen),e.R7$(),e.Y8G("text",!0)}}function Ra(n,r){1&n&&(e.j41(0,"tr")(1,"td",51),e.EFF(2,"No se encontraron incidentes."),e.k0s()())}function Da(n,r){if(1&n&&(e.qex(0),e.nrm(1,"p-chip",60),e.bVm()),2&n){const t=r.$implicit;e.R7$(),e.Y8G("label",t.categoria.nombre)}}function Ga(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",61),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.llamarmodal())}),e.k0s()}}function Pa(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",24)(1,"button",62),e.bIt("click",function(){e.eBV(t),e.XpG();const o=e.sdS(12),a=e.XpG();return e.Njj(a.clear(o))}),e.k0s(),e.j41(2,"span",27),e.nrm(3,"i",28),e.j41(4,"input",29),e.bIt("input",function(o){e.eBV(t),e.XpG();const a=e.sdS(12);return e.Njj(a.filterGlobal(o.target.value,"contains"))}),e.k0s()()()}}function za(n,r){1&n&&(e.j41(0,"th",64)(1,"div",33),e.EFF(2," Encargado "),e.nrm(3,"p-columnFilter",76),e.j41(4,"th",77),e.nrm(5,"p-sortIcon",78),e.k0s()()())}function Xa(n,r){if(1&n&&(e.j41(0,"tr")(1,"th",63),e.EFF(2,"#"),e.k0s(),e.j41(3,"th",64)(4,"div",33),e.EFF(5," Direcci\xf3n "),e.nrm(6,"p-columnFilter",42),e.j41(7,"th",43),e.nrm(8,"p-sortIcon",44),e.k0s()()(),e.j41(9,"th",64)(10,"div",33),e.EFF(11," Categor\xeda "),e.nrm(12,"p-columnFilter",34),e.j41(13,"th",35),e.nrm(14,"p-sortIcon",36),e.k0s()()(),e.j41(15,"th",64)(16,"div",33),e.EFF(17," Subcategor\xeda "),e.nrm(18,"p-columnFilter",65),e.j41(19,"th",66),e.nrm(20,"p-sortIcon",67),e.k0s()()(),e.j41(21,"th",64)(22,"div",33),e.EFF(23," Ciudadano "),e.nrm(24,"p-columnFilter",68),e.j41(25,"th",69),e.nrm(26,"p-sortIcon",70),e.k0s()()(),e.j41(27,"th",71)(28,"div",33),e.EFF(29," Estado "),e.nrm(30,"p-columnFilter",38),e.j41(31,"th",39),e.nrm(32,"p-sortIcon",40),e.k0s()()(),e.j41(33,"th",71)(34,"div",33),e.EFF(35," Fecha "),e.nrm(36,"p-columnFilter",72),e.j41(37,"th",73),e.nrm(38,"p-sortIcon",74),e.k0s()()(),e.j41(39,"th",64)(40,"div",33),e.EFF(41,"Foto"),e.k0s()(),e.DNE(42,za,6,0,"th",75),e.j41(43,"th",64)(44,"div",33),e.EFF(45,"Evidencias"),e.k0s()()()),2&n){const t=e.XpG(2);e.R7$(42),e.Y8G("ngIf",!t.isMobil()&&!t.check.TotalFilter)}}function Na(n,r){1&n&&(e.qex(0),e.EFF(1,"(Borrado)"),e.bVm())}function Aa(n,r){if(1&n&&(e.j41(0,"td"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.categoria.nombre," ")}}function Ba(n,r){if(1&n&&(e.j41(0,"td"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.subcategoria.nombre," ")}}function Ua(n,r){if(1&n&&(e.j41(0,"td"),e.nrm(1,"p-tag",50),e.k0s()),2&n){const t=e.XpG().$implicit,i=e.XpG(2);e.R7$(),e.Y8G("value",t.estado.nombre)("severity",i.getSeverity(t.estado.nombre,t.createdAt))}}function La(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.nI1(2,"date"),e.bVm()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.brH(2,1,t.createdAt,"medium","es")," ")}}function Oa(n,r){if(1&n){const t=e.RV6();e.j41(0,"img",80),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(2);return a.openModalimagen(o.foto),e.Njj(a.displayBasic=!0)}),e.k0s()}if(2&n){const t=e.XpG().$implicit,i=e.XpG(2);e.Y8G("src",i.url+"obtener_imagen/incidentes_denuncia/"+t.foto[0],e.B4B)}}function $a(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG(2).$implicit;e.R7$(),e.JRh(t.encargado.name)}}function Va(n,r){1&n&&(e.qex(0),e.EFF(1,"--"),e.bVm())}function Ya(n,r){if(1&n&&(e.j41(0,"td"),e.DNE(1,$a,2,1,"ng-container",47)(2,Va,2,0,"ng-container",47),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",t.encargado),e.R7$(),e.Y8G("ngIf",!t.encargado)}}function Ha(n,r){if(1&n){const t=e.RV6();e.j41(0,"img",80),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(2);return a.openModalimagen(o.evidencia),e.Njj(a.displayBasic=!0)}),e.k0s()}if(2&n){const t=e.XpG().$implicit,i=e.XpG(2);e.Y8G("src",i.url+"obtener_imagen/incidentes_denuncia/"+t.evidencia[0],e.B4B)}}function Ja(n,r){if(1&n){const t=e.RV6();e.j41(0,"tr",45),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG(2);return a.visible=!0,e.Njj(a.option=o)}),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.DNE(5,Na,2,0,"ng-container",47),e.k0s(),e.DNE(6,Aa,2,1,"td",47)(7,Ba,2,1,"td",47),e.j41(8,"td"),e.EFF(9),e.k0s(),e.DNE(10,Ua,2,2,"td",47),e.j41(11,"td"),e.DNE(12,La,3,5,"ng-container",47),e.k0s(),e.j41(13,"td",45),e.bIt("click",function(o){e.eBV(t);const a=e.XpG(2);return e.Njj(a.stopPropagation(o))}),e.DNE(14,Oa,1,1,"img",79),e.k0s(),e.DNE(15,Ya,3,2,"td",47),e.j41(16,"td",45),e.bIt("click",function(o){e.eBV(t);const a=e.XpG(2);return e.Njj(a.stopPropagation(o))}),e.DNE(17,Ha,1,1,"img",79),e.k0s()()}if(2&n){const t=r.$implicit,i=r.rowIndex,o=e.XpG(2);e.R7$(2),e.SpI(" ",i+1," "),e.R7$(2),e.SpI(" ",t.direccion_geo.nombre," "),e.R7$(),e.Y8G("ngIf",o.check.ViewIncidente&&0==t.view),e.R7$(),e.Y8G("ngIf",t.categoria),e.R7$(),e.Y8G("ngIf",t.subcategoria),e.R7$(2),e.SpI(" ",t.ciudadano.name," "),e.R7$(),e.Y8G("ngIf",t.estado),e.R7$(2),e.Y8G("ngIf",t.createdAt),e.R7$(2),e.Y8G("ngIf",t.foto.length>0),e.R7$(),e.Y8G("ngIf",!o.isMobil()&&!o.check.TotalFilter),e.R7$(2),e.Y8G("ngIf",t.evidencia.length>0)}}function Wa(n,r){1&n&&(e.j41(0,"tr")(1,"td",51),e.EFF(2,"No se encontraron incidentes."),e.k0s()())}function Za(n,r){if(1&n&&(e.j41(0,"div",52)(1,"div",53)(2,"div",54)(3,"div",55)(4,"div",4)(5,"h3"),e.EFF(6,"Listado de Incidente/Denuncia"),e.k0s(),e.DNE(7,Da,2,1,"ng-container",56),e.k0s(),e.j41(8,"div",7),e.DNE(9,Ga,1,0,"p-button",57),e.k0s()()()(),e.j41(10,"div",58)(11,"p-table",59,0),e.DNE(13,Pa,5,0,"ng-template",10)(14,Xa,46,1,"ng-template",11)(15,Ja,18,11,"ng-template",12)(16,Wa,3,0,"ng-template",13),e.k0s()()()),2&n){const t=e.XpG();e.R7$(7),e.Y8G("ngForOf",t.encargos),e.R7$(2),e.Y8G("ngIf",t.check.IndexEstadoIncidenteComponent),e.R7$(2),e.Y8G("paginatorDropdownAppendTo","body")("value",t.incidentesDenuncias)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.lJ4(11,Ca))("loading",t.load_lista)("paginator",!0)("globalFilterFields",e.lJ4(12,Ia))("sortMode","multiple")}}function qa(n,r){if(1&n&&e.nrm(0,"img",81),2&n){const t=r.$implicit,i=e.XpG();e.Y8G("src",i.url+"obtener_imagen/incidentes_denuncia/"+t,e.B4B)}}function Ka(n,r){if(1&n&&(e.j41(0,"div",82),e.nrm(1,"img",83),e.k0s()),2&n){const t=r.$implicit,i=e.XpG();e.R7$(),e.Y8G("src",i.url+"obtener_imagen/incidentes_denuncia/"+t,e.B4B)}}function Qa(n,r){if(1&n&&(e.j41(0,"p")(1,"strong"),e.EFF(2,"Categor\xeda:"),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.option.categoria.nombre," ")}}function er(n,r){if(1&n&&(e.j41(0,"p")(1,"strong"),e.EFF(2,"Subcategor\xeda:"),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG(2);e.R7$(3),e.SpI(" ",t.option.subcategoria.nombre," ")}}function tr(n,r){if(1&n&&e.nrm(0,"p-tag",50),2&n){const t=e.XpG(2);e.Y8G("value",t.option.estado.nombre)("severity",t.getSeverity(t.option.estado.nombre,t.option.createdAt))}}function ir(n,r){if(1&n&&(e.j41(0,"p")(1,"strong"),e.EFF(2,"Fecha:"),e.k0s(),e.EFF(3),e.nI1(4,"date"),e.k0s()),2&n){const t=e.XpG(2);e.R7$(3),e.SpI(" ",e.brH(4,1,t.option.createdAt,"medium","es")," ")}}function nr(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG(3);e.R7$(),e.JRh(t.option.encargado.name)}}function or(n,r){1&n&&(e.qex(0),e.EFF(1,"--"),e.bVm())}function ar(n,r){if(1&n&&(e.j41(0,"p")(1,"strong"),e.EFF(2,"Encargado:"),e.k0s(),e.DNE(3,nr,2,1,"ng-container",47)(4,or,2,0,"ng-container",47),e.k0s()),2&n){const t=e.XpG(2);e.R7$(3),e.Y8G("ngIf",t.option.encargado),e.R7$(),e.Y8G("ngIf",!t.option.encargado)}}function rr(n,r){if(1&n&&(e.qex(0),e.EFF(1),e.bVm()),2&n){const t=e.XpG(2);e.R7$(),e.JRh(t.option.respuesta)}}function sr(n,r){1&n&&(e.qex(0),e.EFF(1,"--"),e.bVm())}function lr(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",94),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return o.displayBasic=!0,e.Njj(o.openModalimagen(o.option.foto))}),e.k0s()}}function cr(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",95),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return o.displayBasic=!0,e.Njj(o.openModalimagen(o.option.evidencia))}),e.k0s()}}function dr(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",96),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.editar(!0))}),e.k0s()}2&n&&e.Y8G("label","Editar")}function pr(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",96),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.editar(!1))}),e.k0s()}2&n&&e.Y8G("label","Responder")}function mr(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",97),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.eliminarModal(o.option))}),e.k0s()}}function ur(n,r){if(1&n&&(e.j41(0,"div",84),e.DNE(1,Qa,4,1,"p",47)(2,er,4,1,"p",47),e.j41(3,"p")(4,"strong"),e.EFF(5,"Direcci\xf3n Geogr\xe1fica:"),e.k0s(),e.EFF(6),e.k0s(),e.j41(7,"p")(8,"strong"),e.EFF(9,"Estado:"),e.k0s(),e.DNE(10,tr,1,2,"p-tag",85),e.k0s(),e.DNE(11,ir,5,5,"p",47),e.j41(12,"p")(13,"strong"),e.EFF(14,"Ciudadano:"),e.k0s(),e.EFF(15),e.k0s(),e.j41(16,"p")(17,"strong"),e.EFF(18,"Descripci\xf3n:"),e.k0s(),e.EFF(19),e.k0s(),e.DNE(20,ar,5,2,"p",47),e.j41(21,"p")(22,"strong"),e.EFF(23,"Respuesta:"),e.k0s(),e.DNE(24,rr,2,1,"ng-container",47)(25,sr,2,0,"ng-container",47),e.k0s(),e.j41(26,"div",86)(27,"div",87),e.DNE(28,lr,1,0,"p-button",88),e.k0s(),e.j41(29,"div",89),e.DNE(30,cr,1,0,"p-button",90),e.k0s(),e.j41(31,"div",91),e.DNE(32,dr,1,1,"p-button",92)(33,pr,1,1,"p-button",92)(34,mr,1,0,"p-button",93),e.k0s()()()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.option.categoria),e.R7$(),e.Y8G("ngIf",t.option.subcategoria),e.R7$(4),e.SpI(" ",t.option.direccion_geo.nombre," "),e.R7$(4),e.Y8G("ngIf",t.option.estado),e.R7$(),e.Y8G("ngIf",t.option.createdAt),e.R7$(4),e.SpI(" ",t.option.ciudadano.name," "),e.R7$(4),e.SpI(" ",t.option.descripcion," "),e.R7$(),e.Y8G("ngIf",!t.check.TotalFilter),e.R7$(4),e.Y8G("ngIf",t.option.respuesta),e.R7$(),e.Y8G("ngIf",!t.option.respuesta),e.R7$(3),e.Y8G("ngIf",t.option.foto&&t.option.foto.length>0),e.R7$(2),e.Y8G("ngIf",t.option.evidencia&&t.option.evidencia.length>0),e.R7$(2),e.Y8G("ngIf",(t.option.estado&&2!=t.option.estado.orden&&t.check.EditIncidentesDenunciaComponent||t.check.ContestarIncidente)&&t.option._id==t.id),e.R7$(),e.Y8G("ngIf",t.option.estado&&2!=t.option.estado.orden&&t.check.EditIncidentesDenunciaComponent),e.R7$(),e.Y8G("ngIf",t.option.estado&&1==t.option.estado.orden||1==t.check.BorrarIncidente)}}function _r(n,r){if(1&n&&(e.j41(0,"div",103)(1,"span",104),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI(" Confirmar Eliminaci\xf3n: ",t.iddelete.nombre,"")}}function gr(n,r){1&n&&(e.j41(0,"div",105)(1,"div",106)(2,"p"),e.EFF(3,"\xbfEst\xe1s seguro que deseas eliminar este Incidente?"),e.k0s()()())}function hr(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-button",107),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.visibledelete=!1)}),e.EFF(1," Cancelar "),e.k0s(),e.j41(2,"p-button",45),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return o.eliminarIncidente(),e.Njj(o.visibledelete=!1)}),e.EFF(3," Eliminar "),e.k0s()}}function fr(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-dialog",98),e.mxI("visibleChange",function(o){e.eBV(t);const a=e.XpG();return e.DH7(a.visibledelete,o)||(a.visibledelete=o),e.Njj(o)}),e.DNE(1,_r,3,1,"ng-template",11),e.j41(2,"p-stepper",99)(3,"p-stepperPanel",100),e.DNE(4,gr,4,0,"ng-template",101),e.k0s()(),e.DNE(5,hr,4,0,"ng-template",102),e.k0s()}if(2&n){const t=e.XpG();e.Aen(e.eq3(4,Ge,t.isMobil()?"100%":"30vw")),e.R50("visible",t.visibledelete),e.R7$(2),e.Y8G("linear",!0)}}let he=(()=>{class n{constructor(t,i,o,a,s,l,p,m,_,h,y,G){this.ref=t,this.router=i,this.route=o,this.listService=a,this.modalService=s,this.helperservice=l,this.messageService=p,this.dialogService=m,this.admin=_,this.deleteser=h,this.updateService=y,this.auth=G,this.url=V.M.url,this.load_lista=!0,this.modal=!1,this.width=200,this.height=200,this.isResizing=!1,this.initialTouchY=0,this.isDragging=!1,this.checkstatus=["danger","warning","danger","success"],this.incidentesDenuncias=[],this.check={},this.token=this.auth.token(),this.id=this.auth.idUserToken(this.token),this.encargos=[],this.itemh=[],this.loadpath=!1,this.visible=!1,this.balanceFrozen=!0,this.imagenModal=[],this.displayBasic=!1,this.responsiveOptions=[{breakpoint:"1500px",numVisible:5},{breakpoint:"1024px",numVisible:3},{breakpoint:"768px",numVisible:2},{breakpoint:"560px",numVisible:1}],this.iddelete="",this.visibledelete=!1}deshabilitarMapaDesdeIndexFichaSectorial(t){this.stopPropagation(t),this.helperservice.deshabilitarMapa()}stopPropagation(t){t.stopPropagation()}startResize(t){let i=0;t instanceof MouseEvent?i=t.clientY:t instanceof TouchEvent&&(i=t.touches[0].clientY);const o=s=>{let l=0;s instanceof MouseEvent?l=s.clientY:s instanceof TouchEvent&&(l=s.touches[0].clientY),this.height+=i-l,i=l},a=()=>{document.removeEventListener("mousemove",o),document.removeEventListener("touchmove",o),document.removeEventListener("mouseup",a),document.removeEventListener("touchend",a)};document.addEventListener("mousemove",o),document.addEventListener("touchmove",o),document.addEventListener("mouseup",a),document.addEventListener("touchend",a)}get vermodal(){return!!this.modal&&this.modal}set vermodal(t){this.helperservice.cerrarincidente()}onTouchStart(t){this.initialTouchY=t.touches[0].clientY,this.isDragging=!0}onTouchMove(t){}onTouchEnd(){this.isDragging=!1}isMobil(){return this.helperservice.isMobil()}ngOnInit(){var t=this;return(0,g.A)(function*(){t.modal||t.helperservice.llamarspinner("init index incidente");const i={IndexIncidentesDenunciaComponent:yield t.auth.hasPermissionComponent("/incidentes_denuncia","get"),IndexEstadoIncidenteComponent:yield t.auth.hasPermissionComponent("/estado_incidente","get"),TotalFilterIncidente:yield t.auth.hasPermissionComponent("mostra_todas_incidente","get"),EditIncidentesDenunciaComponent:yield t.auth.hasPermissionComponent("/incidentes_denuncia/:id","put"),BorrarIncidente:yield t.auth.hasPermissionComponent("/incidentes_denuncia/:id","delete"),ViewIncidente:yield t.auth.hasPermissionComponent("/incidentes_denuncia","get"),ContestarIncidente:yield t.auth.hasPermissionComponent("/incidentes_denuncia/:id","put"),TotalFilter:yield t.auth.hasPermissionComponent("mostra_todas_incidente","get")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a;try{if(!t.check.IndexIncidentesDenunciaComponent)return void t.router.navigate(["/notfound"]);yield t.buscarencargos()}catch(s){console.error("Error en ngOnInit:",s),t.router.navigate(["/notfound"])}finally{setTimeout(()=>{t.modal||t.helperservice.cerrarspinner("init index incidente")},1e3)}});return function(a){return o.apply(this,arguments)}}())})()}buscarencargos(){var t=this;return(0,g.A)(function*(){t.listService.listarEncargadosCategorias(t.token,{encargado:t.id}).subscribe(i=>{i.data&&(t.encargos=i.data),t.listarIncidentesDenuncias()})})()}listarIncidentesDenuncias(){this.itemh=[],this.loadpath=!1,this.load_lista=!0;let t=[],i=[];this.filtro&&this.valor&&(t.push(this.filtro),i.push(this.valor),this.itemh.push({label:this.valor})),!this.check.TotalFilterIncidente&&0==this.encargos.length&&(t.push("ciudadano"),i.push(this.id)),this.listService.listarIncidentesDenuncias(this.token,this.helperservice.construirFiltros(t,i)).subscribe(o=>{if(o.data){if(this.incidentesDenuncias=o.data,this.filtro&&this.valor&&!this.check.TotalFilterIncidente){const[a,s]=this.filtro.split(".");this.incidentesDenuncias=this.incidentesDenuncias.filter(l=>{if(s){if(l[a][s]==this.valor)return l}else if(l[a]==this.valor)return l})}!this.check.TotalFilterIncidente&&this.encargos.length>0&&(this.incidentesDenuncias=this.incidentesDenuncias.filter(a=>this.encargos.find(s=>s.categoria._id===a.categoria._id||a.ciudadano._id==this.id))),this.categoria&&(this.itemh.push({label:this.categoria}),this.incidentesDenuncias=this.incidentesDenuncias.filter(a=>a.categoria.nombre===this.categoria)),this.subcategoria&&(this.itemh.push({label:this.subcategoria}),this.incidentesDenuncias=this.incidentesDenuncias.filter(a=>a.subcategoria.nombre===this.subcategoria)),this.encargos.length>0&&this.encargos.forEach(a=>{a.categoria&&(this.itemh.push({label:a.categoria.nombre}),this.incidentesDenuncias=this.incidentesDenuncias.filter(s=>s.categoria.nombre===a.categoria.nombre||s.ciudadano._id===this.id))}),this.check.ViewIncidente||(this.incidentesDenuncias=this.incidentesDenuncias.filter(a=>1==a.view)),this.load_lista=!1,this.loadpath=!0,this.route.paramMap.subscribe(a=>{const s=a.get("id");s&&(this.option=this.incidentesDenuncias.find(l=>l._id==s),this.option?this.visible=!0:this.messageService.add({severity:"error",summary:"ERROR",detail:"Incidente no encontrado"}))}),console.log(this.incidentesDenuncias)}},o=>{this.load_lista=!1,"InvalidToken"==o.error.message?this.router.navigate(["/auth/login"]):this.messageService.add({severity:"error",summary:("("+o.status+")").toString(),detail:o.error.message||"Sin conexi\xf3n"})})}llamarmodal(){this.ref=this.dialogService.open(Ho,{header:"",dismissableMask:!0,width:this.isMobil()?"100%":"70%"}),T.q.addListener("backButton",t=>{this.ref.close()})}editar(t){let i=t;this.encargos.find(o=>o.categoria._id==this.option.categoria._id)&&(i=!0),this.ref=this.dialogService.open(ua,{header:"Editar Incidente",dismissableMask:!0,width:this.isMobil()?"100%":"70%",data:{id:this.option._id,edit:i}}),this.ref.onClose.subscribe(o=>{o&&(this.messageService.add({severity:"info",summary:"Actualizando",detail:"Recargando pagina"}),this.listarIncidentesDenuncias())}),T.q.addListener("backButton",o=>{this.ref.close()})}ngOnChanges(t){(t.filtro||t.valor)&&(this.listarIncidentesDenuncias(),this.height=300)}irMap(t,i){i.stopPropagation();const o=document.getElementById("card-ficha");o&&(o.addEventListener("touchend",this.onTouchEnd.bind(this)),o.addEventListener("mouseup",this.onTouchEnd.bind(this)))}openModal(t){this.modalService.open(t,{ariaLabelledBy:"modal-basic-title"})}openModalimagen(t){this.imagenModal=t,this.imagenAMostrar=this.imagenModal[0]}mostrarImagen(t){this.imagenAMostrar=this.imagenModal[t],document.querySelectorAll(".carousel-item").forEach((i,o)=>{o===t?i.classList.add("active"):i.classList.remove("active")})}marcarsitio(t,i){this.helperservice.marcarLugar(t.latitud,t.longitud,i)}clear(t){t.clear()}getSeverity(t,i){switch(t.toLowerCase()){case"suspendido":return"danger";case"finalizado":case"en proceso":default:return"success";case"pendiente":let o=new Date(i);return o.setDate(o.getDate()+3),o.getTime()<=(new Date).getTime()?"danger":"warning";case"planificada":return"info"}}eliminarModal(t){this.iddelete=t,this.visibledelete=!0}eliminarIncidente(){this.iddelete&&(this.id==this.iddelete.ciudadano._id||this.check.BorrarIncidente?this.deleteser.eliminarIncidenteDenuncia(this.token,this.iddelete._id).subscribe(t=>{t&&(this.messageService.add({severity:"success",summary:"Eliminado",detail:t.message}),setTimeout(()=>{this.ref.close(),this.listarIncidentesDenuncias(),this.visible=!1,this.option=null,this.iddelete=null},1500))},t=>{console.error(t),this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})}):(this.iddelete.view=!1,this.iddelete.view_id=this.id,this.iddelete.view_date=new Date,delete this.iddelete.direccion_geo,this.updateService.actualizarIncidenteDenuncia(this.token,this.iddelete._id,this.iddelete).subscribe(t=>{this.messageService.add({severity:"success",summary:"Eliminado",detail:t.message}),setTimeout(()=>{this.ref.close(),this.listarIncidentesDenuncias(),this.visible=!1,this.option=void 0},1e3)},t=>{console.error(t),this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})))}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(f.Pw),e.rXU(x.Ix),e.rXU(x.nX),e.rXU(S.a),e.rXU(L.Bq),e.rXU(k.w),e.rXU(u.bg),e.rXU(f.o3),e.rXU(Y.z),e.rXU(ue),e.rXU(P),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-incidentes-denuncia"]],viewQuery:function(i,o){if(1&i&&e.GBs(_a,5),2&i){let a;e.mGM(a=e.lsd())&&(o.modalContent=a.first)}},inputs:{filtro:"filtro",valor:"valor",modal:"modal",categoria:"categoria",subcategoria:"subcategoria"},features:[e.Jv_([u.bg]),e.OA$],decls:22,vars:43,consts:[["dt1",""],[3,"visibleChange","header","modal","visible","position","maximizable","breakpoints"],[1,"d-flex","flex-column","flex-sm-row","align-items-center","justify-content-center","gap-2",2,"margin-top","15px"],[1,"col-auto"],[1,"p-fluid","p-formgrid","grid"],["icon","pi pi-check","severity","success","class","ml-3",3,"value",4,"ngIf"],["icon","pi pi-info-circle","severity","info","class","ml-2",3,"value",4,"ngIf"],[1,"flex","pt-4","justify-content-end"],["class","m-3","pButton","","label","Estados","icon","pi pi-bell",3,"click",4,"ngIf"],["styleClass","p-datatable-striped","dataKey","_id","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros","scrollHeight","650px",3,"paginatorDropdownAppendTo","value","rows","showCurrentPageReport","rowsPerPageOptions","loading","paginator","globalFilterFields","sortMode","scrollable"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","card",4,"ngIf"],[3,"visibleChange","value","visible","responsiveOptions","containerStyle","numVisible","circular","fullScreen","showItemNavigators"],["pTemplate","item"],["pTemplate","thumbnail"],["header","Detalles de la Incidencia",3,"visibleChange","visible","modal"],["class","modal-body",4,"ngIf"],["header","Header",3,"visible","style","visibleChange",4,"ngIf"],["icon","pi pi-check","severity","success",1,"ml-3",3,"value"],["icon","pi pi-info-circle","severity","info",1,"ml-2",3,"value"],["pButton","","label","Estados","icon","pi pi-bell",1,"m-3",3,"click"],[1,"flex"],["pButton","","label","","icon","pi pi-filter-slash",1,"p-button-outlined",3,"click"],["offIcon","pi pi-lock-open","offLabel","",3,"ngModelChange","ngModel","onIcon","onLabel"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],["pFrozenColumn","",2,"width","3rem"],["style","min-width: 4rem",4,"ngIf"],[2,"min-width","4rem"],[1,"flex","align-items-center"],["type","text","field","categoria.nombre","display","menu"],["pSortableColumn","categoria.nombre",2,"width","20%"],["field","categoria.nombre"],[2,"min-width","3rem"],["type","text","field","estado.nombre","display","menu"],["pSortableColumn","estado.nombre",2,"width","20%"],["field","estado.nombre"],["alignFrozen","right","pFrozenColumn","",2,"min-width","2rem",3,"frozen"],["type","text","field","direccion_geo.nombre","display","menu"],["pSortableColumn","direccion_geo.nombre",2,"width","20%"],["field","direccion_geo.nombre"],[3,"click"],["pFrozenColumn","",3,"click"],[4,"ngIf"],["alignFrozen","right","pFrozenColumn","",3,"frozen"],["icon","pi pi-external-link",3,"click","text"],[3,"value","severity"],["colspan","5"],[1,"card"],[1,"card-header"],[1,"d-flex","flex-column","flex-sm-row","align-items-center","justify-content-center","gap-2"],[1,"col-12"],[4,"ngFor","ngForOf"],["class","m-3","label","Estados","icon","pi pi-bell",3,"click",4,"ngIf"],[1,"card-body"],["styleClass","p-datatable-striped","dataKey","_id","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","rows","showCurrentPageReport","rowsPerPageOptions","loading","paginator","globalFilterFields","sortMode"],[3,"label"],["label","Estados","icon","pi pi-bell",1,"m-3",3,"click"],["pButton","","label","Limpiar","icon","pi pi-filter-slash",1,"p-button-outlined",3,"click"],[2,"width","3rem"],[2,"min-width","10rem"],["type","text","field","subcategoria.nombre","display","menu"],["pSortableColumn","subcategoria.nombre",2,"width","20%"],["field","subcategoria.nombre"],["type","text","field","ciudadano.name","display","menu"],["pSortableColumn","ciudadano.name",2,"width","20%"],["field","ciudadano.name"],[2,"min-width","7rem"],["type","date","field","createdAt","display","menu"],["pSortableColumn","createdAt",2,"width","20%"],["field","createdAt"],["style","min-width: 10rem",4,"ngIf"],["type","text","field","encargado.name","display","menu"],["pSortableColumn","encargado.name",2,"width","20%"],["field","encargado.name"],["class","navbar-brand-img mx-auto","style","max-height: 4rem !important; cursor: pointer","alt","...",3,"src","click",4,"ngIf"],["alt","...",1,"navbar-brand-img","mx-auto",2,"max-height","4rem !important","cursor","pointer",3,"click","src"],[2,"width","100%","display","block",3,"src"],[1,"grid","grid-nogutter","justify-content-center"],[2,"width","30%",3,"src"],[1,"modal-body"],[3,"value","severity",4,"ngIf"],[1,"flex","justify-content-between"],[1,"justify-content-between"],["class","m-3","label","Fotos","icon","pi pi-images",3,"click",4,"ngIf"],[1,"justify-content-center"],["class","m-3","label","Evidencias","icon","pi pi-images",3,"click",4,"ngIf"],[1,"justify-content-end"],["class","m-3","icon","pi pi-file-edit",3,"label","click",4,"ngIf"],["class","m-3","label","Borrar","icon","pi pi-images",3,"click",4,"ngIf"],["label","Fotos","icon","pi pi-images",1,"m-3",3,"click"],["label","Evidencias","icon","pi pi-images",1,"m-3",3,"click"],["icon","pi pi-file-edit",1,"m-3",3,"click","label"],["label","Borrar","icon","pi pi-images",1,"m-3",3,"click"],["header","Header",3,"visibleChange","visible"],[3,"linear"],["header","Pregunta"],["pTemplate","content"],["pTemplate","footer"],[1,"inline-flex","align-items-center","justify-content-center","gap-2"],[1,"font-bold","white-space-nowrap"],[1,"flex","flex-column","h-12rem"],[1,"border-2","border-dashed","surface-border","border-round","surface-ground","flex-auto","flex","justify-content-center","align-items-center","font-medium"],["severity","danger",3,"click"]],template:function(i,o){if(1&i){const a=e.RV6();e.nrm(0,"p-toast"),e.j41(1,"p-dialog",1),e.mxI("visibleChange",function(l){return e.eBV(a),e.DH7(o.vermodal,l)||(o.vermodal=l),e.Njj(l)}),e.j41(2,"div",2)(3,"div",3)(4,"div",4),e.DNE(5,ya,1,1,"p-tag",5)(6,xa,1,1,"p-tag",6),e.k0s(),e.j41(7,"div",7),e.DNE(8,ka,1,0,"button",8),e.k0s()()(),e.j41(9,"p-table",9,0),e.DNE(11,Fa,6,2,"ng-template",10)(12,Sa,19,2,"ng-template",11)(13,wa,8,6,"ng-template",12)(14,Ra,3,0,"ng-template",13),e.k0s()(),e.DNE(15,Za,17,13,"div",14),e.j41(16,"p-galleria",15),e.mxI("visibleChange",function(l){return e.eBV(a),e.DH7(o.displayBasic,l)||(o.displayBasic=l),e.Njj(l)}),e.DNE(17,qa,1,1,"ng-template",16)(18,Ka,2,1,"ng-template",17),e.k0s(),e.j41(19,"p-dialog",18),e.mxI("visibleChange",function(l){return e.eBV(a),e.DH7(o.visible,l)||(o.visible=l),e.Njj(l)}),e.DNE(20,ur,35,15,"div",19),e.k0s(),e.DNE(21,fr,6,6,"p-dialog",20)}2&i&&(e.R7$(),e.Aen(e.lJ4(36,ga)),e.Y8G("header",o.valor?"Listado de Incidentes: "+o.valor:"Listado de Incidentes")("modal",!1),e.R50("visible",o.vermodal),e.Y8G("position","bottom")("maximizable",!0)("breakpoints",e.lJ4(37,ha)),e.R7$(4),e.Y8G("ngIf",o.categoria),e.R7$(),e.Y8G("ngIf",o.subcategoria),e.R7$(2),e.Y8G("ngIf",o.check.IndexEstadoIncidenteComponent),e.R7$(),e.Y8G("paginatorDropdownAppendTo","body")("value",o.incidentesDenuncias)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.lJ4(38,fa))("loading",o.load_lista)("paginator",!0)("globalFilterFields",e.lJ4(39,ba))("sortMode","multiple")("scrollable",!0),e.R7$(6),e.Y8G("ngIf",0==o.modal),e.R7$(),e.Y8G("value",o.imagenModal),e.R50("visible",o.displayBasic),e.Y8G("responsiveOptions",o.responsiveOptions)("containerStyle",e.lJ4(40,va))("numVisible",9)("circular",!0)("fullScreen",!0)("showItemNavigators",!0),e.R7$(3),e.Aen(e.eq3(41,Ge,o.isMobil()?"100%":"40vw")),e.R50("visible",o.visible),e.Y8G("modal",!1),e.R7$(),e.Y8G("ngIf",o.option),e.R7$(),e.Y8G("ngIf",o.iddelete))},dependencies:[b.Sq,b.bT,u.Ei,v._f,v.$n,E.y8,c.BC,c.vS,I.XI,I.Tg,I.du,I.yc,I.rl,ie.l,ge.v,ee.aQ,M.S,J.C1,J.ct,Re.v,De.ff,b.vh],styles:[".table-fixed[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1;background-color:#fff}.table-fixed[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{position:relative;z-index:0}@media (max-width: 767px){.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:0rem 2px!important;position:relative}}@media (max-width: 767.98px){.main-panel[_ngcontent-%COMP%]   .main-content[_ngcontent-%COMP%]{bottom:70px!important;margin-top:0;padding:10px 0}}.custom-modal[_ngcontent-%COMP%]{z-index:1200!important}"]})}return n})();function br(n,r){if(1&n&&(e.j41(0,"div",18),e.nrm(1,"img",19),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("src",t.categoriaForm.value.icono,e.B4B)}}let vr=(()=>{class n{constructor(t,i,o,a,s,l){this.fb=t,this.createService=i,this.router=o,this.helper=a,this.messageService=s,this.auth=l,this.check={},this.categoriaForm=this.fb.group({nombre:["",c.k0.required],icono:["",c.k0.required],descripcion:["",c.k0.required]})}ngOnInit(){var t=this;return(0,g.A)(function*(){const i={CreateCategoriaComponent:yield t.auth.hasPermissionComponent("/categoria","post")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a,t.check.CreateCategoriaComponent||t.router.navigate(["/notfound"])});return function(a){return o.apply(this,arguments)}}())})()}registrarCategoria(){if(this.categoriaForm.valid){const t=this.auth.token();this.createService.registrarCategoria(t,{nombre:this.categoriaForm.value.nombre,descripcion:this.categoriaForm.value.descripcion,icono:this.categoriaForm.value.icono}).subscribe(o=>{o.data&&(this.messageService.add({severity:"success",summary:"Listo",detail:"Ingresado correctamente"}),setTimeout(()=>{this.router.navigate(["/maps/categoria"])},2e3))})}}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.ok),e.rXU(U.m),e.rXU(x.Ix),e.rXU(k.w),e.rXU(u.bg),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-categoria"]],features:[e.Jv_([u.bg])],decls:26,vars:2,consts:[[1,"card"],[1,"card-header"],[1,"row"],[1,"col-auto"],[1,"card-body"],[1,"table-responsive-sm"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6"],["for","nombre",1,"form-label"],["type","text","pInputText","","id","nombre","name","nombre","formControlName","nombre","required","",1,"form-control"],["for","icono",1,"form-label"],["type","text","pInputText","","id","icono","name","icono","formControlName","icono","required","",1,"form-control"],["for","descripcion",1,"form-label"],["pInputTextarea","","id","descripcion","name","descripcion","formControlName","descripcion","required","",1,"form-control"],["class","field col-12 md:col-6","style","\n                            display: flex;\n                            flex-wrap: nowrap;\n                            align-items: center;\n                            justify-content: space-around;\n                        ",4,"ngIf"],["type","submit","pButton","","label","Guardar",1,"btn","btn-primary"],[1,"bi","bi-save"],[1,"field","col-12","md:col-6",2,"display","flex","flex-wrap","nowrap","align-items","center","justify-content","space-around"],["alt","",2,"max-width","150px","width","auto",3,"src"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),e.EFF(5,"Nueva Categor\xeda"),e.k0s()()()(),e.j41(6,"div",4),e.nrm(7,"p-toast"),e.j41(8,"div",5)(9,"form",6),e.bIt("ngSubmit",function(){return o.registrarCategoria()}),e.j41(10,"div",7)(11,"div",8)(12,"label",9),e.EFF(13,"Nombre"),e.k0s(),e.nrm(14,"input",10),e.k0s(),e.j41(15,"div",8)(16,"label",11),e.EFF(17,"URL de icono"),e.k0s(),e.nrm(18,"input",12),e.k0s(),e.j41(19,"div",8)(20,"label",13),e.EFF(21,"Descripci\xf3n"),e.k0s(),e.nrm(22,"textarea",14),e.k0s(),e.DNE(23,br,2,1,"div",15),e.k0s(),e.j41(24,"button",16),e.nrm(25,"i",17),e.k0s()()()()()),2&i&&(e.R7$(9),e.Y8G("formGroup",o.categoriaForm),e.R7$(14),e.Y8G("ngIf",o.categoriaForm.value.icono))},dependencies:[b.bT,v._f,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,M.S,H.Z]})}return n})();var le=d(3009);function Cr(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI(": ",t.subcategorias[0].categoria.nombre,"")}}function Ir(n,r){1&n&&(e.j41(0,"tr")(1,"th",11),e.EFF(2,"Nombre"),e.k0s(),e.j41(3,"th",11),e.EFF(4,"Descripci\xf3n"),e.k0s(),e.nrm(5,"th",11),e.k0s())}function yr(n,r){if(1&n){const t=e.RV6();e.j41(0,"input",21),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.nombre,o)||(a.nombre=o),e.Njj(o)}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.R50("ngModel",t.nombre)}}function xr(n,r){if(1&n&&e.EFF(0),2&n){const t=e.XpG().$implicit;e.SpI(" ",t.nombre," ")}}function kr(n,r){if(1&n){const t=e.RV6();e.j41(0,"input",21),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.descripcion,o)||(a.descripcion=o),e.Njj(o)}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.R50("ngModel",t.descripcion)}}function Fr(n,r){if(1&n&&e.EFF(0),2&n){const t=e.XpG().$implicit;e.SpI(" ",t.descripcion," ")}}function Er(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.onRowEditInit(o))}),e.k0s()}}function Sr(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.onRowEditSave(o))}),e.k0s()}}function Mr(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",24),e.bIt("click",function(){e.eBV(t);const o=e.XpG(),a=o.$implicit,s=o.rowIndex,l=e.XpG(2);return e.Njj(l.onRowEditCancel(a,s))}),e.k0s()}}function jr(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",25),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.confirmarEliminacion(o))}),e.k0s()}}function Tr(n,r){if(1&n&&(e.j41(0,"tr",12)(1,"td")(2,"p-cellEditor"),e.DNE(3,yr,1,1,"ng-template",13)(4,xr,1,1,"ng-template",14),e.k0s()(),e.j41(5,"td")(6,"p-cellEditor"),e.DNE(7,kr,1,1,"ng-template",13)(8,Fr,1,1,"ng-template",14),e.k0s()(),e.j41(9,"td")(10,"div",15)(11,"div",16),e.DNE(12,Er,1,0,"button",17)(13,Sr,1,0,"button",18)(14,Mr,1,0,"button",19),e.k0s(),e.DNE(15,jr,1,0,"button",20),e.k0s()()()),2&n){const i=r.editing;e.Y8G("pEditableRow",r.$implicit),e.R7$(12),e.Y8G("ngIf",!i),e.R7$(),e.Y8G("ngIf",i),e.R7$(),e.Y8G("ngIf",i),e.R7$(),e.Y8G("ngIf",!i)}}function wr(n,r){if(1&n&&(e.j41(0,"p-table",8),e.DNE(1,Ir,6,0,"ng-template",9)(2,Tr,16,5,"ng-template",10),e.k0s()),2&n){const t=e.XpG();e.Y8G("paginatorDropdownAppendTo","body")("value",t.subcategorias)}}function Rr(n,r){1&n&&(e.j41(0,"div",26),e.EFF(1," No se han realizado registros de esta ubicaci\xf3n "),e.k0s())}function Dr(n,r){1&n&&(e.j41(0,"div",27)(1,"h5",28),e.nrm(2,"span",29),e.k0s(),e.j41(3,"p",30),e.nrm(4,"span",31)(5,"span",32)(6,"span",32)(7,"span",29)(8,"span",33),e.k0s()())}let Gr=(()=>{class n{constructor(t,i,o,a,s,l){this.listService=t,this.route=i,this.router=o,this.updateservice=a,this.helperservice=s,this.auth=l,this.subcategorias=[],this.load_lista=!0,this.id="",this.clonedProducts={},this.check={},this.token=this.auth.token(),this.id=this.route.snapshot.queryParamMap.get("id")}ngOnInit(){var t=this;return(0,g.A)(function*(){const i={DashboardComponent:yield t.auth.hasPermissionComponent("dashboard","get")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a;try{t.helperservice.llamarspinner("subcategoria"),t.check.IndexSubcategoriaComponent||t.router.navigate(["/notfound"]),t.listarSubcategorias()}catch(s){console.error("Error en ngOnInit:",s),t.router.navigate(["/notfound"])}finally{t.helperservice.cerrarspinner("subcategoria")}});return function(a){return o.apply(this,arguments)}}())})()}listarSubcategorias(){this.load_lista=!0,this.listService.listarSubcategorias(this.token,"categoria",this.id).subscribe(t=>{this.subcategorias=t.data,this.load_lista=!1},t=>{})}onRowEditInit(t){this.clonedProducts[t._id]={...t}}onRowEditSave(t){this.updateservice.actualizarSubcategoria(this.token,t._id,t).subscribe(i=>{})}onRowEditCancel(t,i){this.subcategorias[i]=this.clonedProducts[t._id]}verSubcategorias(t){this.router.navigate(["/subcategorias"],{queryParams:{id:t}})}confirmarEliminacion(t){}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(S.a),e.rXU(x.nX),e.rXU(x.Ix),e.rXU(P),e.rXU(k.w),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-subcategoria"]],decls:11,vars:4,consts:[[1,"card"],[1,"card-header"],[4,"ngIf"],[1,"card-body"],[1,"table-responsive-sm"],["dataKey","_id","editMode","row","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value",4,"ngIf"],["class","alert alert-info","role","alert",4,"ngIf"],["class","card-body","aria-hidden","true",4,"ngIf"],["dataKey","_id","editMode","row","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value"],["pTemplate","header"],["pTemplate","body"],["scope","col"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],["role","group","aria-label","Acciones",1,"btn-group"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","bi bi-pencil","class","p-button-rounded p-button-text mr-2 btn btn-primary",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","bi bi-floppy","class","p-button-rounded p-button-text p-button-success mr-2 btn btn-success",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","bi bi-trash","class","p-button-rounded p-button-text p-button-danger btn btn-danger",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","bi bi-trash","class","p-button-rounded p-button-text btn btn-danger",3,"click",4,"ngIf"],["pInputText","","type","text","required","",1,"form-control",3,"ngModelChange","ngModel"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","bi bi-pencil",1,"p-button-rounded","p-button-text","mr-2","btn","btn-primary",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","bi bi-floppy",1,"p-button-rounded","p-button-text","p-button-success","mr-2","btn","btn-success",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","bi bi-trash",1,"p-button-rounded","p-button-text","p-button-danger","btn","btn-danger",3,"click"],["pButton","","pRipple","","type","button","icon","bi bi-trash",1,"p-button-rounded","p-button-text","btn","btn-danger",3,"click"],["role","alert",1,"alert","alert-info"],["aria-hidden","true",1,"card-body"],[1,"card-title","placeholder-glow"],[1,"placeholder","col-6"],[1,"card-text","placeholder-glow"],[1,"placeholder","col-7"],[1,"placeholder","col-4"],[1,"placeholder","col-8"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h2"),e.EFF(3," Listado de Subcategor\xedas"),e.DNE(4,Cr,2,1,"span",2),e.k0s()(),e.j41(5,"div",3),e.nrm(6,"p-toast"),e.j41(7,"div",4),e.DNE(8,wr,3,2,"p-table",5),e.k0s()(),e.DNE(9,Rr,2,0,"div",6)(10,Dr,9,0,"div",7),e.k0s()),2&i&&(e.R7$(4),e.Y8G("ngIf",!o.load_lista&&o.subcategorias.length>0&&o.id),e.R7$(4),e.Y8G("ngIf",o.subcategorias.length>0&&!o.load_lista),e.R7$(),e.Y8G("ngIf",0==o.subcategorias.length&&!o.load_lista),e.R7$(),e.Y8G("ngIf",o.load_lista))},dependencies:[b.bT,u.Ei,v._f,E.y8,c.me,c.BC,c.YS,c.vS,I.XI,I.c5,I.Xk,I.Hd,I.E7,I.Tf,M.S,le.n]})}return n})();function Pr(n,r){if(1&n&&(e.j41(0,"div",19)(1,"div"),e.EFF(2),e.k0s()()),2&n){let t;const i=e.XpG(2);e.R7$(2),e.SpI(" ",null==(t=i.subcategoriaForm.get("categoria"))||null==t.value?null:t.value.nombre," ")}}function zr(n,r){if(1&n&&(e.j41(0,"div",19)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.nombre)}}function Xr(n,r){if(1&n){const t=e.RV6();e.j41(0,"form",6),e.bIt("ngSubmit",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.registrarSubcategoria())}),e.j41(1,"div",7)(2,"div",8)(3,"label",9),e.EFF(4,"Categor\xeda"),e.k0s(),e.j41(5,"p-dropdown",10),e.DNE(6,Pr,3,1,"ng-template",11)(7,zr,3,1,"ng-template",12),e.k0s()(),e.j41(8,"div",8)(9,"label",13),e.EFF(10,"Nombre"),e.k0s(),e.nrm(11,"input",14),e.k0s(),e.j41(12,"div",8)(13,"label",15),e.EFF(14,"Descripci\xf3n"),e.k0s(),e.nrm(15,"textarea",16),e.k0s(),e.j41(16,"button",17),e.nrm(17,"i",18),e.k0s()()()}if(2&n){const t=e.XpG();e.Y8G("formGroup",t.subcategoriaForm),e.R7$(5),e.Y8G("options",t.categorias)("showClear",!0)}}let Nr=(()=>{class n{constructor(t,i,o,a,s,l,p){this.fb=t,this.listService=i,this.createService=o,this.router=a,this.helper=s,this.messageService=l,this.auth=p,this.categorias=[],this.subcategoriaForm={},this.check={},this.token=this.auth.token(),this.subcategoriaForm=this.fb.group({categoria:["",c.k0.required],nombre:["",c.k0.required],descripcion:["",c.k0.required]})}ngOnInit(){var t=this;return(0,g.A)(function*(){const i={CreateSubcategoriaComponent:yield t.auth.hasPermissionComponent("/subcategoria","post")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a;try{t.check.CreateSubcategoriaComponent||t.router.navigate(["/notfound"]),t.listarCategorias()}catch(s){console.error("Error en ngOnInit:",s),t.router.navigate(["/notfound"])}});return function(a){return o.apply(this,arguments)}}())})()}listarCategorias(){this.listService.listarCategorias(this.token).subscribe(t=>{this.categorias=t.data})}registrarSubcategoria(){this.subcategoriaForm.valid?this.createService.registrarSubcategoria(this.token,this.subcategoriaForm.value).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Ingreso",detail:"Correctamente"}),setTimeout(()=>{this.router.navigate(["/maps/categoria"])},2e3))},t=>{this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})}):(console.log(this.subcategoriaForm),this.messageService.add({severity:"error",summary:"Error",detail:"Algunos campos est\xe1n Fallando"}))}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.ok),e.rXU(S.a),e.rXU(U.m),e.rXU(x.Ix),e.rXU(k.w),e.rXU(u.bg),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-subcategoria"]],features:[e.Jv_([u.bg])],decls:9,vars:1,consts:[[1,"card"],[1,"card-header"],[1,"row"],[1,"col-auto"],[1,"card-body"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6"],["for","categoria",1,"form-label"],["appendTo","body","formControlName","categoria","optionLabel","name","placeholder","Selecciona una categoria",3,"options","showClear"],["pTemplate","selectedItem"],["pTemplate","item"],["for","nombre",1,"form-label"],["type","text","pInputText","","id","nombre","formControlName","nombre","required","",1,"form-control"],["for","descripcion",1,"form-label"],["pInputTextarea","","id","descripcion","formControlName","descripcion","required","",1,"form-control"],["type","submit","pButton","","label","Guardar",1,"btn","btn-primary"],[1,"bi","bi-save"],[1,"flex","align-items-center","gap-2"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),e.EFF(5,"Nueva Sub-Categor\xeda"),e.k0s()()()(),e.j41(6,"div",4),e.nrm(7,"p-toast"),e.DNE(8,Xr,18,3,"form",5),e.k0s()()),2&i&&(e.R7$(8),e.Y8G("ngIf",o.categorias))},dependencies:[b.bT,u.Ei,v._f,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,X.ms,M.S,H.Z]})}return n})();var Pe=d(7813),ze=d(8227);function Ar(n,r){1&n&&(e.j41(0,"h5"),e.EFF(1,"Puedes cambiar tu informaci\xf3n personal."),e.k0s())}function Br(n,r){if(1&n&&(e.j41(0,"h5"),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.R7$(),e.SpI(" Formulario de actializaci\xf3n de datos de usuario : ",t.datauser.photo," ")}}function Ur(n,r){if(1&n&&e.nrm(0,"img",31),2&n){const t=e.XpG(3);e.Y8G("src",t.nombreArchivo?t.nombreArchivo:t.url+"obtener_imagen/usuario/"+t.datauser.photo,e.B4B)}}function Lr(n,r){1&n&&e.nrm(0,"p-skeleton",32)}function Or(n,r){if(1&n&&(e.j41(0,"div",34)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(4);e.R7$(2),e.SpI(" ",t.datauser.role.name," ")}}function $r(n,r){if(1&n&&e.DNE(0,Or,3,1,"div",33),2&n){const t=e.XpG(3);e.Y8G("ngIf",t.datauser.role)}}function Vr(n,r){if(1&n&&(e.j41(0,"div",35)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.name)}}function Yr(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",23)(1,"label",36),e.EFF(2,"Estado"),e.k0s(),e.j41(3,"p-inputSwitch",37),e.bIt("ngModelChange",function(o){e.eBV(t);const a=e.XpG(3);return e.Njj(a.datauser.estado=o?"On":"Off")}),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(3),e.Y8G("ngModel","On"===t.datauser.estado)}}function Hr(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",3),e.DNE(1,Ar,2,0,"h5",0)(2,Br,2,1,"h5",0),e.j41(3,"div",4)(4,"div",5),e.DNE(5,Ur,1,1,"img",6)(6,Lr,1,0,"p-skeleton",7),e.j41(7,"p-fileUpload",8),e.bIt("onUpload",function(o){e.eBV(t);const a=e.XpG(2);return e.Njj(a.onFilesSelected(o))}),e.k0s(),e.j41(8,"label"),e.EFF(9,"JPG, PNG, GIF. Peso m\xe1ximo 4MB. "),e.k0s()(),e.j41(10,"div",9)(11,"div",4)(12,"div",10)(13,"label",11),e.EFF(14,"Nombres"),e.k0s(),e.j41(15,"input",12),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.name,o)||(a.datauser.name=o),e.Njj(o)}),e.k0s()(),e.j41(16,"div",10)(17,"label",13),e.EFF(18,"Apellidos"),e.k0s(),e.j41(19,"input",14),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.last_name,o)||(a.datauser.last_name=o),e.Njj(o)}),e.k0s()(),e.j41(20,"div",10)(21,"label",15),e.EFF(22,"Correo"),e.k0s(),e.j41(23,"input",16),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.email,o)||(a.datauser.email=o),e.Njj(o)}),e.k0s()(),e.j41(24,"div",10)(25,"label",17),e.EFF(26,"Contrase\xf1a"),e.k0s(),e.j41(27,"input",18),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.password,o)||(a.datauser.password=o),e.Njj(o)}),e.k0s()(),e.j41(28,"div",10)(29,"label",19),e.EFF(30,"C\xe9dula"),e.k0s(),e.j41(31,"input",20),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.dni,o)||(a.datauser.dni=o),e.Njj(o)}),e.k0s()(),e.j41(32,"div",10)(33,"label",21),e.EFF(34,"Tel\xe9fono"),e.k0s(),e.j41(35,"input",22),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.telefono,o)||(a.datauser.telefono=o),e.Njj(o)}),e.k0s()(),e.j41(36,"div",23)(37,"label",24),e.EFF(38,"Rol "),e.k0s(),e.j41(39,"p-dropdown",25),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.role,o)||(a.datauser.role=o),e.Njj(o)}),e.DNE(40,$r,1,1,"ng-template",26)(41,Vr,3,1,"ng-template",27),e.k0s()(),e.DNE(42,Yr,4,1,"div",28),e.k0s()()(),e.j41(43,"div",29)(44,"p-button",30),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.updateUser())}),e.k0s()()()}if(2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.editing),e.R7$(),e.Y8G("ngIf",!t.editing),e.R7$(3),e.Y8G("ngIf",!t.load_form),e.R7$(),e.Y8G("ngIf",t.load_form),e.R7$(),e.Y8G("maxFileSize",4e5)("fileLimit",1)("auto",!0),e.R7$(8),e.R50("ngModel",t.datauser.name),e.Y8G("disabled",t.editing),e.R7$(4),e.R50("ngModel",t.datauser.last_name),e.Y8G("disabled",t.editing),e.R7$(4),e.R50("ngModel",t.datauser.email),e.R7$(4),e.R50("ngModel",t.datauser.password),e.R7$(4),e.R50("ngModel",t.datauser.dni),e.Y8G("disabled",t.editing),e.R7$(4),e.R50("ngModel",t.datauser.telefono),e.R7$(4),e.Y8G("disabled",t.editing)("options",t.listrol),e.R50("ngModel",t.datauser.role),e.Y8G("placeholder",t.datauser.role?t.datauser.role.name:"Selecciona uno"),e.R7$(3),e.Y8G("ngIf",!t.editing),e.R7$(2),e.Y8G("disabled",t.load_form)}}function Jr(n,r){1&n&&(e.j41(0,"div",38)(1,"div",39)(2,"div",40)(3,"div",41)(4,"h2"),e.EFF(5,"Editar Perfil"),e.k0s()()()(),e.j41(6,"div",42)(7,"div",43),e.nrm(8,"p-skeleton",44)(9,"p-skeleton",45)(10,"p-skeleton",46)(11,"p-skeleton",47)(12,"p-skeleton",48),e.k0s()()())}function Wr(n,r){if(1&n&&(e.qex(0),e.DNE(1,Hr,45,22,"div",1)(2,Jr,13,0,"div",2),e.bVm()),2&n){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.datauser),e.R7$(),e.Y8G("ngIf",!t.datauser)}}function Zr(n,r){1&n&&(e.j41(0,"h5"),e.EFF(1,"Puedes cambiar tu informaci\xf3n personal."),e.k0s())}function qr(n,r){if(1&n&&(e.j41(0,"h5"),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.R7$(),e.SpI(" Formulario de actializaci\xf3n de datos de usuario: ",t.datauser.photo," ")}}function Kr(n,r){if(1&n&&e.nrm(0,"img",31),2&n){const t=e.XpG(3);e.Y8G("src",t.nombreArchivo?t.nombreArchivo:t.url+"obtener_imagen/usuario/"+t.datauser.photo,e.B4B)}}function Qr(n,r){1&n&&e.nrm(0,"p-skeleton",32)}function es(n,r){if(1&n&&(e.j41(0,"div",34)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(4);e.R7$(2),e.SpI(" ",t.datauser.role.name," ")}}function ts(n,r){if(1&n&&e.DNE(0,es,3,1,"div",33),2&n){const t=e.XpG(3);e.Y8G("ngIf",t.datauser.role)}}function is(n,r){if(1&n&&(e.j41(0,"div",35)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.name)}}function ns(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",23)(1,"label",36),e.EFF(2,"Estado"),e.k0s(),e.j41(3,"p-inputSwitch",37),e.bIt("ngModelChange",function(o){e.eBV(t);const a=e.XpG(3);return e.Njj(a.datauser.estado=o?"On":"Off")}),e.k0s()()}if(2&n){const t=e.XpG(3);e.R7$(3),e.Y8G("ngModel","On"===t.datauser.estado)}}function os(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",3),e.DNE(1,Zr,2,0,"h5",0)(2,qr,2,1,"h5",0),e.j41(3,"p-messages",49),e.mxI("valueChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.messages,o)||(a.messages=o),e.Njj(o)}),e.k0s(),e.j41(4,"div",4)(5,"div",5),e.DNE(6,Kr,1,1,"img",6)(7,Qr,1,0,"p-skeleton",7),e.j41(8,"p-fileUpload",8),e.bIt("onUpload",function(o){e.eBV(t);const a=e.XpG(2);return e.Njj(a.onFilesSelected(o))}),e.k0s(),e.j41(9,"label"),e.EFF(10,"JPG, PNG, GIF. Peso m\xe1ximo 4MB. "),e.k0s()(),e.j41(11,"div",9)(12,"div",4)(13,"div",10)(14,"label",11),e.EFF(15,"Nombres"),e.k0s(),e.j41(16,"input",12),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.name,o)||(a.datauser.name=o),e.Njj(o)}),e.k0s()(),e.j41(17,"div",10)(18,"label",13),e.EFF(19,"Apellidos"),e.k0s(),e.j41(20,"input",14),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.last_name,o)||(a.datauser.last_name=o),e.Njj(o)}),e.k0s()(),e.j41(21,"div",10)(22,"label",15),e.EFF(23,"Correo"),e.k0s(),e.j41(24,"input",50),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.email,o)||(a.datauser.email=o),e.Njj(o)}),e.k0s()(),e.j41(25,"div",10)(26,"label",17),e.EFF(27,"Contrase\xf1a"),e.k0s(),e.j41(28,"input",18),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.password,o)||(a.datauser.password=o),e.Njj(o)}),e.k0s()(),e.j41(29,"div",10)(30,"label",17),e.EFF(31,"Confirmaci\xf3n de Contrase\xf1a"),e.k0s(),e.j41(32,"input",51),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.passwordConfirmation,o)||(a.datauser.passwordConfirmation=o),e.Njj(o)}),e.k0s()(),e.j41(33,"div",10)(34,"label",19),e.EFF(35,"C\xe9dula"),e.k0s(),e.j41(36,"input",20),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.dni,o)||(a.datauser.dni=o),e.Njj(o)}),e.k0s()(),e.j41(37,"div",10)(38,"label",21),e.EFF(39,"Tel\xe9fono"),e.k0s(),e.j41(40,"input",22),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.telefono,o)||(a.datauser.telefono=o),e.Njj(o)}),e.k0s()(),e.j41(41,"div",23)(42,"label",24),e.EFF(43,"Rol "),e.k0s(),e.j41(44,"p-dropdown",52),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG(2);return e.DH7(a.datauser.role,o)||(a.datauser.role=o),e.Njj(o)}),e.DNE(45,ts,1,1,"ng-template",26)(46,is,3,1,"ng-template",27),e.k0s()(),e.DNE(47,ns,4,1,"div",28),e.k0s()()(),e.j41(48,"div",29)(49,"p-button",53),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.updateUser())}),e.k0s()()()}if(2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.editing),e.R7$(),e.Y8G("ngIf",!t.editing),e.R7$(),e.R50("value",t.messages),e.Y8G("enableService",!1),e.R7$(3),e.Y8G("ngIf",!t.load_form),e.R7$(),e.Y8G("ngIf",t.load_form),e.R7$(),e.Y8G("maxFileSize",4e5)("fileLimit",1)("auto",!0),e.R7$(8),e.R50("ngModel",t.datauser.name),e.Y8G("disabled",t.editing),e.R7$(4),e.R50("ngModel",t.datauser.last_name),e.Y8G("disabled",t.editing),e.R7$(4),e.R50("ngModel",t.datauser.email),e.Y8G("disabled",t.editing),e.R7$(4),e.R50("ngModel",t.datauser.password),e.R7$(4),e.R50("ngModel",t.datauser.passwordConfirmation),e.R7$(4),e.R50("ngModel",t.datauser.dni),e.Y8G("disabled",t.editing),e.R7$(4),e.R50("ngModel",t.datauser.telefono),e.R7$(4),e.Y8G("disabled",t.editing)("options",t.listrol),e.R50("ngModel",t.datauser.role),e.Y8G("placeholder",t.datauser.role?t.datauser.role.name:"Selecciona uno"),e.R7$(3),e.Y8G("ngIf",!t.editing)}}function as(n,r){1&n&&(e.j41(0,"div",38)(1,"div",39)(2,"div",40)(3,"div",41)(4,"h2"),e.EFF(5,"Editar Perfil"),e.k0s()()()(),e.j41(6,"div",42)(7,"div",43),e.nrm(8,"p-skeleton",44)(9,"p-skeleton",45)(10,"p-skeleton",46)(11,"p-skeleton",47)(12,"p-skeleton",48),e.k0s()()())}function rs(n,r){if(1&n&&(e.qex(0),e.j41(1,"div",38),e.DNE(2,os,50,25,"div",1),e.k0s(),e.DNE(3,as,13,0,"div",2),e.bVm()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",t.datauser),e.R7$(),e.Y8G("ngIf",!t.datauser)}}let Xe=(()=>{class n{constructor(t,i,o,a,s,l,p,m,_,h,y,G){this._route=t,this.router=i,this._filterservice=o,this.adminservice=a,this.updateservice=s,this.helper=l,this.list=p,this.messageService=m,this.config=_,this.dialogService=h,this.auth=y,this.http=G,this.modal=!0,this.editing=!0,this.url=V.M.url,this.messages=[],this.archivoSeleccionado=null,this.load_form=!1}ngOnInit(){this.token=this.auth.token(),this.config&&this.config.data&&this.config.data.id?(this.id=this.config.data.id,this.modal=!0):this.router.events.subscribe(t=>{this.modal="/maps/edit-user"!==this.router.url}),this.id?this.editing=this.id==this.auth.idUserToken(this.token):(this.id=this.auth.idUserToken(this.token),this.editing=!0),this.listarRol(),this.obteneruser(this.id)}listarRol(){this.list.listarRolesUsuarios(this.token).subscribe(t=>{t.data&&(this.listrol=t.data)})}obteneruser(t){this._filterservice.obtenerUsuario(this.token,t).subscribe(i=>{this.datauser=i.data,this.datauser.password="",this.datauser.password_temp&&(this.messages=[{severity:"error",detail:"Por favor cambie su contrase\xf1a y guarde."}])},i=>{this.messageService.add({severity:"error",summary:`(${i.status})`,detail:i.error.message||"Sin conexi\xf3n"})})}updateUser(){var t=this;this.datauser.password_temp&&(this.datauser.password_temp=""),this.datauser.role=this.datauser.role._id,(""===this.datauser.password||null==this.datauser.password)&&delete this.datauser.password,this.updateservice.actualizarUsuario(this.token,this.id,this.datauser,this.archivoSeleccionado).subscribe(function(){var i=(0,g.A)(function*(o){t.messageService.add({severity:"success",summary:"Actualizado",detail:o.message});const a=localStorage.getItem("pass");t.helper.isMobil()&&(!a||t.datauser.password!==t.helper.decryptDataLogin(a))&&(yield Pe.qG.isAvailable()).isAvailable&&((yield Pe.qG.verifyIdentity({reason:"Para un f\xe1cil inicio de sesi\xf3n",title:"Inicio de Sesi\xf3n",subtitle:"Coloque su dedo en el sensor.",description:"Se requiere Touch ID o Face ID"}).then(()=>!0).catch(()=>!1))?localStorage.setItem("pass",t.helper.encryptDataLogin(t.datauser.password,"buzon")):t.messageService.add({severity:"error",summary:"(fallo)",detail:"Sin biometr\xeda"}));const s=t.router.url;setTimeout(()=>{s.startsWith("/maps/administracion")||t.router.navigate(["/home"])},500)});return function(o){return i.apply(this,arguments)}}(),i=>{console.error(i),this.messageService.add({severity:"error",summary:`(${i.status})`,detail:i.error.message||"Sin conexi\xf3n"})})}onFilesSelected(t){this.load_form=!0;const i=t.files;this.nombreArchivo=URL.createObjectURL(i[0]),this.archivoSeleccionado=i[0],setTimeout(()=>{this.load_form=!1},1500)}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(x.nX),e.rXU(x.Ix),e.rXU(K.E),e.rXU(Y.z),e.rXU(P),e.rXU(k.w),e.rXU(S.a),e.rXU(u.bg),e.rXU(f.sb),e.rXU(f.o3),e.rXU(F.u),e.rXU(C.Qq))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-edit-usuario"]],features:[e.Jv_([u.bg,f.o3])],decls:3,vars:2,consts:[[4,"ngIf"],["class","col-12",4,"ngIf"],["class","card",4,"ngIf"],[1,"col-12"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-4"],["alt","Image","width","100","height","100","style","border-radius: 50%; object-fit: cover",3,"src",4,"ngIf"],["shape","circle","size","5rem",4,"ngIf"],["mode","basic","name","demo[]","url","https://www.primefaces.org/cdn/api/upload.php","accept","image/*","chooseLabel","Subir",3,"onUpload","maxFileSize","fileLimit","auto"],[1,"field","col-8"],[1,"field","col-12","md:col-6"],["htmlFor","firstname"],["pInputText","","id","firstname","type","text","placeholder","Ingresa tus nombres",3,"ngModelChange","ngModel","disabled"],["htmlFor","firstname2"],["pInputText","","id","firstname2","type","text","placeholder","Ingresa tus Apellidos",3,"ngModelChange","ngModel","disabled"],["htmlFor","email2"],["pInputText","","id","email2","type","email","placeholder","Ingresa tu email","type","email",3,"ngModelChange","ngModel"],["htmlFor","pass"],["pInputText","","type","password","id","pass","placeholder","Ingresa una nueva contrase\xf1a",3,"ngModelChange","ngModel"],["htmlFor","dni"],["pInputText","","id","dni","type","text","placeholder","Ingresa tu C\xe9dula",3,"ngModelChange","ngModel","disabled"],["htmlFor","phone"],["pInputText","","id","phone","type","tel","placeholder","Ingresa tu tel\xe9fono","type","tel",3,"ngModelChange","ngModel"],[1,"field","col-12","md:col-3"],["htmlFor","state"],["appendTo","body",3,"ngModelChange","disabled","options","ngModel","placeholder"],["pTemplate","selectedItem"],["pTemplate","item",2,"padding-left","0rem !important"],["class","field col-12 md:col-3",4,"ngIf"],[1,"flex","pt-4","justify-content-end"],["label","Guardar",1,"btn","btn-primary",3,"click","disabled"],["alt","Image","width","100","height","100",2,"border-radius","50%","object-fit","cover",3,"src"],["shape","circle","size","5rem"],["class","flex align-items-center",4,"ngIf"],[1,"flex","align-items-center"],[1,"flex"],["htmlFor","zip"],[3,"ngModelChange","ngModel"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-lg-auto"],[1,"card-body"],["aria-hidden","true",1,"card-body"],["styleClass","mb-2"],["width","10rem","styleClass","mb-2"],["width","5rem","styleClass","mb-2"],["height","2rem","styleClass","mb-2"],["width","10rem","height","4rem"],[3,"valueChange","value","enableService"],["pInputText","","id","email2","type","email","placeholder","Ingresa tu email","type","email",3,"ngModelChange","ngModel","disabled"],["pInputText","","type","password","id","passconf","placeholder","Ingresa una nueva contrase\xf1a",3,"ngModelChange","ngModel"],[3,"ngModelChange","disabled","options","ngModel","placeholder"],["label","Guardar",1,"btn","btn-primary",3,"click"]],template:function(i,o){1&i&&(e.nrm(0,"p-toast"),e.DNE(1,Wr,3,2,"ng-container",0)(2,rs,4,2,"ng-container",0)),2&i&&(e.R7$(),e.Y8G("ngIf",o.modal),e.R7$(),e.Y8G("ngIf",!o.modal))},dependencies:[b.bT,u.Ei,v.$n,E.y8,c.me,c.BC,c.vS,te.N,ze.B,X.ms,M.S,ae.E,_e.HW],styles:["@media (max-width: 767px){.form-switch[_ngcontent-%COMP%]{padding-left:0}}@media (max-width: 767px){.text-sm-center-costum[_ngcontent-%COMP%]{text-align:center!important}}.is-mobile[_ngcontent-%COMP%]{padding-bottom:60px}@media (max-width: 767px){.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:0rem 2px!important;position:relative}}@media (max-width: 767.98px){.main-panel[_ngcontent-%COMP%]   .main-content[_ngcontent-%COMP%]{bottom:70px!important;margin-top:0;padding:10px 0}}.file-upload[_ngcontent-%COMP%]{position:relative;overflow:hidden;display:inline-block}.file-upload-input[_ngcontent-%COMP%]{height:max-content!important;position:absolute;top:0;right:0;margin:0;padding:0;cursor:pointer;opacity:0;filter:alpha(opacity=0)}.file-upload-label[_ngcontent-%COMP%]{display:inline-block;padding:14px 20px;background-color:#4caf5069;color:#0e663e;border-radius:17px;cursor:pointer;border:2px dashed rgba(76,175,79,.9921568627)}.file-upload-label.hover[_ngcontent-%COMP%]{background-color:#4caf50}p-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%}"]})}return n})();var fe=d(2440),be=d(9465),Ne=d(3036);const ss=()=>[10,25,50],ls=()=>["name","last_name","email","telf","dni"];function cs(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",15)(1,"p-iconField",16)(2,"p-inputIcon"),e.nrm(3,"i",17),e.k0s(),e.j41(4,"input",18),e.bIt("input",function(o){e.eBV(t),e.XpG();const a=e.sdS(1);return e.Njj(a.filterGlobal(o.target.value,"contains"))}),e.k0s()()()}}function ds(n,r){1&n&&(e.j41(0,"tr")(1,"th",19),e.EFF(2," Nombre "),e.nrm(3,"p-sortIcon",20),e.k0s(),e.j41(4,"th",21),e.EFF(5," Apellidos "),e.nrm(6,"p-sortIcon",22),e.k0s(),e.j41(7,"th",23),e.EFF(8," Cargo "),e.nrm(9,"p-sortIcon",24),e.k0s(),e.j41(10,"th",25),e.EFF(11," Correo "),e.nrm(12,"p-sortIcon",26),e.k0s(),e.j41(13,"th",27),e.EFF(14," Tel\xe9fono "),e.nrm(15,"p-sortIcon",28),e.k0s(),e.j41(16,"th",29),e.EFF(17," C\xe9dula "),e.nrm(18,"p-sortIcon",30),e.k0s(),e.j41(19,"th",31),e.EFF(20," Registro "),e.nrm(21,"p-sortIcon",32),e.k0s(),e.j41(22,"th"),e.EFF(23,"Opci\xf3n"),e.k0s()())}function ps(n,r){if(1&n){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.nrm(2,"p-avatar",33),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.EFF(16),e.k0s(),e.j41(17,"td")(18,"p-button",34),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.editrow(o._id))}),e.k0s()()()}if(2&n){const t=r.$implicit,i=e.XpG(2);e.R7$(2),e.Y8G("image",i.url+"obtener_imagen/usuario/"+t.photo),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.last_name),e.R7$(2),e.JRh(t.role.name),e.R7$(2),e.JRh(t.email),e.R7$(2),e.JRh(t.telf),e.R7$(2),e.JRh(t.dni),e.R7$(2),e.JRh(t.createdAt)}}function ms(n,r){if(1&n&&(e.j41(0,"p-table",11,0),e.DNE(2,cs,5,0,"ng-template",12)(3,ds,24,0,"ng-template",13)(4,ps,19,8,"ng-template",14),e.k0s()),2&n){const t=e.XpG();e.Y8G("paginatorDropdownAppendTo","body")("value",t.usuarios)("scrollable",!0)("responsive",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.lJ4(9,ss))("paginator",!0)("globalFilterFields",e.lJ4(10,ls))}}function us(n,r){1&n&&(e.j41(0,"div",35),e.EFF(1," No se han realizado registros de esta ubicaci\xf3n "),e.k0s())}function _s(n,r){1&n&&(e.j41(0,"div",36)(1,"h5",37),e.nrm(2,"span",38),e.k0s(),e.j41(3,"p",39),e.nrm(4,"span",40)(5,"span",41)(6,"span",41)(7,"span",38)(8,"span",42),e.k0s()())}let Ae=(()=>{class n{constructor(t,i,o,a,s,l){this.ref=t,this.router=i,this.listService=o,this.helperservice=a,this.dialogService=s,this.auth=l,this.url=V.M.url,this.load_lista=!0,this.usuarios=[],this.usuariosconst=[],this.token=this.auth.token(),this.opciones=[{label:"Nombre",value:"nombres"},{label:"Correo",value:"correo"},{label:"Tel\xe9fono",value:"telefono"},{label:"C\xe9dula",value:"cedula"},{label:"Rol",value:"role"}],this.orden="asc"}ngOnInit(){this.listusers()}listusers(){this.load_lista=!0,this.listService.listarUsuarios(this.token).subscribe(t=>{t.data&&(this.usuarios=t.data,this.usuariosconst=t.data,this.ordenaryfiltrar("role",void 0,this.orden),this.load_lista=!1)},t=>{})}ordenaryfiltrar(t,i,o){t&&i?(this.usuarios=this.usuariosconst.filter("role"==t?a=>a[t].orden==i||a[t].nombre.includes(i):a=>a[t].toString().includes(i)),o&&(this.usuarios=this.usuarios.sort((a,s)=>{const p=(m=a[t])<(_=s[t])?-1:m>_?1:0;var m,_;return"desc"===o?-1*p:p}))):this.usuarios=t?this.usuariosconst.sort("role"!==t||i?(a,s)=>{const p=(m=a[t])<(_=s[t])?-1:m>_?1:0;var m,_;return"desc"===o?-1*p:p}:(a,s)=>{const p=(m=a[t].orden)<(_=s[t].orden)?-1:m>_?1:0;var m,_;return"desc"===o?-1*p:p}):this.usuariosconst}isMobil(){return this.helperservice.isMobil()}editrow(t){this.ref=this.dialogService.open(Xe,{header:"Editar Usuario",width:this.isMobil()?"100%":"70%",data:{id:t}}),T.q.addListener("backButton",i=>{this.ref.close()})}openModal(t){this.dialogService.open(t,{ariaLabelledBy:"modal-basic-title"})}stopPropagation(t){t.stopPropagation()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(f.Pw),e.rXU(x.Ix),e.rXU(S.a),e.rXU(k.w),e.rXU(f.o3),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-usuario"]],decls:13,vars:6,consts:[["dt",""],[1,"card",2,"margin-top","10px"],[1,"card-header"],[1,"card-body"],[1,"input-group","mb-3"],["optionLabel","label","placeholder","Categor\xeda",3,"ngModelChange","options","ngModel"],["type","text","aria-label","Text a filtrar","name","valor","pInputText","",1,"form-control",3,"ngModelChange","ngModel"],["label","Buscar","icon"," pi pi-search ",3,"click"],["currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","scrollable","responsive","rows","showCurrentPageReport","rowsPerPageOptions","paginator","globalFilterFields",4,"ngIf"],["class","alert alert-info","role","alert",4,"ngIf"],["class","card-body","aria-hidden","true",4,"ngIf"],["currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","scrollable","responsive","rows","showCurrentPageReport","rowsPerPageOptions","paginator","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex"],["iconPosition","left",1,"ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar palabra clave",3,"input"],["colspan","2","pSortableColumn","name",2,"width","20%"],["field","name"],["colspan","1","pSortableColumn","last_name",2,"width","20%"],["field","last_name"],["pSortableColumn","role.orden",2,"width","20%"],["field","role.ordnen"],["pSortableColumn","email",2,"width","20%"],["field","email"],["pSortableColumn","telf",2,"width","20%"],["field","telf"],["pSortableColumn","dni",2,"width","20%"],["field","dni"],["pSortableColumn","createdAt",2,"width","20%"],["field","createdAt"],["styleClass","mr-2","size","xlarge","shape","circle",3,"image"],["icon","pi pi-user-edit","label","Ver",3,"click"],["role","alert",1,"alert","alert-info"],["aria-hidden","true",1,"card-body"],[1,"card-title","placeholder-glow"],[1,"placeholder","col-6"],[1,"card-text","placeholder-glow"],[1,"placeholder","col-7"],[1,"placeholder","col-4"],[1,"placeholder","col-8"]],template:function(i,o){1&i&&(e.j41(0,"div",1)(1,"div",2)(2,"h2"),e.EFF(3,"Listado de Usuarios"),e.k0s()(),e.j41(4,"div",3),e.nrm(5,"p-toast"),e.j41(6,"div",4)(7,"p-dropdown",5),e.mxI("ngModelChange",function(s){return e.DH7(o.categoria,s)||(o.categoria=s),s}),e.k0s(),e.j41(8,"input",6),e.mxI("ngModelChange",function(s){return e.DH7(o.valor,s)||(o.valor=s),s}),e.k0s(),e.j41(9,"p-button",7),e.bIt("click",function(){return o.ordenaryfiltrar(o.categoria.value,o.valor,o.orden)}),e.k0s()(),e.DNE(10,ms,5,11,"p-table",8)(11,us,2,0,"div",9)(12,_s,9,0,"div",10),e.k0s()()),2&i&&(e.R7$(7),e.Y8G("options",o.opciones),e.R50("ngModel",o.categoria),e.R7$(),e.R50("ngModel",o.valor),e.R7$(2),e.Y8G("ngIf",o.usuarios.length>0&&!o.load_lista),e.R7$(),e.Y8G("ngIf",0==o.usuarios.length&&!o.load_lista),e.R7$(),e.Y8G("ngIf",o.load_lista))},dependencies:[b.bT,u.Ei,fe.C,be.m,v.$n,E.y8,c.me,c.BC,c.vS,I.XI,I.Tg,I.yc,X.ms,M.S,Ne.e]})}return n})(),gs=(()=>{class n{constructor(t,i,o,a,s,l,p,m){this.fb=t,this.listService=i,this.createService=o,this.router=a,this.helper=s,this.messageService=l,this.ref=p,this.auth=m,this.token=this.auth.token(),this.roles=[],this.Form=this.fb.group({nombre:["",c.k0.required],orden:[0]})}ngOnInit(){this.listarCategorias()}listarCategorias(){this.listService.listarRolesUsuarios(this.token).subscribe(t=>{this.roles=t.data},t=>{console.error(t)})}registrar(){this.Form?.valid&&(this.Form.get("orden").setValue(this.roles.length+1),this.Form.value&&this.createService.registrarRolUsuario(this.token,this.Form.value).subscribe(t=>{t.data&&(this.messageService.add({severity:"success",summary:"Ingreso",detail:"Correcto"}),this.ref.close())},t=>{console.error(t)}))}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.ok),e.rXU(S.a),e.rXU(U.m),e.rXU(x.Ix),e.rXU(k.w),e.rXU(u.bg),e.rXU(f.Pw),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-rol-user"]],features:[e.Jv_([u.bg])],decls:10,vars:1,consts:[[1,"card-body"],[1,"table-responsive-sm"],[3,"ngSubmit","formGroup"],[1,"field","col-12","md:col-3"],[1,"p-float-label"],["type","text","pInputText","","id","nombre","name","nombre","formControlName","nombre","required",""],["for","calendar"],["pButton","","type","submit","icon","pi pi-save","label","Guardar"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.nrm(1,"p-toast"),e.j41(2,"div",1)(3,"form",2),e.bIt("ngSubmit",function(){return o.registrar()}),e.j41(4,"div",3)(5,"span",4),e.nrm(6,"input",5),e.j41(7,"label",6),e.EFF(8,"Nombre"),e.k0s()()(),e.nrm(9,"button",7),e.k0s()()()),2&i&&(e.R7$(3),e.Y8G("formGroup",o.Form))},dependencies:[v._f,E.y8,c.qT,c.me,c.BC,c.cb,c.YS,c.j4,c.JD,M.S]})}return n})();var ce=d(9114);function hs(n,r){if(1&n){const t=e.RV6();e.j41(0,"li",7),e.bIt("onDragStart",function(){const o=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.dragStart(o))})("onDragEnd",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.dragEnd())}),e.nrm(1,"p-button",8),e.EFF(2),e.j41(3,"button",9),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG();return a.dragStart(o),a.drop(),e.Njj(a.dragEnd())}),e.k0s()()}if(2&n){const t=r.$implicit,i=e.XpG();e.R7$(),e.Y8G("label",t.method.toUpperCase())("raised",!0)("severity",i.getSeverity(t.method)),e.R7$(),e.SpI(" ",t.name," "),e.R7$(),e.Y8G("text",!0)("raised",!0)}}function fs(n,r){if(1&n){const t=e.RV6();e.j41(0,"li",10),e.nrm(1,"p-button",8),e.EFF(2),e.j41(3,"button",11),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.eliminarPermiso(o))}),e.k0s()()}if(2&n){const t=r.$implicit,i=e.XpG();e.R7$(),e.Y8G("label",t.method.toUpperCase())("raised",!0)("severity",i.getSeverity(t.method)),e.R7$(),e.SpI(" ",t.name," "),e.R7$(),e.Y8G("text",!0)("raised",!0)}}let bs=(()=>{class n{constructor(t,i,o,a,s,l,p){this.authService=t,this.listService=i,this.dialogService=o,this.ref=a,this.config=s,this.helper=l,this.update=p,this.permisosDisponibles=[],this.permisosAsignados=[],this.token=this.authService.token()}getSeverity(t){switch(t.toUpperCase()){case"POST":return"success";case"GET":return"info";case"PUT":return"warning";case"DELETE":return"danger";default:return"contrast"}}isMobile(){return this.helper.isMobil()}ngOnInit(){this.config.data.role&&(this.role=this.config.data.role,this.permisosAsignados=this.role.permisos,this.listarPermisosDisponibles())}listarPermisosDisponibles(){this.listService.ListarPermisos(this.token).subscribe(t=>{this.permisosDisponibles=t.data.filter(i=>!this.permisosAsignados.some(o=>o._id===i._id))},t=>{console.error("Error al listar permisos:",t)})}dragStart(t){this.draggedPermiso=t}dragEnd(){this.draggedPermiso=null}drop(){this.draggedPermiso&&(this.permisosAsignados.push(this.draggedPermiso),this.permisosDisponibles=this.permisosDisponibles.filter(t=>t!==this.draggedPermiso),this.draggedPermiso=null,this.actualizarRoles())}eliminarPermiso(t){this.role&&(this.permisosAsignados=this.permisosAsignados.filter(i=>i!==t),this.permisosDisponibles.push(t),this.actualizarRoles())}editarPermiso(t,i){}actualizarRoles(){this.role&&(this.role.permisos=this.permisosAsignados.map(t=>t._id)),this.update.actualizarRolUsuario(this.token,this.role._id,this.role).subscribe(t=>{})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.u),e.rXU(S.a),e.rXU(f.o3),e.rXU(f.Pw),e.rXU(f.sb),e.rXU(k.w),e.rXU(P))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["ng-component"]],standalone:!0,features:[e.Jv_([f.o3]),e.aNF],decls:11,vars:8,consts:[[1,"card","flex","flex-wrap","gap-3"],[1,"p-2","border-1","surface-border","border-round"],[1,"text-center","surface-border","border-bottom-1"],[1,"list-none","flex","flex-column","gap-2","p-0","m-0"],["class","p-2 border-round shadow-1 flex align-items-center justify-content-between","pDraggable","",3,"onDragStart","onDragEnd",4,"ngFor","ngForOf"],["pDroppable","",1,"p-2","border-1","surface-border","border-round",3,"onDrop"],["class","p-2 border-round shadow-1 flex align-items-center justify-content-between",4,"ngFor","ngForOf"],["pDraggable","",1,"p-2","border-round","shadow-1","flex","align-items-center","justify-content-between",3,"onDragStart","onDragEnd"],[3,"label","raised","severity"],["pButton","","type","button","severity","success",1,"pi","pi-plus",3,"click","text","raised"],[1,"p-2","border-round","shadow-1","flex","align-items-center","justify-content-between"],["pButton","","type","button","severity","danger",1,"pi","pi-times",3,"click","text","raised"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"p",2),e.EFF(3),e.k0s(),e.j41(4,"ul",3),e.DNE(5,hs,4,6,"li",4),e.k0s()(),e.j41(6,"div",5),e.bIt("onDrop",function(){return o.drop()}),e.j41(7,"p",2),e.EFF(8),e.k0s(),e.j41(9,"ul",3),e.DNE(10,fs,4,6,"li",6),e.k0s()()()),2&i&&(e.R7$(),e.xc7("width",o.isMobile()?"100%":"49%"),e.R7$(2),e.SpI(" Permisos Disponibles (",o.permisosDisponibles.length,") "),e.R7$(2),e.Y8G("ngForOf",o.permisosDisponibles),e.R7$(),e.xc7("width",o.isMobile()?"100%":"49%"),e.R7$(2),e.SpI(" Permisos Asignados (",o.permisosAsignados.length,") "),e.R7$(2),e.Y8G("ngForOf",o.permisosAsignados))},dependencies:[b.MD,b.Sq,I.bG,v.tm,v._f,v.$n,ce.ad,ce.sx,ce.gL],encapsulation:2})}return n})();function vs(n,r){1&n&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"Nombre"),e.k0s(),e.j41(3,"th"),e.EFF(4,"Orden"),e.k0s(),e.j41(5,"th"),e.EFF(6,"Permisos"),e.k0s()())}function Cs(n,r){if(1&n){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"button",6),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.mostrarSubtablaPermisos(o))}),e.EFF(7," Ver Permisos "),e.k0s()()()}if(2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.orden)}}let Is=(()=>{class n{constructor(t,i,o,a,s,l,p){this.listService=t,this.helper=i,this.router=o,this.ref=a,this.dialogService=s,this.authService=l,this.updateServices=p,this.roles=[],this.clonedRoles={},this.permisos=[]}ngOnInit(){this.listarRolesUsuarios()}listarRolesUsuarios(){const t=this.authService.token();this.listService.listarRolesUsuarios(t,{populate:"permisos"},!1).subscribe(i=>{this.roles=i.data},i=>{console.error(i)})}isMobile(){return this.helper.isMobil()}newRol(){this.ref=this.dialogService.open(gs,{header:"Nuevo Rol",width:this.isMobile()?"100%":"30%",modal:!1}),this.ref.onClose.subscribe(()=>{this.listarRolesUsuarios()})}onRowEditInit(t){this.clonedRoles[t._id]={...t}}onRowEditSave(t){const i=this.authService.token();this.updateServices.actualizarRolUsuario(i,t._id,t).subscribe(o=>{console.log("Rol actualizado:",o)},o=>{console.error("Error al actualizar el rol:",o)})}onRowEditCancel(t,i){this.roles[i]={...this.clonedRoles[t._id]},delete this.clonedRoles[t._id]}addPermission(t){t.permissions.push("")}removePermission(t,i){t.permissions.splice(i,1)}cancelEdit(){throw new Error("Method not implemented.")}saveRoles(){throw new Error("Method not implemented.")}mostrarSubtablaPermisos(t){this.rolSeleccionado=t,this.dialogRef=this.dialogService.open(bs,{header:`Permisos del Rol: ${t.name}`,width:this.isMobile()?"100%":"70vw",data:{role:t}}),this.dialogRef.onClose.subscribe(()=>{this.listarRolesUsuarios()})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(S.a),e.rXU(k.w),e.rXU(x.Ix),e.rXU(f.Pw),e.rXU(f.o3),e.rXU(F.u),e.rXU(P))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-rol-user"]],features:[e.Jv_([f.o3])],decls:8,vars:1,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"value"],["pTemplate","header"],["pTemplate","body"],["pButton","","type","button","icon","pi pi-plus",3,"click"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h2"),e.EFF(3,"Listado de Roles de Usuario"),e.k0s()(),e.j41(4,"div",2)(5,"p-table",3),e.DNE(6,vs,7,0,"ng-template",4)(7,Cs,8,2,"ng-template",5),e.k0s()()()),2&i&&(e.R7$(5),e.Y8G("value",o.roles))},dependencies:[u.Ei,v._f,I.XI]})}return n})();function ys(n,r){if(1&n&&(e.j41(0,"div",12)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.JRh(t.newpermiso.method)}}function xs(n,r){if(1&n&&e.DNE(0,ys,3,1,"div",11),2&n){const t=e.XpG();e.Y8G("ngIf",t.newpermiso.method)}}function ks(n,r){if(1&n&&(e.j41(0,"div",12)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t)}}let Fs=(()=>{class n{constructor(t,i,o,a,s,l,p){this.auth=t,this.modalService=i,this.listService=o,this.createService=a,this.helper=s,this.messageService=l,this.ref=p,this.method_arr=["get","post","put","delete","createBatch","updateBatch"],this.newpermiso={},this.token=this.auth.token()}ngOnInit(){}enviar(){this.createService.registrarPermiso(this.token,[this.newpermiso]).subscribe(t=>{this.messageService.add({severity:"success",summary:"Ingresado",detail:t.message}),setTimeout(()=>{this.ref.close(!0)},500)})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.u),e.rXU(L.Bq),e.rXU(S.a),e.rXU(U.m),e.rXU(k.w),e.rXU(u.bg),e.rXU(f.Pw))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-permisos"]],decls:15,vars:3,consts:[[1,"card"],[1,"flex","flex-wrap","gap-3","mb-4"],[1,"flex-auto"],["for","integer",1,"font-bold","block","mb-2"],["pInputText","","id","integer","pKeyFilter","int",1,"w-full",3,"ngModelChange","ngModel"],["for","number",1,"font-bold","block","mb-2"],["appendTo","body","optionLabel","componente","placeholder","Selecicona la Componente",3,"ngModelChange","options","ngModel"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"flex","flex-wrap","gap-3"],["pButton","","type","submit",1,"btn","btn-primary",3,"click"],["class","flex align-items-center gap-2",4,"ngIf"],[1,"flex","align-items-center","gap-2"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),e.EFF(4," Permiso "),e.k0s(),e.j41(5,"input",4),e.mxI("ngModelChange",function(s){return e.DH7(o.newpermiso.name,s)||(o.newpermiso.name=s),s}),e.k0s()(),e.j41(6,"div",2)(7,"label",5),e.EFF(8," M\xe9todo "),e.k0s(),e.j41(9,"p-dropdown",6),e.mxI("ngModelChange",function(s){return e.DH7(o.newpermiso.method,s)||(o.newpermiso.method=s),s}),e.DNE(10,xs,1,1,"ng-template",7)(11,ks,3,1,"ng-template",8),e.k0s()()(),e.j41(12,"div",9)(13,"button",10),e.bIt("click",function(){return o.enviar()}),e.EFF(14," Guardar "),e.k0s()()()),2&i&&(e.R7$(5),e.R50("ngModel",o.newpermiso.name),e.R7$(4),e.Y8G("options",o.method_arr),e.R50("ngModel",o.newpermiso.method))},dependencies:[b.bT,u.Ei,v._f,c.me,c.BC,c.vS,X.ms,M.S]})}return n})();var ve=d(1806);const Es=["ms"],Ss=()=>({"min-width":"50rem"}),Ms=()=>[10,25,50],js=()=>({color:"var(--text-color)"}),Ts=()=>({width:"50vw"}),ws=()=>[5,10,20],Rs=()=>["name","last_name"];function Ds(n,r){1&n&&(e.j41(0,"tr")(1,"th",13),e.EFF(2,"Nombre"),e.k0s(),e.j41(3,"th",13),e.EFF(4,"M\xe9todo"),e.k0s(),e.j41(5,"th",13),e.EFF(6,"Usuarios"),e.k0s(),e.nrm(7,"th",13),e.k0s())}function Gs(n,r){if(1&n){const t=e.RV6();e.j41(0,"input",22),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.name,o)||(a.name=o),e.Njj(o)}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.R50("ngModel",t.name)}}function Ps(n,r){if(1&n&&e.EFF(0),2&n){const t=e.XpG().$implicit;e.SpI(" ",t.name," ")}}function zs(n,r){if(1&n){const t=e.RV6();e.j41(0,"input",22),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.method,o)||(a.method=o),e.Njj(o)}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.R50("ngModel",t.method)}}function Xs(n,r){if(1&n&&e.EFF(0),2&n){const t=e.XpG().$implicit;e.SpI(" ",t.method," ")}}function Ns(n,r){if(1&n&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.R7$(),e.SpI(" ",t.name,", ")}}function As(n,r){if(1&n&&(e.j41(0,"span")(1,"a"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2).$implicit;e.R7$(2),e.SpI("+",t.length-3," m\xe1s")}}function Bs(n,r){if(1&n&&(e.j41(0,"div",29),e.DNE(1,Ns,2,1,"div",30)(2,As,3,1,"span",28),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngForOf",t.slice(0,3)),e.R7$(),e.Y8G("ngIf",t.length>3)}}function Us(n,r){1&n&&(e.j41(0,"div"),e.EFF(1," No se ha seleccionado ning\xfan usuario "),e.k0s())}function Ls(n,r){if(1&n&&e.DNE(0,Bs,3,2,"div",27)(1,Us,2,0,"div",28),2&n){const t=r.$implicit;e.Y8G("ngIf",t),e.R7$(),e.Y8G("ngIf",!t||0===t.length)}}function Os(n,r){1&n&&e.nrm(0,"i",33)}function $s(n,r){1&n&&e.nrm(0,"i",34),2&n&&e.Y8G("ngStyle",e.lJ4(1,js))}function Vs(n,r){if(1&n&&e.DNE(0,Os,1,0,"i",31)(1,$s,1,2,"i",32),2&n){const i=r.partialSelected;e.Y8G("ngIf",r.$implicit),e.R7$(),e.Y8G("ngIf",i)}}function Ys(n,r){if(1&n&&(e.j41(0,"div",35)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.Lme(" ",t.name," ",t.last_name," ")}}function Hs(n,r){if(1&n){const t=e.RV6();e.j41(0,"p-multiSelect",23,0),e.mxI("ngModelChange",function(o){e.eBV(t);const a=e.XpG().$implicit;return e.DH7(a.user,o)||(a.user=o),e.Njj(o)}),e.bIt("onSelectAllChange",function(o){e.eBV(t);const a=e.XpG().rowIndex,s=e.XpG();return e.Njj(s.onSelectAllChange(o,a))})("ngModelChange",function(o){e.eBV(t);const a=e.XpG().rowIndex,s=e.XpG();return e.Njj(s.onModelChange(o,a))}),e.DNE(2,Ls,2,2,"ng-template",24)(3,Vs,2,2,"ng-template",25)(4,Ys,3,2,"ng-template",26),e.k0s()}if(2&n){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("options",i.users)("showToggleAll",!0)("selectAll",i.selectAll),e.R50("ngModel",t.user),e.Y8G("virtualScroll",!0)("virtualScrollItemSize",43)}}function Js(n,r){if(1&n&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.R7$(),e.Lme(" ",t.name," ",t.last_name,", ")}}function Ws(n,r){if(1&n){const t=e.RV6();e.j41(0,"span")(1,"a",40),e.bIt("click",function(){e.eBV(t);const o=e.XpG(3).$implicit,a=e.XpG();return e.Njj(a.showAllUsersDialog(o))}),e.EFF(2),e.k0s()()}if(2&n){const t=e.XpG(3).$implicit;e.R7$(2),e.SpI("+",t.user.length-3," m\xe1s")}}function Zs(n,r){if(1&n&&(e.qex(0),e.DNE(1,Js,2,2,"div",30)(2,Ws,3,1,"span",28),e.bVm()),2&n){const t=e.XpG(2).$implicit;e.R7$(),e.Y8G("ngForOf",t.user.slice(0,3)),e.R7$(),e.Y8G("ngIf",t.user.length>3)}}function qs(n,r){1&n&&(e.j41(0,"div"),e.EFF(1," Ning\xfan usuario seleccionado "),e.k0s())}function Ks(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",41)(1,"p-iconField",42)(2,"p-inputIcon"),e.nrm(3,"i",43),e.k0s(),e.j41(4,"input",44),e.bIt("input",function(o){e.eBV(t),e.XpG();const a=e.sdS(4);return e.Njj(a.filterGlobal(o.target.value,"contains"))}),e.k0s()()()}}function Qs(n,r){1&n&&(e.j41(0,"tr")(1,"th",45),e.EFF(2," Nombres "),e.k0s(),e.j41(3,"th",45),e.EFF(4," Apellidos "),e.k0s()())}function el(n,r){if(1&n&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.SpI(" ",t.name," "),e.R7$(2),e.SpI(" ",t.last_name," ")}}function tl(n,r){1&n&&(e.j41(0,"tr")(1,"td",46),e.EFF(2," No customers found. "),e.k0s()())}function il(n,r){if(1&n){const t=e.RV6();e.DNE(0,Zs,3,2,"ng-container",28)(1,qs,2,0,"div",28),e.j41(2,"p-dialog",36),e.mxI("visibleChange",function(o){e.eBV(t);const a=e.XpG().$implicit,s=e.XpG();return e.DH7(s.displayUserDialog[a._id],o)||(s.displayUserDialog[a._id]=o),e.Njj(o)}),e.j41(3,"p-table",37,1),e.DNE(5,Ks,5,0,"ng-template",38)(6,Qs,5,0,"ng-template",11)(7,el,5,2,"ng-template",12)(8,tl,3,0,"ng-template",39),e.k0s()()}if(2&n){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("ngIf",t.user&&t.user.length>0),e.R7$(),e.Y8G("ngIf",!t.user||0===t.user.length),e.R7$(),e.Aen(e.lJ4(12,Ts)),e.Y8G("header","Usuarios Seleccionados - "+t.name),e.R50("visible",i.displayUserDialog[t._id]),e.R7$(),e.Y8G("value",t.user)("paginator",!0)("rows",10)("rowsPerPageOptions",e.lJ4(13,ws))("paginatorDropdownAppendTo","body")("globalFilterFields",e.lJ4(14,Rs))}}function nl(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",47),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG();return e.Njj(a.onRowEditInit(o))}),e.k0s()}}function ol(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",48),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG();return e.Njj(a.onRowEditSave(o))}),e.k0s()}}function al(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",49),e.bIt("click",function(){e.eBV(t);const o=e.XpG(),a=o.$implicit,s=o.rowIndex,l=e.XpG();return e.Njj(l.onRowEditCancel(a,s))}),e.k0s()}}function rl(n,r){if(1&n&&(e.j41(0,"tr",14)(1,"td")(2,"p-cellEditor"),e.DNE(3,Gs,1,1,"ng-template",15)(4,Ps,1,1,"ng-template",16),e.k0s()(),e.j41(5,"td")(6,"p-cellEditor"),e.DNE(7,zs,1,1,"ng-template",15)(8,Xs,1,1,"ng-template",16),e.k0s()(),e.j41(9,"td")(10,"p-cellEditor"),e.DNE(11,Hs,5,6,"ng-template",15)(12,il,9,15,"ng-template",16),e.k0s()(),e.j41(13,"td")(14,"div",17)(15,"div",18),e.DNE(16,nl,1,0,"button",19)(17,ol,1,0,"button",20)(18,al,1,0,"button",21),e.k0s()()()()),2&n){const i=r.editing;e.Y8G("pEditableRow",r.$implicit),e.R7$(16),e.Y8G("ngIf",!i),e.R7$(),e.Y8G("ngIf",i),e.R7$(),e.Y8G("ngIf",i)}}let sl=(()=>{class n{constructor(t,i,o,a,s,l,p){this.auth=t,this.ref=i,this.listService=o,this.updateServices=a,this.helper=s,this.messageService=l,this.dialogService=p,this.permisos=[],this.clonedProducts={},this.rolselect=[],this.token=this.auth.token(),this.selectAll=!1,this.editCategoriaId=null,this.displayUserDialog={}}ngOnInit(){var t=this;return(0,g.A)(function*(){yield t.listarpermisos(),yield t.listarrol()})()}listarpermisos(){var t=this;return(0,g.A)(function*(){t.listService.ListarPermisos(t.token,{populate:"user"},!1).subscribe(i=>{t.permisos=i.data},i=>{})})()}onSelectAllChange(t,i){if(t.checked){const o=this.ms.visibleOptions().filter(a=>!this.permisos[i].user.some(s=>s._id===a._id));this.permisos[i].user=[...this.permisos[i].user,...o]}else this.permisos[i].user=[];this.selectAll=t.checked}onModelChange(t,i){this.permisos[i].user=t.filter((o,a,s)=>a===s.findIndex(l=>l._id===o._id))}toggleUser(t,i){this.checklist(t,i._id)?this.deleterol(t,i._id):this.addrol(t,i)}checklist(t,i){return void 0!==t.rolesPermitidos.find(o=>o._id===i)}addrol(t,i){t.rolesPermitidos.push(i)}deleterol(t,i){const o=t.rolesPermitidos.findIndex(a=>a._id===i);-1!==o&&t.rolesPermitidos.splice(o,1)}listarrol(){var t=this;return(0,g.A)(function*(){t.listService.listarUsuarios(t.token).subscribe(i=>{t.users=i.data})})()}isMobil(){return this.helper.isMobil()}newpermiso(){this.ref=this.dialogService.open(Fs,{header:"Crear nuevo Permiso",width:this.isMobil()?"100%":"40%"}),T.q.addListener("backButton",t=>{this.ref.close()}),this.ref.onClose.subscribe(t=>{t&&this.listarpermisos()})}onRowEditInit(t){this.clonedProducts[t._id]={...t}}showAllUsersDialog(t){this.displayUserDialog[t._id]=!0}onRowEditSave(t){t.user=t.user.map(i=>i._id),this.updateServices.actualizarPermisos(this.token,t._id,t).subscribe(i=>{const o=this.permisos.findIndex(a=>a._id===t._id);-1!==o&&(this.permisos[o]=i.data),this.messageService.add({severity:"success",summary:"Ingresado",detail:i.message})})}onRowEditCancel(t,i){this.permisos[i]=this.clonedProducts[t._id],delete this.clonedProducts[t._id]}imprimir(t){}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(F.u),e.rXU(f.Pw),e.rXU(S.a),e.rXU(P),e.rXU(k.w),e.rXU(u.bg),e.rXU(f.o3))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-permisos"]],viewQuery:function(i,o){if(1&i&&e.GBs(Es,5),2&i){let a;e.mGM(a=e.lsd())&&(o.ms=a.first)}},features:[e.Jv_([u.bg])],decls:15,vars:11,consts:[["ms",""],["dt",""],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-auto"],[1,"col-6"],[1,"btn","btn-primary","float-end",3,"click"],[1,"card-body"],[1,"table-responsive-sm"],["styleClass","p-datatable-striped","dataKey","_id","editMode","row","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",1,"table","table-sm","align-middle","table-striped","table-hover",3,"paginatorDropdownAppendTo","value","tableStyle","scrollable","responsive","rows","showCurrentPageReport","rowsPerPageOptions","paginator"],["pTemplate","header"],["pTemplate","body"],["scope","col"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],["role","group","aria-label","Acciones",1,"btn-group"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","bi bi-pencil","class","p-button-rounded p-button-text mr-2 btn btn-primary",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","bi bi-floppy","class","p-button-rounded p-button-text p-button-success mr-2 btn btn-success",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","bi bi-trash","class","p-button-rounded p-button-text p-button-danger btn btn-danger",3,"click",4,"ngIf"],["pInputText","",3,"ngModelChange","ngModel"],["optionLabel","name","placeholder","Selecciona los usuarios para este permiso",1,"multiselect-custom-virtual-scroll","w-100",3,"ngModelChange","onSelectAllChange","options","showToggleAll","selectAll","ngModel","virtualScroll","virtualScrollItemSize"],["pTemplate","selectedItems"],["pTemplate","headercheckboxicon"],["pTemplate","item"],["class","inline-flex align-items-center gap-2 px-1",4,"ngIf"],[4,"ngIf"],[1,"inline-flex","align-items-center","gap-2","px-1"],[4,"ngFor","ngForOf"],["class","pi pi-check",4,"ngIf"],["class","pi pi-minus",3,"ngStyle",4,"ngIf"],[1,"pi","pi-check"],[1,"pi","pi-minus",3,"ngStyle"],[1,"flex","align-items-center","gap-2"],[3,"visibleChange","header","visible"],["dataKey","_id",3,"value","paginator","rows","rowsPerPageOptions","paginatorDropdownAppendTo","globalFilterFields"],["pTemplate","caption"],["pTemplate","emptymessage"],[3,"click"],[1,"flex"],["iconPosition","left",1,"ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar palabra clave",3,"input"],[2,"width","22%"],["colspan","2"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","bi bi-pencil",1,"p-button-rounded","p-button-text","mr-2","btn","btn-primary",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","bi bi-floppy",1,"p-button-rounded","p-button-text","p-button-success","mr-2","btn","btn-success",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","bi bi-trash",1,"p-button-rounded","p-button-text","p-button-danger","btn","btn-danger",3,"click"]],template:function(i,o){1&i&&(e.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h2"),e.EFF(5,"Listado de Permisos"),e.k0s()(),e.j41(6,"div",6)(7,"a",7),e.bIt("click",function(){return o.newpermiso()}),e.EFF(8,"Nuevo Permiso"),e.k0s()()()(),e.j41(9,"div",8),e.nrm(10,"p-toast"),e.j41(11,"div",9)(12,"p-table",10),e.DNE(13,Ds,8,0,"ng-template",11)(14,rl,19,4,"ng-template",12),e.k0s()()()()),2&i&&(e.R7$(12),e.Y8G("paginatorDropdownAppendTo","body")("value",o.permisos)("tableStyle",e.lJ4(9,Ss))("scrollable",!0)("responsive",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.lJ4(10,Ms))("paginator",!0))},dependencies:[b.Sq,b.bT,b.B3,u.Ei,fe.C,be.m,v._f,E.y8,c.me,c.BC,c.vS,I.XI,I.c5,I.Xk,I.Hd,I.E7,I.Tf,ie.l,M.S,ve.KF,le.n]})}return n})();function ll(n,r){if(1&n&&(e.j41(0,"div",13)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.JRh(t.categoriaselect.nombre)}}function cl(n,r){if(1&n&&e.DNE(0,ll,3,1,"div",12),2&n){const t=e.XpG();e.Y8G("ngIf",t.categoriaselect)}}function dl(n,r){if(1&n&&(e.j41(0,"div",13)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.nombre)}}function pl(n,r){if(1&n&&(e.j41(0,"div",16)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.SpI("",t.nombres,",")}}function ml(n,r){1&n&&(e.j41(0,"div"),e.EFF(1," Selecciona Encargados "),e.k0s())}function ul(n,r){if(1&n&&e.DNE(0,pl,3,1,"div",14)(1,ml,2,0,"div",15),2&n){const t=r.$implicit;e.Y8G("ngForOf",t),e.R7$(),e.Y8G("ngIf",!t||0===t.length)}}function _l(n,r){if(1&n&&(e.j41(0,"div",13)(1,"div"),e.EFF(2),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.nombres)}}let gl=(()=>{class n{constructor(t,i,o,a,s,l,p,m){this.fb=t,this.listService=i,this.createService=o,this.router=a,this.helper=s,this.messageService=l,this.ref=p,this.auth=m,this.encargadosSeleccionados=[],this.categorias=[],this.usuarios=[],this.token=this.auth.token(),this.roles=[],this.subcategoriaForm=this.fb.group({categoria:["",c.k0.required]})}ngOnInit(){this.listarCategorias(),this.listarUsuarios()}listarCategorias(){this.listService.listarCategorias(this.token).subscribe(t=>{this.categorias=t.data})}listarUsuarios(){var t=this;return(0,g.A)(function*(){t.listService.listarRolesUsuarios(t.token).subscribe(function(){var i=(0,g.A)(function*(o){o.data&&(t.roles=o.data,(yield Promise.all(t.roles.map(function(){var s=(0,g.A)(function*(l){if(3==l.orden||l.orden>4)return yield t.listService.listarUsuarios(t.token,"rol_user.orden",l.orden).toPromise()});return function(l){return s.apply(this,arguments)}}()))).forEach(s=>{s&&t.usuarios.push(...s.data)}))});return function(o){return i.apply(this,arguments)}}())})()}eliminarEncargado(t){this.encargadosSeleccionados=this.encargadosSeleccionados.filter(i=>i!==t)}agregarEncargado(t){this.encargadosSeleccionados.push(t.value)}userfilter(t){return this.usuarios.find(i=>i._id==t)}registrarEncargo(){this.encargadosSeleccionados.length>0&&this.categoriaselect&&this.createService.registrarEncargadoCategoria(this.token,{encargado:this.encargadosSeleccionados,categoria:this.categoriaselect}).subscribe(t=>{this.messageService.add({severity:"success",summary:"Ingresado",detail:t.message}),this.ref.close()},t=>{this.messageService.add({severity:"error",summary:("("+t.status+")").toString(),detail:t.error.message||"Sin conexi\xf3n"})})}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(c.ok),e.rXU(S.a),e.rXU(U.m),e.rXU(x.Ix),e.rXU(k.w),e.rXU(u.bg),e.rXU(f.Pw),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-create-encargado-categoria"]],features:[e.Jv_([u.bg])],decls:19,vars:5,consts:[[1,"card-body"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12"],["for","categoria",1,"form-label"],["appendTo","body","optionLabel","componente","placeholder","Selecicona la Componente",3,"ngModelChange","options","ngModel"],["pTemplate","selectedItem"],["pTemplate","item"],["for","encargados",1,"form-label"],["appendTo","body","placeholder","Seleccion los encargados","optionLabel","nombres",3,"ngModelChange","options","ngModel","filter"],["pTemplate","selectedItems"],["pButton","",3,"click"],[1,"pi","pi-save"],["class","flex align-items-center gap-2",4,"ngIf"],[1,"flex","align-items-center","gap-2"],["class","inline-flex align-items-center gap-2 px-1",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"inline-flex","align-items-center","gap-2","px-1"]],template:function(i,o){1&i&&(e.nrm(0,"p-toast"),e.j41(1,"div",0)(2,"div",1)(3,"div",2)(4,"label",3),e.EFF(5,"Categor\xeda"),e.k0s(),e.j41(6,"p-dropdown",4),e.mxI("ngModelChange",function(s){return e.DH7(o.categoriaselect,s)||(o.categoriaselect=s),s}),e.DNE(7,cl,1,1,"ng-template",5)(8,dl,3,1,"ng-template",6),e.k0s()(),e.j41(9,"div",2)(10,"label",7),e.EFF(11,"Encargados"),e.k0s(),e.j41(12,"p-multiSelect",8),e.mxI("ngModelChange",function(s){return e.DH7(o.encargadosSeleccionados,s)||(o.encargadosSeleccionados=s),s}),e.DNE(13,ul,2,2,"ng-template",9)(14,_l,3,1,"ng-template",6),e.k0s()(),e.j41(15,"div",2)(16,"button",10),e.bIt("click",function(){return o.registrarEncargo()}),e.nrm(17,"i",11),e.EFF(18," Guardar "),e.k0s()()()()),2&i&&(e.R7$(6),e.Y8G("options",o.categorias),e.R50("ngModel",o.categoriaselect),e.R7$(6),e.Y8G("options",o.usuarios),e.R50("ngModel",o.encargadosSeleccionados),e.Y8G("filter",!0))},dependencies:[b.Sq,b.bT,u.Ei,v._f,E.y8,c.BC,c.vS,X.ms,ve.KF]})}return n})();const hl=()=>({"min-width":"60rem"});function fl(n,r){1&n&&(e.j41(0,"tr"),e.nrm(1,"th",12),e.j41(2,"th",13),e.EFF(3," Categoria "),e.nrm(4,"p-sortIcon",14),e.k0s(),e.j41(5,"th",15),e.EFF(6," Descripci\xf3n "),e.nrm(7,"p-sortIcon",16),e.k0s()())}function bl(n,r){if(1&n&&(e.j41(0,"td"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.categoria.nombre)}}function vl(n,r){if(1&n&&(e.j41(0,"td"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.categoria.descripcion)}}function Cl(n,r){if(1&n&&(e.j41(0,"tr")(1,"td"),e.nrm(2,"button",17),e.k0s(),e.DNE(3,bl,2,1,"td",18)(4,vl,2,1,"td",18),e.k0s()),2&n){const t=r.$implicit,i=r.expanded;e.R7$(2),e.Y8G("pRowToggler",t)("icon",i?"pi pi-chevron-down":"pi pi-chevron-right"),e.R7$(),e.Y8G("ngIf",t.categoria),e.R7$(),e.Y8G("ngIf",t.categoria)}}function Il(n,r){1&n&&(e.j41(0,"tr")(1,"th",23),e.EFF(2," Nombres "),e.nrm(3,"p-sortIcon",24),e.k0s(),e.j41(4,"th",25),e.EFF(5," Correo "),e.nrm(6,"p-sortIcon",26),e.k0s(),e.j41(7,"th",27),e.EFF(8," Estado "),e.nrm(9,"p-sortIcon",28),e.k0s(),e.nrm(10,"th",29),e.k0s())}function yl(n,r){if(1&n&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.nombres),e.R7$(2),e.JRh(t.correo),e.R7$(2),e.JRh(t.estado)}}function xl(n,r){1&n&&(e.j41(0,"tr")(1,"td",30),e.EFF(2," No tienes encargados "),e.k0s()())}function kl(n,r){if(1&n&&(e.j41(0,"tr")(1,"td",19)(2,"div",20)(3,"p-table",21),e.DNE(4,Il,11,0,"ng-template",9)(5,yl,7,3,"ng-template",10)(6,xl,3,0,"ng-template",22),e.k0s()()()()),2&n){const t=r.$implicit;e.R7$(3),e.Y8G("paginatorDropdownAppendTo","body")("value",t.encargado)}}let Fl=(()=>{class n{constructor(t,i,o,a,s,l){this.ref=t,this.listService=i,this.router=o,this.helper=a,this.dialogService=s,this.auth=l,this.encargadosCategoria=[],this.clonedProducts={},this.token=this.auth.token(),this.editCategoriaId=null}ngOnInit(){this.listarCategorias()}listarCategorias(){this.listService.listarEncargadosCategorias(this.token,{populate:"encargado,categoria"},!1).subscribe(t=>{this.encargadosCategoria=t.data,console.log(t.data)},t=>{console.error(t)})}isMobil(){return this.helper.isMobil()}newencargado(){this.ref=this.dialogService.open(gl,{header:"Nueva Encargado de Categoria",width:this.isMobil()?"100%":"40%"}),T.q.addListener("backButton",t=>{this.ref.close()}),this.ref.onClose.subscribe(()=>{this.listarCategorias()})}getNombreUsuario(t){const i=this.encargadosCategoria.encargado.find(o=>o._id===t);return i?i.nombres:""}getNombreCategoria(t){const i=this.encargadosCategoria.categoria.find(o=>o._id===t);return i?i.nombre:""}onRowEditInit(t){this.clonedProducts[t._id]={...t}}onRowEditSave(t){}onRowEditCancel(t,i){}verDetalles(t){}confirmarEliminacion(t){}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(f.Pw),e.rXU(S.a),e.rXU(x.Ix),e.rXU(k.w),e.rXU(f.o3),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-index-encargado-categoria"]],decls:15,vars:4,consts:[[1,"card"],[1,"card-header"],[1,"row"],[1,"col-auto"],[1,"col-6"],["icon","pi pi-briefcase","label","Nuevo Encargado de Categor\xeda",3,"click"],[1,"card-body"],[1,"table-responsive-sm"],["styleClass","p-datatable-striped","dataKey","_id","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros",3,"paginatorDropdownAppendTo","value","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[2,"width","5rem"],["pSortableColumn","categoria.nombre"],["field","categoria.nombre"],["pSortableColumn","categoria.descripcion"],["field","categoria.descripcion"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],[4,"ngIf"],["colspan","3"],[1,"p-3"],["currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} registros","dataKey","_id",3,"paginatorDropdownAppendTo","value"],["pTemplate","emptymessage"],["pSortableColumn","nombres"],["field","nombres"],["pSortableColumn","correo"],["field","correo"],["pSortableColumn","estado"],["field","estado"],[2,"width","4rem"],["colspan","6"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),e.EFF(5,"Listado de Encargados de Categor\xeda"),e.k0s()(),e.j41(6,"div",4)(7,"p-button",5),e.bIt("click",function(){return o.newencargado()}),e.k0s()()()(),e.j41(8,"div",6),e.nrm(9,"p-toast"),e.j41(10,"div",7)(11,"p-table",8),e.DNE(12,fl,8,0,"ng-template",9)(13,Cl,5,4,"ng-template",10)(14,kl,7,2,"ng-template",11),e.k0s()()()()),2&i&&(e.R7$(11),e.Y8G("paginatorDropdownAppendTo","body")("value",o.encargadosCategoria)("tableStyle",e.lJ4(3,hl)))},dependencies:[b.bT,u.Ei,v._f,v.$n,E.y8,I.XI,I.Tg,I.FP,I.yc,le.n]})}return n})();function El(n,r){1&n&&e.nrm(0,"app-index-usuario")}function Sl(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",5)(1,"p-button",6),e.bIt("onClick",function(){const o=e.eBV(t).nextCallback;return e.Njj(o.emit())}),e.k0s()(),e.j41(2,"div",7),e.DNE(3,El,1,0,"app-index-usuario",8),e.k0s()}if(2&n){const t=e.XpG();e.R7$(3),e.Y8G("ngIf",t.check.IndexUsuarioComponent)}}function Ml(n,r){1&n&&e.nrm(0,"app-index-rol-user")}function jl(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",9)(1,"p-button",10),e.bIt("onClick",function(){const o=e.eBV(t).prevCallback;return e.Njj(o.emit())}),e.k0s(),e.j41(2,"p-button",6),e.bIt("onClick",function(){const o=e.eBV(t).nextCallback;return e.Njj(o.emit())}),e.k0s()(),e.j41(3,"div",7),e.DNE(4,Ml,1,0,"app-index-rol-user",8),e.k0s()}if(2&n){const t=e.XpG();e.R7$(4),e.Y8G("ngIf",t.check.IndexRolUserComponent)}}function Tl(n,r){1&n&&e.nrm(0,"app-index-encargado-categoria")}function wl(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",9)(1,"p-button",10),e.bIt("onClick",function(){const o=e.eBV(t).prevCallback;return e.Njj(o.emit())}),e.k0s(),e.j41(2,"p-button",6),e.bIt("onClick",function(){const o=e.eBV(t).nextCallback;return e.Njj(o.emit())}),e.k0s()(),e.j41(3,"div",7),e.DNE(4,Tl,1,0,"app-index-encargado-categoria",8),e.k0s()}if(2&n){const t=e.XpG();e.R7$(4),e.Y8G("ngIf",t.check.IndexEncargadoCategoriaComponent)}}function Rl(n,r){1&n&&e.nrm(0,"app-index-permisos")}function Dl(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",11)(1,"p-button",10),e.bIt("onClick",function(){const o=e.eBV(t).prevCallback;return e.Njj(o.emit())}),e.k0s()(),e.j41(2,"div",7),e.DNE(3,Rl,1,0,"app-index-permisos",8),e.k0s()}if(2&n){const t=e.XpG();e.R7$(3),e.Y8G("ngIf",t.check.IndexPermisosComponent)}}let Gl=(()=>{class n{constructor(t,i,o){this.helperService=t,this.router=i,this.auth=o,this.selected="IndexUsuarioComponent",this.check={}}ngOnInit(){var t=this;return(0,g.A)(function*(){t.helperService.llamarspinner("admin componente");const i={IndexUsuarioComponent:yield t.auth.hasPermissionComponent("/obteneruserporcriterio","post"),IndexRolUserComponent:yield t.auth.hasPermissionComponent("/obtenerrolesporcriterio","post"),IndexEncargadoCategoriaComponent:yield t.auth.hasPermissionComponent("/encargado_categoria","get"),IndexPermisosComponent:yield t.auth.hasPermissionComponent("/obtenerpermisosporcriterio","get")};(0,B.p)(i).subscribe(function(){var o=(0,g.A)(function*(a){t.check=a;try{t.check.IndexUsuarioComponent||t.router.navigate(["/notfound"]);let s=!1;for(const l in t.check)t.check[l]&&!s&&(t.selected=l,s=!0)}catch(s){console.error("Error en ngOnInit:",s),t.router.navigate(["/notfound"])}finally{t.helperService.cerrarspinner("admin componente")}});return function(a){return o.apply(this,arguments)}}())})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.rXU(k.w),e.rXU(x.Ix),e.rXU(F.u))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-admin"]],decls:10,vars:0,consts:[["header","Usuarios"],["pTemplate","content"],["header","Roles"],["header","Encargos"],["header","Permisos"],[1,"flex","pt-4","justify-content-end"],["label","Next","icon","pi pi-arrow-right","iconPos","right",3,"onClick"],[1,"flex","flex-column"],[4,"ngIf"],[1,"flex","pt-4","justify-content-between"],["label","Back","icon","pi pi-arrow-left",3,"onClick"],[1,"flex","pt-4","justify-content-start"]],template:function(i,o){1&i&&(e.nrm(0,"p-toast"),e.j41(1,"p-stepper")(2,"p-stepperPanel",0),e.DNE(3,Sl,4,1,"ng-template",1),e.k0s(),e.j41(4,"p-stepperPanel",2),e.DNE(5,jl,5,1,"ng-template",1),e.k0s(),e.j41(6,"p-stepperPanel",3),e.DNE(7,wl,5,1,"ng-template",1),e.k0s(),e.j41(8,"p-stepperPanel",4),e.DNE(9,Dl,4,1,"ng-template",1),e.k0s()())},dependencies:[b.bT,u.Ei,v.$n,E.y8,J.C1,J.ct,Ae,Is,sl,Fl]})}return n})();var Z=d(5734),q=d(5159);let Pl=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[x.iI.forChild([{path:"",component:Ee},{path:"categoria",component:Yi,canActivate:[Z.q,q.L],data:{expectedPermission:"/categoria"}},{path:"categoria/create-categoria",component:vr,canActivate:[Z.q,q.L],data:{expectedPermission:"/categoria"}},{path:"subcategoria",component:Gr,canActivate:[Z.q,q.L],data:{expectedPermission:"/subcategoria"}},{path:"subcategoria/create-subcategoria",component:Nr,canActivate:[Z.q,q.L],data:{expectedPermission:"/subcategoria"}},{path:"ficha-sectorial",component:we,data:{expectedPermission:"/ficha_sectorial"}},{path:"incidente",component:he,canActivate:[Z.q,q.L],data:{expectedPermission:"/incidentes_denuncia"}},{path:"incidente/:id",component:he,canActivate:[Z.q,q.L],data:{expectedPermission:"/incidentes_denuncia"}},{path:"administracion",component:Gl,canActivate:[Z.q,q.L],data:{expectedPermission:"/usuario"}},{path:"edit-user",component:Xe,canActivate:[Z.q,q.L],data:{expectedPermission:"/usuario/:id"}}]),x.iI]})}return n})();d(8625),d(617),d(291),d(3683),d(442),d(1547),d(2240);let ic=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({})}return n})();var nc=d(8130),oc=d(6307),Ve=d(2247),ac=d(6301),rc=d(5060),sc=d(6576),lc=d(9601),cc=d(51),dc=d(6930),pc=d(292),mc=d(4576),uc=d(5145),_c=d(3437),gc=d(9914),hc=d(9517),fc=d(9821),bc=d(4654),vc=d(2722),Cc=d(5294),Ic=d(5635),yc=d(5883),xc=d(2629),kc=d(1846),Fc=d(1944),Ec=d(6202),Sc=d(6048),Mc=d(6911),jc=d(5686),Tc=d(9708),wc=d(7534),Rc=d(1377),Dc=d(9764),Gc=d(3673),Pc=d(569),zc=d(81),Xc=d(4892),Nc=d(8451),Ye=d(6374),Ac=d(1981),Bc=d(6020),Uc=d(5041),Lc=d(9552),Oc=d(2438),$c=d(3037),Vc=d(2402),Yc=d(9069),Hc=d(5483),He=d(2565),Jc=d(8061),Wc=d(492),Zc=d(3906),qc=d(3933),Kc=d(230),Qc=d(6456),ed=d(5357),td=d(7859),id=d(1735),nd=d(4549),od=d(9098),ad=d(5084),rd=d(1876),sd=d(8886),ld=d(4599),cd=d(727),dd=d(9776),Je=d(9901),pd=d(5600),md=d(4961),ud=d(6902),_d=d(4471),gd=d(4151);let hd=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.$C({type:n,bootstrap:[Ae]});static#i=this.\u0275inj=e.G2t({providers:[u.bg,f.o3,f.sb,f.Pw],imports:[L.UN,b.MD,Pl,He.n,Ec.I,Fc.k,fe.A,be.y,pe.a,ic,E.MB,c.YN,c.X1,Ve.$$,I.bG,ie.P,ge.$,ee.wn,Sc.U,te.e,me.rO,X.kr,M.u,nc.DashboardModule,ae.k,ne.dL,J.eh,oc.h6,Ne.m,ac.t,rc.EJ,sc._,v.tm,lc.R,cc.tQ,dc.F,pc.q4,Re.P,mc.AV,uc.F,_c.H,gc.YG,hc.rc,fc.KQ,bc.y,vc.m,Cc.C,ce.ad,f.k_,Me.sv,Ic.P,yc.HV,xc.Zn,_e.H_,kc.O3,H.f,Mc.jJ,jc.UW,Tc.Qp,wc.Mk,Rc.N9,Dc.u,ze.h,ve.iV,Gc.N,Pc.ux,zc.d,Xc.I,Nc.b,Ye.M6,Ac.Ou,Bc.W,Uc.d,Lc.Ko,Oc.wZ,$c.h,Vc.M,Yc.F,Hc.xs,Jc.dG,Wc.SW,Zc.OT,qc.J,Kc.i,Qc.U,ed.Z,td.fd,id.bx,nd.ht,od.i,De.d0,ad.m,rd.S,sd.AG,ld.ft,cd.VG,dd.y,Je.D,pd.S,md.d,le.Z,ud.y,_d.f]})}return n})();e.wjB(Ee,[b.Sq,b.bT,He.B,u.Ei,pe.g,v.$n,E.y8,c.BC,c.vS,Ve.j9,ie.l,gd.W,Ye.GD,Je.Z,he,we],[])}}]);